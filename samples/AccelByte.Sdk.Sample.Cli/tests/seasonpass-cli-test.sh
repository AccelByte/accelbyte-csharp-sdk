#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..43"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 QuerySeasons
$CLI_EXE \
    --sn seasonpass \
    --op QuerySeasons \
    --namespace $AB_NAMESPACE \
    --limit '94' \
    --offset '42' \
    --status '["PUBLISHED", "DRAFT", "PUBLISHED"]' \
    > test.out 2>&1
eval_tap $? 2 'QuerySeasons' test.out

#- 3 CreateSeason
# body param: body
echo '{"autoClaim": true, "defaultLanguage": "SAwpR9fL", "defaultRequiredExp": 7, "draftStoreId": "J7Z9yVvq", "end": "1972-09-20T00:00:00Z", "excessStrategy": {"currency": "ipvFtx54", "method": "CURRENCY", "percentPerExp": 83}, "images": [{"as": "BqbaYOFq", "caption": "jK3OPfFW", "height": 9, "imageUrl": "BkaGPHBW", "smallImageUrl": "xNuGri37", "width": 26}, {"as": "qVT8yS98", "caption": "OhTFVL8c", "height": 5, "imageUrl": "X360m5dL", "smallImageUrl": "aiPWG5PM", "width": 95}, {"as": "HiJfYSYC", "caption": "f85wuFjV", "height": 56, "imageUrl": "cxuK0Xh8", "smallImageUrl": "pZ6fO30A", "width": 24}], "localizations": {"Xcc8azWS": {"description": "p8uzh5Mn", "title": "RQ6KUTQA"}, "wAcxZ7RC": {"description": "Tqu1sCDf", "title": "VTRn26AU"}, "xJZiA52e": {"description": "HHgjjJF2", "title": "Ble6of9H"}}, "name": "NIfcdjJ9", "start": "1977-06-30T00:00:00Z", "tierItemId": "Dze7xQD5"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op CreateSeason \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 3 'CreateSeason' test.out

#- 4 GetCurrentSeason
$CLI_EXE \
    --sn seasonpass \
    --op GetCurrentSeason \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 4 'GetCurrentSeason' test.out

#- 5 GetSeason
$CLI_EXE \
    --sn seasonpass \
    --op GetSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'Qeai9CU8' \
    > test.out 2>&1
eval_tap $? 5 'GetSeason' test.out

#- 6 DeleteSeason
$CLI_EXE \
    --sn seasonpass \
    --op DeleteSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'FPgPUs7v' \
    > test.out 2>&1
eval_tap $? 6 'DeleteSeason' test.out

#- 7 UpdateSeason
# body param: body
echo '{"autoClaim": false, "defaultLanguage": "k3KqVt7Y", "defaultRequiredExp": 30, "draftStoreId": "PRwkJ4RO", "end": "1991-06-25T00:00:00Z", "excessStrategy": {"currency": "JE9yC2vn", "method": "NONE", "percentPerExp": 89}, "images": [{"as": "javomFLb", "caption": "8L32tvPv", "height": 63, "imageUrl": "xNreFbGM", "smallImageUrl": "Awx0wlFh", "width": 12}, {"as": "D7vyrgAI", "caption": "sXl9sEQW", "height": 64, "imageUrl": "VOe7NJvv", "smallImageUrl": "ZycZxY7R", "width": 20}, {"as": "FQ2QEvMX", "caption": "nFDyOHCo", "height": 77, "imageUrl": "KV56yWdR", "smallImageUrl": "QDBSKEGg", "width": 14}], "localizations": {"yg1aVV30": {"description": "fcPunFRF", "title": "TfbH0QZJ"}, "9FXdjiIv": {"description": "oCXsZ09H", "title": "nSgVFweE"}, "xxA1YOhU": {"description": "wp7U9Meu", "title": "a9bqcBo7"}}, "name": "TYlrCbSi", "start": "1993-09-29T00:00:00Z", "tierItemId": "ACVS06wD"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op UpdateSeason \
    --namespace $AB_NAMESPACE \
    --seasonId '2GZ43OPx' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'UpdateSeason' test.out

#- 8 CloneSeason
# body param: body
echo '{"end": "1992-05-30T00:00:00Z", "name": "10XBHoir", "start": "1993-12-16T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op CloneSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'ZYwDKPgZ' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'CloneSeason' test.out

#- 9 GetFullSeason
$CLI_EXE \
    --sn seasonpass \
    --op GetFullSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'B0nRBi88' \
    > test.out 2>&1
eval_tap $? 9 'GetFullSeason' test.out

#- 10 QueryPasses
$CLI_EXE \
    --sn seasonpass \
    --op QueryPasses \
    --namespace $AB_NAMESPACE \
    --seasonId '49A5QcnA' \
    > test.out 2>&1
eval_tap $? 10 'QueryPasses' test.out

#- 11 CreatePass
# body param: body
echo '{"autoEnroll": false, "code": "Ly3sGoO8", "displayOrder": 34, "images": [{"as": "caQheVwu", "caption": "1hk4704Y", "height": 58, "imageUrl": "arPpGdik", "smallImageUrl": "jAaApcdX", "width": 47}, {"as": "h3cO2uHq", "caption": "RWI1b4wQ", "height": 84, "imageUrl": "Gb4fn2o8", "smallImageUrl": "x0LbN5Jz", "width": 94}, {"as": "h6HWo1u8", "caption": "S8gyycod", "height": 76, "imageUrl": "fF6ojHVs", "smallImageUrl": "sHgm2ILH", "width": 84}], "localizations": {"NiFJKHzw": {"description": "5eCH1IC3", "title": "AVAzdhgk"}, "IiH7LFOv": {"description": "YMvuWt2h", "title": "ntc9MXrf"}, "NLEfc95d": {"description": "wi3kBj8L", "title": "RbKB1F8y"}}, "passItemId": "hHMXO2DZ"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op CreatePass \
    --namespace $AB_NAMESPACE \
    --seasonId '2jyRt2jv' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'CreatePass' test.out

#- 12 GetPass
$CLI_EXE \
    --sn seasonpass \
    --op GetPass \
    --code 'Z3XSFBvw' \
    --namespace $AB_NAMESPACE \
    --seasonId 'GSUSwtFw' \
    > test.out 2>&1
eval_tap $? 12 'GetPass' test.out

#- 13 DeletePass
$CLI_EXE \
    --sn seasonpass \
    --op DeletePass \
    --code 'wbfunOYO' \
    --namespace $AB_NAMESPACE \
    --seasonId '2cs3UKC0' \
    > test.out 2>&1
eval_tap $? 13 'DeletePass' test.out

#- 14 UpdatePass
# body param: body
echo '{"autoEnroll": true, "displayOrder": 43, "images": [{"as": "FSAwO1d6", "caption": "l7I12f87", "height": 47, "imageUrl": "zq6g51i8", "smallImageUrl": "rbuewmMP", "width": 46}, {"as": "uDfSGBQK", "caption": "yKkqQOXU", "height": 19, "imageUrl": "loF3Corz", "smallImageUrl": "IgeQoK7O", "width": 48}, {"as": "N4hSzwDu", "caption": "kTW0usyN", "height": 75, "imageUrl": "nK0uf0tP", "smallImageUrl": "AJjO1MiM", "width": 60}], "localizations": {"p79qQm8w": {"description": "Tydu4kZx", "title": "1vQysk6V"}, "EWp1g9cM": {"description": "G2YSZG5q", "title": "9klqKkWw"}, "AK2bz5hA": {"description": "Cx3SY2Tm", "title": "hivCYCmB"}}, "passItemId": "CEMXfxmS"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op UpdatePass \
    --code 'fKGcOw48' \
    --namespace $AB_NAMESPACE \
    --seasonId 'lUSVc2QG' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 14 'UpdatePass' test.out

#- 15 PublishSeason
$CLI_EXE \
    --sn seasonpass \
    --op PublishSeason \
    --namespace $AB_NAMESPACE \
    --seasonId '3RBiBpbp' \
    > test.out 2>&1
eval_tap $? 15 'PublishSeason' test.out

#- 16 RetireSeason
$CLI_EXE \
    --sn seasonpass \
    --op RetireSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'jcTp8bNY' \
    --force 'false' \
    > test.out 2>&1
eval_tap $? 16 'RetireSeason' test.out

#- 17 QueryRewards
$CLI_EXE \
    --sn seasonpass \
    --op QueryRewards \
    --namespace $AB_NAMESPACE \
    --seasonId 'NM8eFKhS' \
    --q 'cnCbp1RP' \
    > test.out 2>&1
eval_tap $? 17 'QueryRewards' test.out

#- 18 CreateReward
# body param: body
echo '{"code": "ZIyLTlAD", "currency": {"currencyCode": "ZLx97ocg", "namespace": "do0SwgJo"}, "image": {"as": "BsOdocWk", "caption": "vSmlqro8", "height": 17, "imageUrl": "XEUAbw0N", "smallImageUrl": "Q8P5ABgv", "width": 90}, "itemId": "EuzcVTsW", "quantity": 19, "type": "CURRENCY"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op CreateReward \
    --namespace $AB_NAMESPACE \
    --seasonId '2TYN84HG' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'CreateReward' test.out

#- 19 GetReward
$CLI_EXE \
    --sn seasonpass \
    --op GetReward \
    --code 'igOdHE6K' \
    --namespace $AB_NAMESPACE \
    --seasonId 'M5GmeAO8' \
    > test.out 2>&1
eval_tap $? 19 'GetReward' test.out

#- 20 DeleteReward
$CLI_EXE \
    --sn seasonpass \
    --op DeleteReward \
    --code 'qCbtd4bp' \
    --namespace $AB_NAMESPACE \
    --seasonId 'Uqi3JAWc' \
    > test.out 2>&1
eval_tap $? 20 'DeleteReward' test.out

#- 21 UpdateReward
# body param: body
echo '{"currency": {"currencyCode": "iBoSe4Td", "namespace": "JII9g2gY"}, "image": {"as": "4Au0ZQTB", "caption": "JN4uZmAf", "height": 98, "imageUrl": "AjBjaWJ8", "smallImageUrl": "Pig1mTYf", "width": 52}, "itemId": "wCoSsmDQ", "nullFields": ["X2gRRNDl", "SK4YngFr", "mGZo9Nc6"], "quantity": 81, "type": "ITEM"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op UpdateReward \
    --code 'nBbdB8h9' \
    --namespace $AB_NAMESPACE \
    --seasonId 'X6Vk1A2B' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'UpdateReward' test.out

#- 22 QueryTiers
$CLI_EXE \
    --sn seasonpass \
    --op QueryTiers \
    --namespace $AB_NAMESPACE \
    --seasonId 'dMp6FK4d' \
    --limit '9' \
    --offset '42' \
    > test.out 2>&1
eval_tap $? 22 'QueryTiers' test.out

#- 23 CreateTier
# body param: body
echo '{"index": 66, "quantity": 20, "tier": {"requiredExp": 90, "rewards": {"BSbWUttG": ["ywpypwOS", "a79SZMfG", "7K4Ml11w"], "H5Qf7Nmr": ["G6jzj7TI", "jtoEfKJg", "qlYkMRdv"], "98r7qqwp": ["lvsS0g6Y", "3AU5s3eE", "kmJANyyS"]}}}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op CreateTier \
    --namespace $AB_NAMESPACE \
    --seasonId 'StqJZxS1' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 23 'CreateTier' test.out

#- 24 UpdateTier
# body param: body
echo '{"requiredExp": 3, "rewards": {"4do4TFgx": ["ICyCvxsE", "ZsSpyAIq", "oxXgaBzL"], "M2lYoDHa": ["qtGlGj2J", "nsJRH6km", "lDAOrwVJ"], "tB2ayjLP": ["z8PuXfbc", "A3ds8a6f", "qQ0iwVuJ"]}}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op UpdateTier \
    --id 'Y9FhRHvr' \
    --namespace $AB_NAMESPACE \
    --seasonId 'mkx8pzzM' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'UpdateTier' test.out

#- 25 DeleteTier
$CLI_EXE \
    --sn seasonpass \
    --op DeleteTier \
    --id 'LPKHtNx0' \
    --namespace $AB_NAMESPACE \
    --seasonId 'a5yfdqoU' \
    > test.out 2>&1
eval_tap $? 25 'DeleteTier' test.out

#- 26 ReorderTier
# body param: body
echo '{"newIndex": 79}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op ReorderTier \
    --id 'zNwgiem2' \
    --namespace $AB_NAMESPACE \
    --seasonId 'lwYInj2k' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'ReorderTier' test.out

#- 27 UnpublishSeason
$CLI_EXE \
    --sn seasonpass \
    --op UnpublishSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'CgrI3Bn7' \
    --force 'false' \
    > test.out 2>&1
eval_tap $? 27 'UnpublishSeason' test.out

#- 28 GetUserParticipatedSeasons
$CLI_EXE \
    --sn seasonpass \
    --op GetUserParticipatedSeasons \
    --namespace $AB_NAMESPACE \
    --userId 'ClGeecU7' \
    --limit '46' \
    --offset '31' \
    > test.out 2>&1
eval_tap $? 28 'GetUserParticipatedSeasons' test.out

#- 29 GrantUserExp
# body param: body
echo '{"exp": 92, "source": "PAID_FOR", "tags": ["5RidVDhO", "1wAMiu04", "wOTGbITo"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op GrantUserExp \
    --namespace $AB_NAMESPACE \
    --userId 'MtoaTWmx' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'GrantUserExp' test.out

#- 30 GrantUserPass
# body param: body
echo '{"passCode": "WZwp7YTw", "passItemId": "J1giB8yp"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op GrantUserPass \
    --namespace $AB_NAMESPACE \
    --userId 'H2IarHbp' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 30 'GrantUserPass' test.out

#- 31 ExistsAnyPassByPassCodes
$CLI_EXE \
    --sn seasonpass \
    --op ExistsAnyPassByPassCodes \
    --namespace $AB_NAMESPACE \
    --userId 'iRBHFC2z' \
    --passCodes '["wRcgILhW", "qc69gopv", "rLODky7h"]' \
    > test.out 2>&1
eval_tap $? 31 'ExistsAnyPassByPassCodes' test.out

#- 32 GetCurrentUserSeasonProgression
$CLI_EXE \
    --sn seasonpass \
    --op GetCurrentUserSeasonProgression \
    --namespace $AB_NAMESPACE \
    --userId 'zPbYYcB3' \
    > test.out 2>&1
eval_tap $? 32 'GetCurrentUserSeasonProgression' test.out

#- 33 CheckSeasonPurchasable
# body param: body
echo '{"passItemId": "onoIOu58", "tierItemCount": 22, "tierItemId": "AyJEnBss"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op CheckSeasonPurchasable \
    --namespace $AB_NAMESPACE \
    --userId 'tdIMzYOB' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 33 'CheckSeasonPurchasable' test.out

#- 34 ResetUserSeason
$CLI_EXE \
    --sn seasonpass \
    --op ResetUserSeason \
    --namespace $AB_NAMESPACE \
    --userId 'RL4UAekz' \
    > test.out 2>&1
eval_tap $? 34 'ResetUserSeason' test.out

#- 35 GrantUserTier
# body param: body
echo '{"count": 57, "source": "SWEAT", "tags": ["JYW9O0So", "mYFex1YZ", "9g2xUPng"]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op GrantUserTier \
    --namespace $AB_NAMESPACE \
    --userId 'Gom7YEPV' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 35 'GrantUserTier' test.out

#- 36 QueryUserExpGrantHistory
$CLI_EXE \
    --sn seasonpass \
    --op QueryUserExpGrantHistory \
    --namespace $AB_NAMESPACE \
    --userId 'uSnNiVxZ' \
    --from 'isp6Re5d' \
    --limit '23' \
    --offset '91' \
    --seasonId '7gSYrAoL' \
    --source 'SWEAT' \
    --tags '["kqFH706C", "oMdB7MuZ", "ERJSrh5V"]' \
    --to 'j8mfGNtF' \
    > test.out 2>&1
eval_tap $? 36 'QueryUserExpGrantHistory' test.out

#- 37 QueryUserExpGrantHistoryTag
$CLI_EXE \
    --sn seasonpass \
    --op QueryUserExpGrantHistoryTag \
    --namespace $AB_NAMESPACE \
    --userId 'c4I3OxYu' \
    --seasonId 'b0wHOKSB' \
    > test.out 2>&1
eval_tap $? 37 'QueryUserExpGrantHistoryTag' test.out

#- 38 GetUserSeason
$CLI_EXE \
    --sn seasonpass \
    --op GetUserSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'A15gSgZr' \
    --userId 'LALKmykT' \
    > test.out 2>&1
eval_tap $? 38 'GetUserSeason' test.out

#- 39 PublicGetCurrentSeason
$CLI_EXE \
    --sn seasonpass \
    --op PublicGetCurrentSeason \
    --namespace $AB_NAMESPACE \
    --language 'P6psUFHk' \
    > test.out 2>&1
eval_tap $? 39 'PublicGetCurrentSeason' test.out

#- 40 PublicGetCurrentUserSeason
$CLI_EXE \
    --sn seasonpass \
    --op PublicGetCurrentUserSeason \
    --namespace $AB_NAMESPACE \
    --userId 'fNnW2SaV' \
    > test.out 2>&1
eval_tap $? 40 'PublicGetCurrentUserSeason' test.out

#- 41 PublicClaimUserReward
# body param: body
echo '{"passCode": "zQw0K0aP", "rewardCode": "uDivTI7P", "tierIndex": 71}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn seasonpass \
    --op PublicClaimUserReward \
    --namespace $AB_NAMESPACE \
    --userId 'CJSiTdf5' \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 41 'PublicClaimUserReward' test.out

#- 42 PublicBulkClaimUserRewards
$CLI_EXE \
    --sn seasonpass \
    --op PublicBulkClaimUserRewards \
    --namespace $AB_NAMESPACE \
    --userId 'wfz1U9po' \
    > test.out 2>&1
eval_tap $? 42 'PublicBulkClaimUserRewards' test.out

#- 43 PublicGetUserSeason
$CLI_EXE \
    --sn seasonpass \
    --op PublicGetUserSeason \
    --namespace $AB_NAMESPACE \
    --seasonId 'mLfO0Z1X' \
    --userId 'NCiqMsHx' \
    > test.out 2>&1
eval_tap $? 43 'PublicGetUserSeason' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE