#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '85' \
    --offset '47' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "lUmIGJO7", "description": "zd6hQF9z", "find_match_timeout_seconds": 57, "game_mode": "rsi8hCYE", "joinable": true, "max_delay_ms": 54, "rule_set": {"alliance": {"combination": {"alliances": [{"max": 80, "min": 16, "name": "Bt8qgg8a"}, {"max": 74, "min": 51, "name": "XOXaylNu"}, {"max": 40, "min": 83, "name": "ms3bXN2v"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 2, "role_flexing_second": 78}, "max_number": 25, "min_number": 3, "player_max_number": 6, "player_min_number": 10}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 33, "min": 35, "name": "kuxrdqJE"}, {"max": 81, "min": 23, "name": "zlOlxn3X"}, {"max": 24, "min": 12, "name": "DHRF9p4h"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 37, "role_flexing_second": 58}, "duration": 43, "max_number": 55, "min_number": 17, "player_max_number": 27, "player_min_number": 59}, {"combination": {"alliances": [{"max": 71, "min": 71, "name": "ciqnEoFB"}, {"max": 13, "min": 53, "name": "WAmVI21d"}, {"max": 25, "min": 81, "name": "4zkQzOLC"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 63, "role_flexing_second": 0}, "duration": 33, "max_number": 83, "min_number": 45, "player_max_number": 3, "player_min_number": 9}, {"combination": {"alliances": [{"max": 41, "min": 47, "name": "4ZinM2uK"}, {"max": 85, "min": 44, "name": "jZWFKNBI"}, {"max": 22, "min": 5, "name": "tVVIWEB7"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 61, "role_flexing_second": 5}, "duration": 21, "max_number": 88, "min_number": 80, "player_max_number": 36, "player_min_number": 46}], "flexing_rule": [{"attribute": "TG3evE4w", "criteria": "GZXyhaY9", "duration": 59, "reference": 0.984732801323904}, {"attribute": "FQTRcsxz", "criteria": "UEQ6Ar5r", "duration": 19, "reference": 0.49668461840906697}, {"attribute": "nmmX14MM", "criteria": "NZt0hZVW", "duration": 26, "reference": 0.15426972912389958}], "match_options": {"options": [{"name": "c8tf6qrl", "type": "cOKOSh87"}, {"name": "bHLVtZVG", "type": "pT2XBh6v"}, {"name": "TJM3Ee5J", "type": "W1GbMhhv"}]}, "matching_rule": [{"attribute": "OQzQmjhf", "criteria": "KQz0jKir", "reference": 0.9988229037193639}, {"attribute": "PgJmqMer", "criteria": "9N1CzUEr", "reference": 0.055791112055137315}, {"attribute": "xYyyQob8", "criteria": "AjMBEwlg", "reference": 0.4676759261623087}], "rebalance_enable": false, "sub_game_modes": {"iXtPdVoK": {"alliance": {"combination": {"alliances": [{"max": 1, "min": 56, "name": "SWlRhFrS"}, {"max": 30, "min": 84, "name": "drhCEU9m"}, {"max": 87, "min": 33, "name": "Eqs2Cf9i"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 42, "role_flexing_second": 60}, "max_number": 84, "min_number": 55, "player_max_number": 56, "player_min_number": 87}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 10, "min": 94, "name": "wK1AyFw2"}, {"max": 76, "min": 49, "name": "0HQua7Gf"}, {"max": 83, "min": 47, "name": "yaKYfO5c"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 45, "role_flexing_second": 1}, "duration": 100, "max_number": 71, "min_number": 32, "player_max_number": 6, "player_min_number": 30}, {"combination": {"alliances": [{"max": 18, "min": 63, "name": "TsNDsHLn"}, {"max": 10, "min": 23, "name": "VHwdqicC"}, {"max": 82, "min": 90, "name": "1s8ycGGn"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 52, "role_flexing_second": 2}, "duration": 77, "max_number": 6, "min_number": 5, "player_max_number": 77, "player_min_number": 16}, {"combination": {"alliances": [{"max": 86, "min": 82, "name": "cNxWSTRo"}, {"max": 60, "min": 25, "name": "L1mPwdMY"}, {"max": 32, "min": 3, "name": "jB9RjCq1"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 11, "role_flexing_second": 70}, "duration": 21, "max_number": 87, "min_number": 58, "player_max_number": 87, "player_min_number": 12}], "name": "0I1W7S7g"}, "xnB7EdK8": {"alliance": {"combination": {"alliances": [{"max": 7, "min": 87, "name": "SOmkaIbU"}, {"max": 74, "min": 75, "name": "7NH4tAbu"}, {"max": 79, "min": 11, "name": "rKiJxPcu"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 31, "role_flexing_second": 61}, "max_number": 0, "min_number": 48, "player_max_number": 79, "player_min_number": 66}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 81, "min": 55, "name": "rjYANbxr"}, {"max": 34, "min": 77, "name": "2ubQMbyZ"}, {"max": 89, "min": 36, "name": "AEYRfyNx"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 92, "role_flexing_second": 77}, "duration": 16, "max_number": 41, "min_number": 22, "player_max_number": 81, "player_min_number": 77}, {"combination": {"alliances": [{"max": 73, "min": 2, "name": "asKMXjEr"}, {"max": 61, "min": 88, "name": "HIv8VgKs"}, {"max": 49, "min": 57, "name": "C8yBT4Ei"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 41, "role_flexing_second": 26}, "duration": 9, "max_number": 49, "min_number": 79, "player_max_number": 2, "player_min_number": 90}, {"combination": {"alliances": [{"max": 6, "min": 23, "name": "P869TFMx"}, {"max": 63, "min": 47, "name": "1mpbjvkU"}, {"max": 37, "min": 19, "name": "jRxHlrW4"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 86, "role_flexing_second": 65}, "duration": 76, "max_number": 96, "min_number": 81, "player_max_number": 44, "player_min_number": 85}], "name": "otiuh0sn"}, "4G5CXcss": {"alliance": {"combination": {"alliances": [{"max": 99, "min": 13, "name": "k9bALBwu"}, {"max": 84, "min": 83, "name": "Eza6mQly"}, {"max": 23, "min": 87, "name": "cagrvBeh"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 3, "role_flexing_second": 73}, "max_number": 38, "min_number": 95, "player_max_number": 32, "player_min_number": 90}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 50, "min": 13, "name": "WERUzozh"}, {"max": 45, "min": 55, "name": "awgHtn3w"}, {"max": 25, "min": 82, "name": "q7SrstEv"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 1, "role_flexing_second": 71}, "duration": 4, "max_number": 85, "min_number": 8, "player_max_number": 65, "player_min_number": 94}, {"combination": {"alliances": [{"max": 67, "min": 52, "name": "aDWo4XD5"}, {"max": 6, "min": 66, "name": "QxxnTgT6"}, {"max": 27, "min": 51, "name": "5yWFRFct"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 73, "role_flexing_second": 39}, "duration": 13, "max_number": 56, "min_number": 30, "player_max_number": 64, "player_min_number": 49}, {"combination": {"alliances": [{"max": 20, "min": 19, "name": "u5mqRuDY"}, {"max": 41, "min": 78, "name": "4KoYkAgL"}, {"max": 18, "min": 51, "name": "6vwyNINZ"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 4, "role_flexing_second": 23}, "duration": 90, "max_number": 22, "min_number": 94, "player_max_number": 22, "player_min_number": 47}], "name": "61gxGQVT"}}}, "session_queue_timeout_seconds": 85, "social_matchmaking": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'r9hcJzqN' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'DeleteChannelHandler' test.out

#- 7 StoreMatchResults
# body param: body
echo '{"match_id": "wdIptYzm", "players": [{"results": [{"attribute": "nT3gYhXe", "value": 0.8552136809334685}, {"attribute": "Nbb2LYGb", "value": 0.35566677409160274}, {"attribute": "9wYpYIhQ", "value": 0.750039813829295}], "user_id": "9xMJKOEU"}, {"results": [{"attribute": "OrmW3Dor", "value": 0.21754000657060402}, {"attribute": "SfAN38CQ", "value": 0.3557822256736649}, {"attribute": "WhWya3YR", "value": 0.5849538262866879}], "user_id": "cAGH4hlT"}, {"results": [{"attribute": "L6WO6ojD", "value": 0.03877133654178111}, {"attribute": "cya5HsNZ", "value": 0.17522219035251252}, {"attribute": "IeX2EbJf", "value": 0.760088457128045}], "user_id": "GPk4X7dg"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'StoreMatchResults' test.out

#- 8 Rebalance
# body param: body
echo '{"match_id": "2pqAycXD"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'Rebalance' test.out

#- 9 QueueSessionHandler
# body param: body
echo '{"channel": "BIn8Oz8t", "client_version": "4ZYAUSBL", "deployment": "FrKIHDMe", "error_code": 94, "error_message": "QL9KVm5d", "game_mode": "Nh4pNU5l", "joinable": false, "match_id": "diSCV52P", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 80, "party_attributes": {"Zhdw9BYR": {}, "5GthWwFC": {}, "LDAlJrnv": {}}, "party_id": "zCY7LVPw", "party_members": [{"extra_attributes": {"qa42kLQn": {}, "HJ7B3Nbf": {}, "cpuRo0RB": {}}, "user_id": "xlHXrkpT"}, {"extra_attributes": {"Nmumu21b": {}, "YvJKP9tE": {}, "i9ep0UVv": {}}, "user_id": "FH1KWOGU"}, {"extra_attributes": {"3bBsAUXr": {}, "AoTJkzBi": {}, "YqQLiUjg": {}}, "user_id": "fACmlJYl"}], "ticket_created_at": 74, "ticket_id": "lg8SxAbt"}, {"first_ticket_created_at": 70, "party_attributes": {"cwEHliWV": {}, "HV0zLrm9": {}, "BR4EbsPd": {}}, "party_id": "SSjjXPsR", "party_members": [{"extra_attributes": {"8LQRQMoG": {}, "XYv9CIjw": {}, "XNyuoM0J": {}}, "user_id": "cwpO3CYB"}, {"extra_attributes": {"c3rhwlxT": {}, "KslN8kOI": {}, "5diFPjZr": {}}, "user_id": "XNi52bAj"}, {"extra_attributes": {"bB8rk5o3": {}, "HezsSVno": {}, "fKEbyRIG": {}}, "user_id": "CXDwZ1Y6"}], "ticket_created_at": 10, "ticket_id": "ReQVk3Ee"}, {"first_ticket_created_at": 19, "party_attributes": {"jx3SHUGJ": {}, "33NCn2vA": {}, "KfuQHmyK": {}}, "party_id": "FxoWMnFg", "party_members": [{"extra_attributes": {"XpE9rH5h": {}, "PCqcZyYe": {}, "dypkFN1k": {}}, "user_id": "It3kkvRS"}, {"extra_attributes": {"8FuM9hvq": {}, "MZvnxj1R": {}, "90ofe3CQ": {}}, "user_id": "ipWw5EfT"}, {"extra_attributes": {"GKzbDScp": {}, "E4qqwfLg": {}, "eLCPCTjB": {}}, "user_id": "sqcJwOnZ"}], "ticket_created_at": 0, "ticket_id": "O1BbG3FY"}]}, {"matching_parties": [{"first_ticket_created_at": 77, "party_attributes": {"XgbTurtc": {}, "UlNHbJaj": {}, "LB8k12Hg": {}}, "party_id": "hjtiPPLW", "party_members": [{"extra_attributes": {"lRmdl7HG": {}, "VOhuFiUl": {}, "zJemfchz": {}}, "user_id": "EtGfmI66"}, {"extra_attributes": {"TIeIZGH7": {}, "Tpai3X9n": {}, "R4yK18hK": {}}, "user_id": "GZlsQgb5"}, {"extra_attributes": {"AZTElkmB": {}, "oLwOgx45": {}, "hBxLwM7s": {}}, "user_id": "FnyaviSP"}], "ticket_created_at": 52, "ticket_id": "5Qutiy9W"}, {"first_ticket_created_at": 72, "party_attributes": {"xs8v5uWT": {}, "Egir9TxM": {}, "WahPZNZV": {}}, "party_id": "cAADshYF", "party_members": [{"extra_attributes": {"FDGKDunu": {}, "wiJ0OmNH": {}, "GkhM66lk": {}}, "user_id": "sr5aKIQR"}, {"extra_attributes": {"AlFPUU1y": {}, "W6ZwBdP0": {}, "FezKcNEw": {}}, "user_id": "4w06zvNo"}, {"extra_attributes": {"GBuiIGQM": {}, "wBvpYHxa": {}, "xGCHjjw0": {}}, "user_id": "Fo5GNLk9"}], "ticket_created_at": 8, "ticket_id": "i3ijSaos"}, {"first_ticket_created_at": 62, "party_attributes": {"FMEjXyCY": {}, "UsEX1MOE": {}, "NJwjjTJj": {}}, "party_id": "uMyjIeyN", "party_members": [{"extra_attributes": {"ot1jGXh3": {}, "NB1pknYr": {}, "E2Fqr8SO": {}}, "user_id": "oRktScX9"}, {"extra_attributes": {"KmT6KcCy": {}, "LhocSQFO": {}, "D5YD6XS7": {}}, "user_id": "wP1ekmxX"}, {"extra_attributes": {"jFIdPisW": {}, "L5SnOoYg": {}, "id0e3ZOj": {}}, "user_id": "YyuTBem2"}], "ticket_created_at": 89, "ticket_id": "t5b2ljHq"}]}, {"matching_parties": [{"first_ticket_created_at": 1, "party_attributes": {"LZFz1t9i": {}, "2Ld3WfTC": {}, "QtWGYrjX": {}}, "party_id": "9jjKapJx", "party_members": [{"extra_attributes": {"l0Oluxv9": {}, "ScqyFjJf": {}, "UPxnEH0t": {}}, "user_id": "G9l8H6GJ"}, {"extra_attributes": {"HDbrktyI": {}, "wCihHunI": {}, "PX19gSLh": {}}, "user_id": "8GPzS1lR"}, {"extra_attributes": {"aKOPudp1": {}, "4kfJhv5i": {}, "xcQS7YrW": {}}, "user_id": "OKH9Oe2B"}], "ticket_created_at": 7, "ticket_id": "EtkusASo"}, {"first_ticket_created_at": 57, "party_attributes": {"8HcNOTLJ": {}, "bGlxOkWB": {}, "NN4sp0XI": {}}, "party_id": "4FRiQNKp", "party_members": [{"extra_attributes": {"S4b8GkoK": {}, "NcJZGkZP": {}, "wuZiDPxi": {}}, "user_id": "PABc6iMn"}, {"extra_attributes": {"7ovTYxQi": {}, "QWRB0Tqo": {}, "ERTVroPL": {}}, "user_id": "bfltJcYm"}, {"extra_attributes": {"6VRQ6xqf": {}, "2Yy7aqcL": {}, "DTCyiczf": {}}, "user_id": "AkT7zPu0"}], "ticket_created_at": 4, "ticket_id": "3hHZlK2k"}, {"first_ticket_created_at": 60, "party_attributes": {"MDd2q8JA": {}, "xm5ANkpZ": {}, "2nWmQS5a": {}}, "party_id": "lsKT0a6k", "party_members": [{"extra_attributes": {"lqWUPRvY": {}, "LAst6UiS": {}, "dLMMacas": {}}, "user_id": "8PNxM1zv"}, {"extra_attributes": {"WLPjaPEn": {}, "tkJkGpgG": {}, "qq9pDIWb": {}}, "user_id": "EbTQk1Io"}, {"extra_attributes": {"H5tOUveO": {}, "FqVYP2jV": {}, "b3nxkPqt": {}}, "user_id": "HfXRMqGl"}], "ticket_created_at": 23, "ticket_id": "YghLDSv7"}]}], "namespace": "ZQ7wanp0", "party_attributes": {"uU52lE5l": {}, "WGap1dwc": {}, "rHeMefQ3": {}}, "party_id": "qEg05AOc", "queued_at": 74, "region": "mIAdH9vt", "server_name": "AQWHSrZf", "status": "jLmPLYrl", "ticket_id": "RYY4x7FQ", "updated_at": "1982-07-21T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'QueueSessionHandler' test.out

#- 10 DequeueSessionHandler
# body param: body
echo '{"match_id": "9oNwZm41"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'DequeueSessionHandler' test.out

#- 11 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'xxgI94PV' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'QuerySessionHandler' test.out

#- 12 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 22, "userID": "LfZuaqoV", "weight": 0.7490077775731963}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 12 'UpdatePlayTimeWeight' test.out

#- 13 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'GetAllPartyInAllChannel' test.out

#- 14 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'xFjVmD49' \
    > test.out 2>&1
eval_tap $? 14 'BulkGetSessions' test.out

#- 15 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'ExportChannels' test.out

#- 16 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'qfyLgM0T' \
    > test.out 2>&1
eval_tap $? 16 'ImportChannels' test.out

#- 17 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName '6Vr1Ig8i' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'GetSingleMatchmakingChannel' test.out

#- 18 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "28oh8F0p", "description": "Gq0K6B9l", "findMatchTimeoutSeconds": 60, "joinable": true, "max_delay_ms": 95, "ruleSet": {"alliance": {"combination": {"alliances": [{"max": 17, "min": 60, "name": "8w09rzmL"}, {"max": 73, "min": 94, "name": "31REs2Wm"}, {"max": 31, "min": 100, "name": "wyy1xOnj"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 31}, "maxNumber": 7, "minNumber": 45, "playerMaxNumber": 37, "playerMinNumber": 70}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 88, "min": 73, "name": "05As8G5G"}, {"max": 48, "min": 10, "name": "e6AZVzm0"}, {"max": 84, "min": 88, "name": "BFOZ1NvU"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 55, "role_flexing_second": 29}, "duration": 74, "max_number": 17, "min_number": 46, "player_max_number": 91, "player_min_number": 34}, {"combination": {"alliances": [{"max": 76, "min": 28, "name": "3DlTClhm"}, {"max": 28, "min": 80, "name": "mV92UoAO"}, {"max": 33, "min": 81, "name": "2INLKtnW"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 94, "role_flexing_second": 26}, "duration": 73, "max_number": 74, "min_number": 96, "player_max_number": 28, "player_min_number": 27}, {"combination": {"alliances": [{"max": 15, "min": 37, "name": "cBXEf9Ir"}, {"max": 99, "min": 15, "name": "KBvVfgyU"}, {"max": 87, "min": 23, "name": "xxzm6Rii"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 49, "role_flexing_second": 20}, "duration": 95, "max_number": 63, "min_number": 3, "player_max_number": 84, "player_min_number": 91}], "flexingRules": [{"attribute": "OBjXHXRZ", "criteria": "MQS6T90s", "duration": 62, "reference": 0.1386309307999698}, {"attribute": "x1XxkZ0G", "criteria": "Vz3C91OY", "duration": 35, "reference": 0.283274205441709}, {"attribute": "XHOMiiyd", "criteria": "9X9Jfiol", "duration": 25, "reference": 0.5460481147416189}], "match_options": {"options": [{"name": "FDIkjdFg", "type": "NfcD1Czd"}, {"name": "RbOuLTd5", "type": "xmgOXVQy"}, {"name": "wqPrprJQ", "type": "ITXqrzzb"}]}, "matchingRules": [{"attribute": "JcaAMpZT", "criteria": "TSdbfD6Z", "reference": 0.19713210369877243}, {"attribute": "gxlwZu47", "criteria": "heGtisS8", "reference": 0.2936770812474816}, {"attribute": "PLknSYJe", "criteria": "Hpdz4zxE", "reference": 0.7168890382244252}], "sub_game_modes": {}}, "sessionQueueTimeoutSeconds": 95, "socialMatchmaking": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'XFZ6YmDf' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'UpdateMatchmakingChannel' test.out

#- 19 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName '7Xd14dog' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'GetAllPartyInChannel' test.out

#- 20 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName '7oxu2xtT' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'GetAllSessionsInChannel' test.out

#- 21 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["ZIDiWI73", "iEvDQKGO", "xoGJ9ep6"], "party_id": "WuvhBubB", "user_id": "ylI7o5lG"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'a8rtN2wV' \
    --matchID 'gWgPCk7y' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AddUserIntoSessionInChannel' test.out

#- 22 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'xEUuE6Tb' \
    --matchID 'Ymba36sX' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'DeleteSessionInChannel' test.out

#- 23 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'bQ6LptOg' \
    --matchID '625xTcwU' \
    --namespace $AB_NAMESPACE \
    --userID 'ChY0wTTe' \
    > test.out 2>&1
eval_tap $? 23 'DeleteUserFromSessionInChannel' test.out

#- 24 SearchSessions
eval_tap 0 24 'SearchSessions # SKIP deprecated' test.out

#- 25 GetSessionHistoryDetailed
eval_tap 0 25 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 26 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 26 'PublicGetMessages' test.out

#- 27 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'PublicGetAllMatchmakingChannel' test.out

#- 28 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'F4hR6e9e' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'PublicGetSingleMatchmakingChannel' test.out

#- 29 SearchSessionsV2
eval_tap 0 29 'SearchSessionsV2 # SKIP deprecated' test.out

#- 30 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 30 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE