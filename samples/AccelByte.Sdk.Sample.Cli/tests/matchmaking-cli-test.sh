#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '91' \
    --offset '8' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "gSAYLjWy", "description": "JKnrZeJN", "find_match_timeout_seconds": 20, "game_mode": "vy6cANAt", "joinable": true, "max_delay_ms": 91, "rule_set": {"alliance": {"combination": {"alliances": [{"max": 35, "min": 89, "name": "4B08OwF0"}, {"max": 72, "min": 57, "name": "WQSdBEzv"}, {"max": 26, "min": 88, "name": "87SqCJBW"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 16, "role_flexing_second": 94}, "max_number": 19, "min_number": 74, "player_max_number": 53, "player_min_number": 39}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 57, "min": 51, "name": "iSUFwbge"}, {"max": 87, "min": 3, "name": "RgGMmJHl"}, {"max": 99, "min": 49, "name": "ihsQt322"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 83, "role_flexing_second": 98}, "duration": 63, "max_number": 27, "min_number": 91, "player_max_number": 89, "player_min_number": 15}, {"combination": {"alliances": [{"max": 66, "min": 45, "name": "mw3KlI8J"}, {"max": 30, "min": 58, "name": "CCpyrBy4"}, {"max": 93, "min": 27, "name": "uAthbRUf"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 34, "role_flexing_second": 46}, "duration": 39, "max_number": 40, "min_number": 78, "player_max_number": 32, "player_min_number": 45}, {"combination": {"alliances": [{"max": 10, "min": 67, "name": "YtiAW8a6"}, {"max": 72, "min": 52, "name": "vSrAHwba"}, {"max": 21, "min": 7, "name": "9xvxqT5q"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 87, "role_flexing_second": 32}, "duration": 10, "max_number": 97, "min_number": 77, "player_max_number": 39, "player_min_number": 77}], "flexing_rule": [{"attribute": "jNIq42lL", "criteria": "JoZKKua6", "duration": 83, "reference": 0.827289045096317}, {"attribute": "0tscWkZH", "criteria": "yQOvPX3X", "duration": 74, "reference": 0.12530983511677063}, {"attribute": "Yt4NCxF6", "criteria": "ZDnNCQUo", "duration": 46, "reference": 0.0036508100773352536}], "match_options": {"options": [{"name": "KfUdFfDV", "type": "gef6cdDt"}, {"name": "94R5ldfX", "type": "vnG3HWIR"}, {"name": "BxdGZxF7", "type": "5T2zZ0lE"}]}, "matching_rule": [{"attribute": "F7A6XdMU", "criteria": "y3PqfDhY", "reference": 0.4443640189451218}, {"attribute": "5HLmH8Hu", "criteria": "1o5ulf0T", "reference": 0.2684575012510029}, {"attribute": "WzBWTJm7", "criteria": "amRu05Lk", "reference": 0.5365717189100704}], "rebalance_enable": true, "sub_game_modes": {"VhGrSjQr": {"alliance": {"combination": {"alliances": [{"max": 73, "min": 14, "name": "btQfsi6p"}, {"max": 22, "min": 94, "name": "uqObr5hI"}, {"max": 50, "min": 46, "name": "ohqE8klT"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 86, "role_flexing_second": 47}, "max_number": 14, "min_number": 31, "player_max_number": 80, "player_min_number": 3}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 19, "min": 22, "name": "UCwCGFAk"}, {"max": 47, "min": 64, "name": "la8k4j8D"}, {"max": 42, "min": 23, "name": "68VBe9X1"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 74, "role_flexing_second": 1}, "duration": 23, "max_number": 13, "min_number": 19, "player_max_number": 59, "player_min_number": 82}, {"combination": {"alliances": [{"max": 21, "min": 10, "name": "2uh1ELGL"}, {"max": 30, "min": 59, "name": "mzKFO5hc"}, {"max": 52, "min": 73, "name": "atD741wK"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 9, "role_flexing_second": 76}, "duration": 21, "max_number": 24, "min_number": 3, "player_max_number": 73, "player_min_number": 57}, {"combination": {"alliances": [{"max": 15, "min": 94, "name": "K3l1VOYO"}, {"max": 93, "min": 92, "name": "Eo1nUIbO"}, {"max": 48, "min": 82, "name": "8qQkCYTC"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 55, "role_flexing_second": 12}, "duration": 92, "max_number": 56, "min_number": 69, "player_max_number": 45, "player_min_number": 79}], "name": "oOILYKnP"}, "SD6Dwct5": {"alliance": {"combination": {"alliances": [{"max": 99, "min": 84, "name": "FaiyZgtr"}, {"max": 86, "min": 91, "name": "CLuO5h2c"}, {"max": 90, "min": 71, "name": "SaD835Ym"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 17, "role_flexing_second": 59}, "max_number": 61, "min_number": 82, "player_max_number": 48, "player_min_number": 38}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 83, "min": 89, "name": "O0hJFn6O"}, {"max": 96, "min": 49, "name": "9Ul8G9Bg"}, {"max": 65, "min": 28, "name": "mNCOLdoT"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 84, "role_flexing_second": 6}, "duration": 95, "max_number": 35, "min_number": 100, "player_max_number": 98, "player_min_number": 92}, {"combination": {"alliances": [{"max": 3, "min": 71, "name": "bSRg8QEp"}, {"max": 100, "min": 75, "name": "kBgR2QHX"}, {"max": 71, "min": 57, "name": "XWU3TF0y"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 48, "role_flexing_second": 42}, "duration": 88, "max_number": 94, "min_number": 50, "player_max_number": 86, "player_min_number": 12}, {"combination": {"alliances": [{"max": 2, "min": 74, "name": "2NNjoHpV"}, {"max": 72, "min": 58, "name": "8SnHlMgH"}, {"max": 46, "min": 62, "name": "9stoSP6E"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 97, "role_flexing_second": 30}, "duration": 77, "max_number": 60, "min_number": 3, "player_max_number": 27, "player_min_number": 79}], "name": "5LExNqJX"}, "zC2o7uwN": {"alliance": {"combination": {"alliances": [{"max": 32, "min": 84, "name": "WTYYfrJ2"}, {"max": 54, "min": 51, "name": "GWLGuwAy"}, {"max": 38, "min": 26, "name": "Z9ZhphgP"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 5, "role_flexing_second": 9}, "max_number": 50, "min_number": 56, "player_max_number": 37, "player_min_number": 50}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 39, "min": 31, "name": "gMgFoiXX"}, {"max": 22, "min": 25, "name": "h9OyWLbg"}, {"max": 9, "min": 14, "name": "FfvFryp4"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 60, "role_flexing_second": 89}, "duration": 66, "max_number": 38, "min_number": 35, "player_max_number": 77, "player_min_number": 30}, {"combination": {"alliances": [{"max": 58, "min": 98, "name": "0ZRztFit"}, {"max": 100, "min": 76, "name": "VQjuJ5XY"}, {"max": 68, "min": 69, "name": "iraOtsmB"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 93, "role_flexing_second": 52}, "duration": 82, "max_number": 4, "min_number": 7, "player_max_number": 63, "player_min_number": 96}, {"combination": {"alliances": [{"max": 90, "min": 29, "name": "1qKFpnMX"}, {"max": 67, "min": 23, "name": "PgCGANPV"}, {"max": 52, "min": 0, "name": "Ai8cx3qz"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 32, "role_flexing_second": 45}, "duration": 63, "max_number": 86, "min_number": 87, "player_max_number": 51, "player_min_number": 74}], "name": "eDADb6OD"}}}, "session_queue_timeout_seconds": 1, "social_matchmaking": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'TNcD3Tpv' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'DeleteChannelHandler' test.out

#- 7 StoreMatchResults
# body param: body
echo '{"match_id": "69ccQcXB", "players": [{"results": [{"attribute": "j0q8ccju", "value": 0.696869530175448}, {"attribute": "PIC94uZ7", "value": 0.3326653078904491}, {"attribute": "a893oH8H", "value": 0.5653039927944465}], "user_id": "yarlXit2"}, {"results": [{"attribute": "hk46UT5W", "value": 0.8664229858843667}, {"attribute": "d9FwUV1s", "value": 0.926066654415878}, {"attribute": "02mIr6pU", "value": 0.8819996303909337}], "user_id": "gMkAwjoS"}, {"results": [{"attribute": "KoDdTCC7", "value": 0.9487063607999818}, {"attribute": "QDFEe2LQ", "value": 0.18845506430962966}, {"attribute": "x1whwK3Z", "value": 0.08837613900438179}], "user_id": "sQS9Ehs6"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'StoreMatchResults' test.out

#- 8 Rebalance
# body param: body
echo '{"match_id": "Z4amlRYi"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'Rebalance' test.out

#- 9 QueueSessionHandler
# body param: body
echo '{"channel": "yqvJTLzT", "client_version": "3cuSzqEk", "deployment": "kFBIKXZh", "error_code": 92, "error_message": "YvXe9Qzk", "game_mode": "YLsJdmbh", "joinable": true, "match_id": "Bi7I03ue", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 36, "party_attributes": {"7TWIorDl": {}, "nPaotkdn": {}, "RnFRTu8m": {}}, "party_id": "IujawXFw", "party_members": [{"extra_attributes": {"RYF3aVC1": {}, "M8ti12az": {}, "iJA6hRf8": {}}, "user_id": "ZEA1RtVR"}, {"extra_attributes": {"ee2gyOPH": {}, "QdSGgFQG": {}, "b3gndIRX": {}}, "user_id": "lQhFAjhT"}, {"extra_attributes": {"hstCOi3g": {}, "qjHqOwAt": {}, "loIHLpq1": {}}, "user_id": "lGXUCbGW"}], "ticket_created_at": 23, "ticket_id": "uE5m0EuC"}, {"first_ticket_created_at": 72, "party_attributes": {"9Z9FfKEs": {}, "DupMo1AN": {}, "9kr1e2wS": {}}, "party_id": "VNrw003Y", "party_members": [{"extra_attributes": {"xZp1y0Wb": {}, "oPtBQnIk": {}, "JfLwddzW": {}}, "user_id": "5zvxeoM8"}, {"extra_attributes": {"C1UbcVad": {}, "iqQffTM3": {}, "NPHqRi2s": {}}, "user_id": "gUwz2Mlt"}, {"extra_attributes": {"z8avTjZ3": {}, "pWqdn6zk": {}, "UWJOZggU": {}}, "user_id": "K7X8ZFoC"}], "ticket_created_at": 5, "ticket_id": "0YyYWDzh"}, {"first_ticket_created_at": 96, "party_attributes": {"oiAixqp0": {}, "I1JGS5f7": {}, "d0s4GVmH": {}}, "party_id": "T76Jqlly", "party_members": [{"extra_attributes": {"6obR1Wbn": {}, "5MwUhtmw": {}, "jRI5a6Hs": {}}, "user_id": "PMCAWuhc"}, {"extra_attributes": {"aitgH5eu": {}, "OZqx3ZsU": {}, "F99yNkk9": {}}, "user_id": "H8MnIK2R"}, {"extra_attributes": {"Scoz7Uwb": {}, "KLr8lpvr": {}, "clXkAzVW": {}}, "user_id": "5IJWK73k"}], "ticket_created_at": 100, "ticket_id": "ZeO3d4tG"}]}, {"matching_parties": [{"first_ticket_created_at": 56, "party_attributes": {"mDjXYfIa": {}, "NpIjzeAO": {}, "kerFPjax": {}}, "party_id": "jvvMewyT", "party_members": [{"extra_attributes": {"FtK9fu3g": {}, "0eyCNUsu": {}, "S4j1ZadF": {}}, "user_id": "j8W4XXyb"}, {"extra_attributes": {"oLKiGpmx": {}, "gVA6NnrV": {}, "RjdiofLK": {}}, "user_id": "QQse8YnR"}, {"extra_attributes": {"4wxW6xZj": {}, "DTYHj0St": {}, "RDDrcGwp": {}}, "user_id": "Q2pRROHQ"}], "ticket_created_at": 72, "ticket_id": "FVl4lciX"}, {"first_ticket_created_at": 78, "party_attributes": {"jzFkGgeP": {}, "AZVWFicG": {}, "aFpHqGg1": {}}, "party_id": "MsytFpIO", "party_members": [{"extra_attributes": {"BroJFgmI": {}, "BVSYlrWG": {}, "jkJHC8FN": {}}, "user_id": "1B5JmzFb"}, {"extra_attributes": {"btHuYq4d": {}, "73M2am2C": {}, "ZBGMXOuV": {}}, "user_id": "SJN0pPve"}, {"extra_attributes": {"XQ2zuYS3": {}, "gkOvKPox": {}, "qIod2ggw": {}}, "user_id": "64VSWj5j"}], "ticket_created_at": 11, "ticket_id": "JBDPavt1"}, {"first_ticket_created_at": 49, "party_attributes": {"uyM1cj9C": {}, "uXClYPTh": {}, "8xdavDAR": {}}, "party_id": "BlFqONBA", "party_members": [{"extra_attributes": {"JE7LHmi5": {}, "Pi4CprB2": {}, "klGlLLB2": {}}, "user_id": "PXtaoTAl"}, {"extra_attributes": {"USFCGgTR": {}, "vP3LYuzO": {}, "fPFSJGhu": {}}, "user_id": "6sDUyGfN"}, {"extra_attributes": {"GVKdhHoV": {}, "xI0QZTlE": {}, "iPZLroKF": {}}, "user_id": "0WQUhSrC"}], "ticket_created_at": 10, "ticket_id": "vqLOg5Ao"}]}, {"matching_parties": [{"first_ticket_created_at": 75, "party_attributes": {"8QuUnTIT": {}, "9QpVSICA": {}, "Fb411drt": {}}, "party_id": "MqfQ1CHO", "party_members": [{"extra_attributes": {"4WcAgpAs": {}, "o2vPtEdS": {}, "Qtx5IT6W": {}}, "user_id": "xARCFIIu"}, {"extra_attributes": {"J5PukPlM": {}, "z1W6Alay": {}, "d8kODCZM": {}}, "user_id": "0Z5t53kU"}, {"extra_attributes": {"66F38FCx": {}, "mwko3RMt": {}, "6D0BVHBR": {}}, "user_id": "1O455wZt"}], "ticket_created_at": 65, "ticket_id": "GVxrv3WY"}, {"first_ticket_created_at": 60, "party_attributes": {"7QNpKJym": {}, "bpdPsMC3": {}, "NPW9fetA": {}}, "party_id": "tDsKZXmt", "party_members": [{"extra_attributes": {"5VSWohns": {}, "uHjI0ObM": {}, "f0uJbd6g": {}}, "user_id": "HQwImNlU"}, {"extra_attributes": {"9FOqeOan": {}, "xfOdYXwK": {}, "lsaG0hYn": {}}, "user_id": "un1NPwdg"}, {"extra_attributes": {"i3TArZRA": {}, "QLpJRrfI": {}, "t8xiXTfb": {}}, "user_id": "pnTEPLhp"}], "ticket_created_at": 1, "ticket_id": "IjqrLtiw"}, {"first_ticket_created_at": 80, "party_attributes": {"0kbE6JKK": {}, "DlGLyi8X": {}, "cjcBOw9Y": {}}, "party_id": "Yzov21Jw", "party_members": [{"extra_attributes": {"egMgeINQ": {}, "5kkTxBxM": {}, "f4LkqZJ0": {}}, "user_id": "9AC65UwH"}, {"extra_attributes": {"DyezoiOr": {}, "vzo2scXl": {}, "3Hbhw9ll": {}}, "user_id": "R5s2JSA6"}, {"extra_attributes": {"ngW3sugw": {}, "cVypZAgj": {}, "RWMUojxp": {}}, "user_id": "bfC4Ta0b"}], "ticket_created_at": 88, "ticket_id": "XI8XLdn1"}]}], "namespace": "aruzB7aS", "party_attributes": {"wdOCyXNQ": {}, "XZOoRD4n": {}, "QEb8qvmM": {}}, "party_id": "3nt53gsH", "queued_at": 16, "region": "jebQ7Uze", "server_name": "0BYF3kNK", "status": "VGiKO9mx", "ticket_id": "0tsGiT6R", "updated_at": "1991-09-18T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'QueueSessionHandler' test.out

#- 10 DequeueSessionHandler
# body param: body
echo '{"match_id": "PXQN6ahm"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'DequeueSessionHandler' test.out

#- 11 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'oIMjEtJI' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'QuerySessionHandler' test.out

#- 12 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 64, "userID": "tGuewMuR", "weight": 0.7211991353259952}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 12 'UpdatePlayTimeWeight' test.out

#- 13 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'GetAllPartyInAllChannel' test.out

#- 14 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'x3SEVSgQ' \
    > test.out 2>&1
eval_tap $? 14 'BulkGetSessions' test.out

#- 15 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'ExportChannels' test.out

#- 16 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy '3hm011yj' \
    > test.out 2>&1
eval_tap $? 16 'ImportChannels' test.out

#- 17 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'hHHKMCK8' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'GetSingleMatchmakingChannel' test.out

#- 18 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "HADbgfJp", "description": "qcuMS4Q9", "findMatchTimeoutSeconds": 80, "joinable": true, "max_delay_ms": 72, "ruleSet": {"alliance": {"combination": {"alliances": [{"max": 70, "min": 67, "name": "k6FbwWpZ"}, {"max": 63, "min": 47, "name": "tSKTQmoa"}, {"max": 24, "min": 84, "name": "V1cTUB0n"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 94, "role_flexing_second": 46}, "maxNumber": 93, "minNumber": 83, "playerMaxNumber": 38, "playerMinNumber": 21}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 87, "min": 16, "name": "l36YhBte"}, {"max": 85, "min": 3, "name": "wq8iTwud"}, {"max": 76, "min": 33, "name": "M0xlPdIg"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 94, "role_flexing_second": 100}, "duration": 2, "max_number": 78, "min_number": 68, "player_max_number": 35, "player_min_number": 46}, {"combination": {"alliances": [{"max": 94, "min": 51, "name": "uITdF9kz"}, {"max": 4, "min": 77, "name": "FdrsKMUf"}, {"max": 27, "min": 67, "name": "XonHibzs"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 2, "role_flexing_second": 97}, "duration": 68, "max_number": 8, "min_number": 92, "player_max_number": 74, "player_min_number": 54}, {"combination": {"alliances": [{"max": 28, "min": 48, "name": "vnXFGyGN"}, {"max": 55, "min": 61, "name": "Nkpvsokd"}, {"max": 30, "min": 39, "name": "siep19kS"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 2, "role_flexing_second": 100}, "duration": 95, "max_number": 46, "min_number": 23, "player_max_number": 54, "player_min_number": 19}], "flexingRules": [{"attribute": "NIuivF1G", "criteria": "EfMuQMNB", "duration": 85, "reference": 0.09760063526460516}, {"attribute": "JXH9ALTT", "criteria": "s5LrNABD", "duration": 1, "reference": 0.0024917698380205744}, {"attribute": "HI9wd4Fx", "criteria": "8fgGZFwi", "duration": 30, "reference": 0.053546795487169674}], "match_options": {"options": [{"name": "ddhmWgWN", "type": "uMmS7ijI"}, {"name": "dBzjcIdh", "type": "inly4CyB"}, {"name": "ECJTWKvm", "type": "oahWam7G"}]}, "matchingRules": [{"attribute": "pbvxC5Pk", "criteria": "Vq6p7zfQ", "reference": 0.6216850960166113}, {"attribute": "XX2TYnJN", "criteria": "LS8AKmR6", "reference": 0.9150422112600313}, {"attribute": "CMONKgoO", "criteria": "swKLtARL", "reference": 0.6414115680960257}], "sub_game_modes": {}}, "sessionQueueTimeoutSeconds": 38, "socialMatchmaking": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'VqF8aYDU' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'UpdateMatchmakingChannel' test.out

#- 19 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'nTH1lBPl' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'GetAllPartyInChannel' test.out

#- 20 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'K9QIXizu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'GetAllSessionsInChannel' test.out

#- 21 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["LVEU5r8m", "Ie5EKBo5", "Xe9RBjhS"], "party_id": "wnMSXVBn", "user_id": "u6LmPMGJ"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'ibdTOQde' \
    --matchID '4PSV0WCQ' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AddUserIntoSessionInChannel' test.out

#- 22 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'c6T29kqg' \
    --matchID 'nP3lp4WX' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'DeleteSessionInChannel' test.out

#- 23 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'xPUcx1d7' \
    --matchID 'pAsOkFbm' \
    --namespace $AB_NAMESPACE \
    --userID 'VRvpKUVe' \
    > test.out 2>&1
eval_tap $? 23 'DeleteUserFromSessionInChannel' test.out

#- 24 SearchSessions
eval_tap 0 24 'SearchSessions # SKIP deprecated' test.out

#- 25 GetSessionHistoryDetailed
eval_tap 0 25 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 26 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 26 'PublicGetMessages' test.out

#- 27 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'PublicGetAllMatchmakingChannel' test.out

#- 28 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'wZSkpZFw' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'PublicGetSingleMatchmakingChannel' test.out

#- 29 SearchSessionsV2
eval_tap 0 29 'SearchSessionsV2 # SKIP deprecated' test.out

#- 30 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 30 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE