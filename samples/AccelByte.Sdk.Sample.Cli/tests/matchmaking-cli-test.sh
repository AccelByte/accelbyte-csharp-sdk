#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '2' \
    --offset '56' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatch", "deployment": "uz5zkoaUEzGS3qZf", "description": "0PbemSBELbZ0VBUG", "find_match_timeout_seconds": 54, "game_mode": "iRLR3IlNJKxhPfWV", "joinable": false, "max_delay_ms": 7, "region_expansion_range_ms": 71, "region_expansion_rate_ms": 92, "region_latency_initial_range_ms": 0, "region_latency_max_ms": 3, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 5, "min": 65, "name": "LxkZs4233oQWoXFe"}, {"max": 34, "min": 75, "name": "euI2oMJ0cgAoGfXe"}, {"max": 32, "min": 6, "name": "E3r5AQUBqS8KtTYZ"}], [{"max": 77, "min": 4, "name": "J58QqcV3IcuNs9MF"}, {"max": 57, "min": 17, "name": "T2KD18yrWorpC65V"}, {"max": 73, "min": 11, "name": "h4q1z1KJmKedBfbW"}], [{"max": 43, "min": 19, "name": "Ka5Ou124TsbQsxYF"}, {"max": 48, "min": 67, "name": "GGHrfQkgXkiA5IZP"}, {"max": 34, "min": 11, "name": "Cqp9vcyt67WAfWXf"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 58, "role_flexing_second": 45}, "max_number": 19, "min_number": 66, "player_max_number": 66, "player_min_number": 56}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 96, "min": 13, "name": "3tz8qIH4uRdNO08H"}, {"max": 82, "min": 46, "name": "6s9p8Y5c9eItJtiN"}, {"max": 26, "min": 47, "name": "Y3y3n2Rim4NBqhuN"}], [{"max": 40, "min": 5, "name": "j8FOvKZjs1tLpERf"}, {"max": 33, "min": 89, "name": "LzPoORBkRmZ0A2zy"}, {"max": 74, "min": 37, "name": "YCdfkfyt09ro5fHd"}], [{"max": 99, "min": 34, "name": "BZTYc5BsdSSVaAzz"}, {"max": 27, "min": 93, "name": "4GbgkKeCaS6qyUCs"}, {"max": 5, "min": 11, "name": "HXs8PlOBlfUOqv7W"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 57, "role_flexing_second": 42}, "duration": 76, "max_number": 33, "min_number": 95, "player_max_number": 5, "player_min_number": 99}, {"combination": {"alliances": [[{"max": 37, "min": 81, "name": "py8KrcQfucSq2X8g"}, {"max": 65, "min": 43, "name": "qU89D356pVsUtNan"}, {"max": 7, "min": 35, "name": "dzgwxYdQc5hEfefd"}], [{"max": 29, "min": 88, "name": "pcEM0JHfof2Hwi7v"}, {"max": 12, "min": 89, "name": "3osbh0fL2h7eJvAS"}, {"max": 3, "min": 100, "name": "foW8bDq5jPqzhN0Y"}], [{"max": 7, "min": 77, "name": "GSrA9LXRwU6WLgpQ"}, {"max": 62, "min": 59, "name": "9nXzhBC0uyMR4Xf2"}, {"max": 28, "min": 37, "name": "fYvNvG8uQ14Ahsxa"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 76, "role_flexing_second": 47}, "duration": 17, "max_number": 50, "min_number": 57, "player_max_number": 46, "player_min_number": 46}, {"combination": {"alliances": [[{"max": 32, "min": 90, "name": "NJornrCQpMJj5igq"}, {"max": 1, "min": 61, "name": "t8xnPoWTdHAkcyAy"}, {"max": 23, "min": 6, "name": "Ji4RbZ0Iy11mfOFj"}], [{"max": 58, "min": 12, "name": "zZVcGomWF1oAqUNF"}, {"max": 61, "min": 4, "name": "tXnXLvOAsW8wYh4g"}, {"max": 34, "min": 60, "name": "7pRVZVLJiDx3au9b"}], [{"max": 64, "min": 88, "name": "zeiMRkcOr1L0TMIc"}, {"max": 52, "min": 3, "name": "jfdUQHa3RxspSqwd"}, {"max": 3, "min": 25, "name": "TR2sgzfaQrUCW9fg"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 45, "role_flexing_second": 85}, "duration": 14, "max_number": 3, "min_number": 58, "player_max_number": 22, "player_min_number": 4}], "batch_size": 64, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 0, "flex_flat_step_range": 61, "flex_immunity_count": 47, "flex_range_max": 25, "flex_rate_ms": 94, "flex_step_max": 2, "force_authority_match": true, "initial_step_range": 28, "mmr_max": 25, "mmr_mean": 96, "mmr_min": 49, "mmr_std_dev": 34, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "QTpvLH6QPEBP8kSS", "criteria": "FjeuL3wQQPYwmYFb", "duration": 49, "reference": 0.5686017699127481}, {"attribute": "6fs3zL9H4WxGWRH7", "criteria": "fz4BdPhLtHRJOImS", "duration": 34, "reference": 0.9538342051188905}, {"attribute": "DTswnkSyuJTVjKQ1", "criteria": "ORLEIAePvDO2xkVg", "duration": 50, "reference": 0.6089764736884469}], "match_options": {"options": [{"name": "zSpDFY3lxe16KsSR", "type": "zkf2HzBcEio5Uyvu"}, {"name": "Fv5z6wosJGnUyCME", "type": "bHh1uE4DmJ4Suj6D"}, {"name": "jUw36GtZ83Jp2f9f", "type": "1FCoIo3L24DKGwgZ"}]}, "matching_rule": [{"attribute": "85vyFJR8euQBLVu2", "criteria": "7iwplLJdzYS9K0Vv", "reference": 0.3585251564443177}, {"attribute": "E6MAqPc8lGIYWTwx", "criteria": "yqQQIXVmrtRlq1jv", "reference": 0.9413170357931668}, {"attribute": "0HTnmFrl3gYx6Xmv", "criteria": "1DzPHux3k3skhn3m", "reference": 0.7833695949904633}], "rebalance_enable": true, "sort_ticket": {"search_result": "largestPartySize", "ticket_queue": "oldestTicketAge"}, "sort_tickets": [{"search_result": "distance", "threshold": 78, "ticket_queue": "none"}, {"search_result": "distance", "threshold": 89, "ticket_queue": "distance"}, {"search_result": "distance", "threshold": 92, "ticket_queue": "none"}], "sub_game_modes": {"aZw4NqSNylcljuNM": {"alliance": {"combination": {"alliances": [[{"max": 53, "min": 9, "name": "j9mHFpff2vDkz68z"}, {"max": 30, "min": 35, "name": "86un0L98WUoXvfU4"}, {"max": 34, "min": 92, "name": "MIpfgxw2ff5twRYb"}], [{"max": 40, "min": 7, "name": "Rwubq7wtRGdT447O"}, {"max": 0, "min": 2, "name": "1m6VLfjsw270pMmO"}, {"max": 87, "min": 93, "name": "JrpEBbVvBn8Lsf2q"}], [{"max": 92, "min": 30, "name": "AtizV9hzsVbpJLtE"}, {"max": 32, "min": 19, "name": "AAXNzcpbmX3lLFeX"}, {"max": 58, "min": 44, "name": "iaXP8jBjK81t2V9T"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 46, "role_flexing_second": 42}, "max_number": 90, "min_number": 65, "player_max_number": 48, "player_min_number": 5}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 4, "min": 66, "name": "REyU5CwqGJF6nDi3"}, {"max": 16, "min": 70, "name": "RYkbhEM1zTNY3lpi"}, {"max": 28, "min": 31, "name": "cuf5d5saQvKfFRqB"}], [{"max": 0, "min": 25, "name": "VVCc9bpIHEWQMmCk"}, {"max": 71, "min": 28, "name": "qwqpoTVCNrcaVozs"}, {"max": 20, "min": 54, "name": "IXO2EUsAfBvo6Llc"}], [{"max": 1, "min": 23, "name": "j1AJ3hNWWhADRqJv"}, {"max": 0, "min": 75, "name": "rf2qXQFCzRV1paEL"}, {"max": 18, "min": 47, "name": "5dw3LK0gPYhPPG5s"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 71, "role_flexing_second": 38}, "duration": 11, "max_number": 55, "min_number": 98, "player_max_number": 39, "player_min_number": 4}, {"combination": {"alliances": [[{"max": 30, "min": 41, "name": "zA2OntGCwQSHHdPL"}, {"max": 46, "min": 54, "name": "jTngrvb2E1X9ecBB"}, {"max": 15, "min": 90, "name": "RAYjR7c4x5bIk8pV"}], [{"max": 32, "min": 48, "name": "sp2x9mszGGoyhGZA"}, {"max": 52, "min": 98, "name": "t2OVBTLwSH8hWRU9"}, {"max": 31, "min": 71, "name": "bItGQ7VUWBhGolwa"}], [{"max": 11, "min": 36, "name": "IfbF1GLFnrQ4T5cm"}, {"max": 45, "min": 8, "name": "7U1TxiS06UEoaDZp"}, {"max": 83, "min": 29, "name": "WzpXOi2cpajtqcXj"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 97, "role_flexing_second": 19}, "duration": 60, "max_number": 13, "min_number": 71, "player_max_number": 53, "player_min_number": 44}, {"combination": {"alliances": [[{"max": 96, "min": 78, "name": "kGCEt7h1mVwIQCJm"}, {"max": 87, "min": 19, "name": "kvWbQrn2W0VkOF0p"}, {"max": 87, "min": 83, "name": "YDnaXB0JOS4XKVT6"}], [{"max": 4, "min": 37, "name": "ONCaOyATBFgqLeAz"}, {"max": 43, "min": 85, "name": "dcUEhWRo6ROvbuPQ"}, {"max": 45, "min": 43, "name": "l9dVfJQGkDR00ofX"}], [{"max": 37, "min": 17, "name": "bnEzHiRs0NmGhxv1"}, {"max": 45, "min": 27, "name": "uN7Xv6OuG6RR1jPh"}, {"max": 59, "min": 90, "name": "G6EAl7d3Ks65thtn"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 87, "role_flexing_second": 79}, "duration": 22, "max_number": 91, "min_number": 55, "player_max_number": 46, "player_min_number": 23}], "name": "1J42fthKUobas2CA"}, "lSxxVhDR9hlaznet": {"alliance": {"combination": {"alliances": [[{"max": 55, "min": 96, "name": "1HuYKsCBBgwb1hGj"}, {"max": 69, "min": 74, "name": "ckC9cdzaLnajQ8Gn"}, {"max": 73, "min": 8, "name": "pALiddv9UUtG1tEE"}], [{"max": 59, "min": 91, "name": "sm8xaDOz0tMlpFuJ"}, {"max": 98, "min": 8, "name": "Xo9s0JPG8cgjHQo9"}, {"max": 68, "min": 57, "name": "oLLyUnPTiCD0038o"}], [{"max": 35, "min": 80, "name": "8wR0tuwIJnrSI2IF"}, {"max": 5, "min": 100, "name": "RwSoMTuJziuDNbOy"}, {"max": 7, "min": 11, "name": "iu3lOaruuYw0iUut"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 62, "role_flexing_second": 3}, "max_number": 95, "min_number": 58, "player_max_number": 44, "player_min_number": 14}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 30, "min": 79, "name": "BlbH02bobxtljIfH"}, {"max": 56, "min": 8, "name": "gjP9onbxFcxS2OZZ"}, {"max": 11, "min": 44, "name": "O3HkJTOPscPA2n25"}], [{"max": 58, "min": 59, "name": "1zEnAMGmFy7w6eqn"}, {"max": 80, "min": 25, "name": "eKFo7U8Scr9xm68w"}, {"max": 71, "min": 37, "name": "9GqAhhjNIivdIcaE"}], [{"max": 88, "min": 34, "name": "fNETQCBPK1mYwKVQ"}, {"max": 29, "min": 92, "name": "ydbYjXZyBpqhCJBt"}, {"max": 64, "min": 4, "name": "Om3iCpu0lhhgutt3"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 31}, "duration": 42, "max_number": 77, "min_number": 74, "player_max_number": 42, "player_min_number": 85}, {"combination": {"alliances": [[{"max": 44, "min": 37, "name": "OEtKFBjNihHU8GP8"}, {"max": 93, "min": 73, "name": "RVypSvYXKz4BGjbs"}, {"max": 36, "min": 55, "name": "RBV8aztJ86yQK1As"}], [{"max": 58, "min": 84, "name": "18UO6JcXmwQfkseT"}, {"max": 32, "min": 24, "name": "H6l2Dv8SvqYKc56P"}, {"max": 5, "min": 29, "name": "PSL2xmjViKkKw4gH"}], [{"max": 54, "min": 8, "name": "4CaLsPqRsTdKzcKt"}, {"max": 22, "min": 64, "name": "Gcvn44NWse6VLPkM"}, {"max": 96, "min": 97, "name": "5Z9UnQmZqX15hBb4"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 23, "role_flexing_second": 81}, "duration": 100, "max_number": 94, "min_number": 87, "player_max_number": 71, "player_min_number": 79}, {"combination": {"alliances": [[{"max": 57, "min": 60, "name": "qUS8baUqkzSr41y6"}, {"max": 90, "min": 78, "name": "PBHJuPjj8zDwOk0I"}, {"max": 12, "min": 67, "name": "mYfUTpFzyQhPVhRG"}], [{"max": 25, "min": 54, "name": "xlUKhXI8mL8OIhvP"}, {"max": 10, "min": 24, "name": "xE68dzohxhbej2ca"}, {"max": 71, "min": 70, "name": "3b7dmnPijw6U8GGp"}], [{"max": 93, "min": 62, "name": "UEBotSNIwGhia6cq"}, {"max": 30, "min": 51, "name": "Wmnhtuzxir12r0VU"}, {"max": 100, "min": 19, "name": "I0kJAczj5ApcsiEQ"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 24, "role_flexing_second": 31}, "duration": 23, "max_number": 11, "min_number": 14, "player_max_number": 40, "player_min_number": 67}], "name": "qoxujXDosOo2kSUf"}, "IA1guTNx7haejXSV": {"alliance": {"combination": {"alliances": [[{"max": 49, "min": 30, "name": "cL9SyuHbvRxR6LaK"}, {"max": 99, "min": 79, "name": "gAVjZKDxiezEbuMC"}, {"max": 52, "min": 26, "name": "9J4dPRGzoQLYIWPP"}], [{"max": 75, "min": 45, "name": "gU9406tdRDqr3cpV"}, {"max": 2, "min": 92, "name": "aH69NyTfGE59942b"}, {"max": 59, "min": 59, "name": "wgpzUfcmTQjRmV0C"}], [{"max": 84, "min": 39, "name": "uhL6qbAhRExsnbWS"}, {"max": 68, "min": 94, "name": "45LarTmOqto4OtwF"}, {"max": 71, "min": 43, "name": "CtWyUtVDnhgTGXO8"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 32, "role_flexing_second": 39}, "max_number": 46, "min_number": 91, "player_max_number": 48, "player_min_number": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 42, "min": 78, "name": "g8MpqczRvUdK1uOV"}, {"max": 41, "min": 81, "name": "JTYuHpnpVX5u4gw4"}, {"max": 98, "min": 56, "name": "7rVei1o9zV6rhVfc"}], [{"max": 88, "min": 26, "name": "F5X05KUgGKfDSGh3"}, {"max": 44, "min": 57, "name": "QFPSYCi8WEjR3wqp"}, {"max": 27, "min": 26, "name": "MdSNskxhl3O3kGlo"}], [{"max": 29, "min": 29, "name": "oh7kL598P7F3IKhi"}, {"max": 80, "min": 85, "name": "dx1V7199NT7JTRFV"}, {"max": 34, "min": 64, "name": "6l5k9BLQMrPoTuxd"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 63, "role_flexing_second": 62}, "duration": 54, "max_number": 54, "min_number": 64, "player_max_number": 45, "player_min_number": 99}, {"combination": {"alliances": [[{"max": 97, "min": 14, "name": "dW05WnQEAbK416LN"}, {"max": 81, "min": 82, "name": "PYUVA9mU8UvONyjv"}, {"max": 67, "min": 1, "name": "QuLHoQ6ehLLK5h1b"}], [{"max": 62, "min": 87, "name": "9WU6w3tjUhSCKySP"}, {"max": 9, "min": 51, "name": "Xk4uDF5mdakWJ2As"}, {"max": 75, "min": 34, "name": "f8UfQqTQ8v7gXyFu"}], [{"max": 76, "min": 70, "name": "FZViQbxYQvUyapo6"}, {"max": 65, "min": 58, "name": "mMy6tZYSCe7du68C"}, {"max": 9, "min": 91, "name": "6T4pYH3BPyFurT4p"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 40, "role_flexing_second": 30}, "duration": 72, "max_number": 88, "min_number": 29, "player_max_number": 87, "player_min_number": 67}, {"combination": {"alliances": [[{"max": 87, "min": 51, "name": "WKTaUyB0UyrKKulH"}, {"max": 95, "min": 20, "name": "nompTrS7DIOakX65"}, {"max": 45, "min": 25, "name": "RpxY6pd1QTpFpaxb"}], [{"max": 58, "min": 9, "name": "jHSCXM7sL1nnOoRI"}, {"max": 12, "min": 12, "name": "7oSh4yVttp53wasu"}, {"max": 68, "min": 35, "name": "bA0keUomVCh681OM"}], [{"max": 65, "min": 82, "name": "iHwUqL5rITYFhcde"}, {"max": 81, "min": 15, "name": "wLmZenRqEBM0VGzh"}, {"max": 98, "min": 79, "name": "VGdipdi33u9U14rG"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 44, "role_flexing_second": 30}, "duration": 79, "max_number": 44, "min_number": 63, "player_max_number": 71, "player_min_number": 49}], "name": "NegS29legebqGwej"}}, "ticket_flexing_selection": "newest", "ticket_flexing_selections": [{"selection": "oldest", "threshold": 84}, {"selection": "pivot", "threshold": 22}, {"selection": "newest", "threshold": 18}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 50, "social_matchmaking": true, "sub_gamemode_selection": "ticketOrder", "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'FkJicmK6qeaDEm9b' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'PCS2a5WoOtwavdio' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "adjCN0lC0MZRZAvh", "players": [{"results": [{"attribute": "Z7XQmcT57Hl2PvPO", "value": 0.590971910723592}, {"attribute": "vc25nnSLnEnv4ipA", "value": 0.7639607664635877}, {"attribute": "JzPHM6kTwfu1vSD9", "value": 0.10558820650816758}], "user_id": "ROMknwVRJfXHGB1r"}, {"results": [{"attribute": "66lbNcbMIJEY0Bmp", "value": 0.505691718562104}, {"attribute": "215jJycJcSyXLzU9", "value": 0.7553525258250905}, {"attribute": "qk079uhBLl4yz32R", "value": 0.27292681305502886}], "user_id": "kNzYSNYl4zvyD8SU"}, {"results": [{"attribute": "Zv2LFFZer6T3W7TE", "value": 0.9303730939706929}, {"attribute": "WdocKzvgr3jBU2g8", "value": 0.4940059262310944}, {"attribute": "o7uAb4HndxqQYO14", "value": 0.17817531487582372}], "user_id": "FR2YtIb1fufxJiod"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "JFjEbn1ASMAiedHo"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "Yv6WmW9mRXQwc5sf", "client_version": "OZbgnCmULqltV5xj", "deployment": "jrXKhZOekpygvRDC", "error_code": 21, "error_message": "3WdZ6luOW977Egot", "game_mode": "vOrnRjb5UT6Vf5jx", "is_mock": "oBBg2lM3DQXyC3oK", "joinable": true, "match_id": "gC8yVFlwGULKeMzn", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 75, "party_attributes": {"sG6P5R2lHU9mf9rz": {}, "rxuxtxg98cDF1fsD": {}, "5miAxHczgRu4VYjQ": {}}, "party_id": "q4VIVFUqNPuW223z", "party_members": [{"extra_attributes": {"uUv8ShbYBe9hLKcN": {}, "6myFUWf7IuLG63jl": {}, "9rYXaEFcUySnsIRE": {}}, "user_id": "QUlwDt2XB6DgoJm4"}, {"extra_attributes": {"dqrLVSBWToF03dQY": {}, "i0OxI4DZZd2V80fj": {}, "N9CwM4qNT3awIjWo": {}}, "user_id": "FCW5BTW9laFjsd7g"}, {"extra_attributes": {"SFkIVGnXJLeUdD8X": {}, "NxAkoeHk0BXouyKC": {}, "6RnO4PckO3syHJOM": {}}, "user_id": "lgAqtsnZlLvEczKK"}], "ticket_created_at": 53, "ticket_id": "uKPGNN6m8BLNzJxM"}, {"first_ticket_created_at": 89, "party_attributes": {"pXX8vScPhhhoeTbx": {}, "ungca58m1uNcxsQx": {}, "rsxbLSv7uFZXdW5G": {}}, "party_id": "yQ2mveLZEnmSCeWT", "party_members": [{"extra_attributes": {"CXfARUx3U3KrfqoZ": {}, "i5xiHiQI9ieQ8y75": {}, "Biw4pKJ8hey5JmuU": {}}, "user_id": "DlojEc712JEhS1VF"}, {"extra_attributes": {"A1Eo4Rxcnq5DtzSa": {}, "ifByaju2TY0QdHnd": {}, "DWB60eGxKadAf6UL": {}}, "user_id": "9MkkVf8dHJYJF19N"}, {"extra_attributes": {"cUSJgQSBwkX1FU71": {}, "K0CzXzdQIWh5PSp0": {}, "24SIhnu3h3uK1jRH": {}}, "user_id": "hQ2uS27tXHvtxi6E"}], "ticket_created_at": 2, "ticket_id": "rycsu5Q9BFGk7WCN"}, {"first_ticket_created_at": 46, "party_attributes": {"ZXAZkdh450P2HCQE": {}, "ysNYmCndtXXQgiHJ": {}, "gjwpCxGEBsc3HVar": {}}, "party_id": "hLlwlmf1l5JhrQSp", "party_members": [{"extra_attributes": {"GlguvTECefhiKKuc": {}, "8Urg4atANoOfyCbf": {}, "BoH6zLgTsYmAw4mF": {}}, "user_id": "yLcIq00Vl8sxzC1f"}, {"extra_attributes": {"JxroZeNIlbxAUeRU": {}, "jUbaPklfVic7zYJT": {}, "jpmhWVBgTDm8IGJL": {}}, "user_id": "3sEpnq2qNgEjKMem"}, {"extra_attributes": {"oxx1k2s5gW8zADPq": {}, "u8PVXnN0xl48RoZb": {}, "NL7cXCVaF9U1H9bQ": {}}, "user_id": "v7EybPwbHEHxSPaG"}], "ticket_created_at": 59, "ticket_id": "Bitprtx35PWwBW4w"}]}, {"matching_parties": [{"first_ticket_created_at": 77, "party_attributes": {"22Z1SmIc5NTRyLbO": {}, "zAYD5IH4deTFCDOR": {}, "AsuT0lseQtOoohdB": {}}, "party_id": "YhvvwspKpEPUUxc2", "party_members": [{"extra_attributes": {"NKFB2qxCiWMNdvN9": {}, "SDRKye6n1t8RXF5q": {}, "ayS4UAMJrRrnNfXd": {}}, "user_id": "TnJz7e3tD8KVlMU1"}, {"extra_attributes": {"7V03QDQjU64lc3oe": {}, "k3RWXWJhPXvS9Omm": {}, "tZ14XROPpbgqS9a9": {}}, "user_id": "eP72cbSH4TvY6sMC"}, {"extra_attributes": {"kitXsNfi8EF3mgAB": {}, "wFe1N0QNeryssScV": {}, "8w2rN40y7aLOJoeZ": {}}, "user_id": "qRwJzTdMg00KvHLd"}], "ticket_created_at": 79, "ticket_id": "teM0QsfB4cKcpv0n"}, {"first_ticket_created_at": 33, "party_attributes": {"rSMcK8c5xZukais9": {}, "TopwzyVFe9lNT7v5": {}, "QycBCxJG7DehSEc6": {}}, "party_id": "kg2UWX8dfboaqkOS", "party_members": [{"extra_attributes": {"5P8ijeU7ceEjsJO7": {}, "xZUK7lMGDnKhxDxW": {}, "qk0FyDBDBxAznXS1": {}}, "user_id": "mfs6uZ9OaZwm6pPA"}, {"extra_attributes": {"dF5lHMHzBycY7bXy": {}, "RpFUts9CpuTZNXAv": {}, "R5mEjDGi8Z9KuTHu": {}}, "user_id": "T6IlImbAYCRvUBIH"}, {"extra_attributes": {"oIhUnq8EtmzVPJFq": {}, "DDsFmDKPixcJtgNH": {}, "rTEQpFB5aeIMGxoy": {}}, "user_id": "LMqSLDNxuBA95CXk"}], "ticket_created_at": 23, "ticket_id": "K2oLMyvJ6M0zKUQC"}, {"first_ticket_created_at": 76, "party_attributes": {"O7EzD1HwKEgGh6Mc": {}, "tPOqg2vfaFiXbkyx": {}, "YVJYoECX5Zk7zrqR": {}}, "party_id": "FfKg2QLfgPky92H0", "party_members": [{"extra_attributes": {"SjmRKLX0YyNLgOIb": {}, "DguxdqP6c448AniK": {}, "Djnb5cFYyJtzDcKD": {}}, "user_id": "3CR18eggGJVXROWQ"}, {"extra_attributes": {"LNP4J0I2wDjuMHSk": {}, "nrvHsarToh01sSae": {}, "PBAWrnMRr0i4i3zn": {}}, "user_id": "plxZVkkzCuWXN0pi"}, {"extra_attributes": {"9oHwFFSWlYJSaX14": {}, "Onxc82WUAqFNlxPL": {}, "5ZjWvAiWvl12Eydd": {}}, "user_id": "bFelmB60OEQrMIsK"}], "ticket_created_at": 59, "ticket_id": "5iUyPElT7mmAuOT5"}]}, {"matching_parties": [{"first_ticket_created_at": 50, "party_attributes": {"ZoFgoU8geQqTHsge": {}, "sxUdeb2FJbsqzkOO": {}, "5TgVxhorx7Olr6yZ": {}}, "party_id": "sG5AHeXjxQCmc8jD", "party_members": [{"extra_attributes": {"3q7UouREPLDNt6Bi": {}, "4udSrXnIItduiUuy": {}, "8tq9HCTgLSuFiv2W": {}}, "user_id": "3x38AyIWIiWAkZb5"}, {"extra_attributes": {"5PmNf9MzOCP7HO3N": {}, "R5EmbWMmuHbWUeXE": {}, "PRF6TjBh6iQOGSqS": {}}, "user_id": "f29O4OCHr6PHDU3g"}, {"extra_attributes": {"8gwrRCGr34cRXz9J": {}, "sazgdXDoGshLr8yn": {}, "7AoXGMgLGDEgjGR3": {}}, "user_id": "AjETQmuBhxdl2hmy"}], "ticket_created_at": 82, "ticket_id": "SnBtqToPbBDwdvFV"}, {"first_ticket_created_at": 65, "party_attributes": {"aNPadM954Klf9Scy": {}, "Q3BkdgTB8XsRpozx": {}, "yzQjkAwoiKpqCxRa": {}}, "party_id": "xD64vrtLT4cBalVm", "party_members": [{"extra_attributes": {"LrDPUnoL1yIqAGPG": {}, "IMNs07P35ZIntLvl": {}, "9DQDCBJjs12pGhuG": {}}, "user_id": "LD6vHktU3ynqJffm"}, {"extra_attributes": {"ZNfIZBEmg9ppW9kq": {}, "Hg6qWRr5OGM3cUFn": {}, "nf4mVneUyBHCEsHo": {}}, "user_id": "Uz3vp9jpSUMWJyDV"}, {"extra_attributes": {"ldaDNtR0AXW63sbP": {}, "YTKP8EQupMajWTKw": {}, "5FeR8ri3yXrzd1ie": {}}, "user_id": "TRurPzBSUlLhIUZa"}], "ticket_created_at": 33, "ticket_id": "5ZkF7UCeoZEUNVKj"}, {"first_ticket_created_at": 78, "party_attributes": {"8wgnlhP7Pg5lC7Ea": {}, "270WU05apXkWulzf": {}, "NESEwZkxwcIoptsi": {}}, "party_id": "G0JEo50u4dtDARQg", "party_members": [{"extra_attributes": {"hCkujmLLnrNNSLh3": {}, "6UQbPSJQQhceSla9": {}, "ERYYip5g4u0MAPcV": {}}, "user_id": "PH3gZ7BL95xBXZ4Q"}, {"extra_attributes": {"2kZcVEtlghVPGnqt": {}, "FjbFAzllHBMrW7hG": {}, "67ye23P8DW1ccz64": {}}, "user_id": "9aMbZ9u0Okl1IHd8"}, {"extra_attributes": {"Q5JqhDP8ljUtdmP5": {}, "zdR2WzZ26M7190BU": {}, "UMJA2i5Q4vFfXwKG": {}}, "user_id": "lPrvLQjEMxmStiAY"}], "ticket_created_at": 5, "ticket_id": "yA6ZsXJoVWUuZ6fQ"}]}], "namespace": "XMhnC8iRACppkc2G", "party_attributes": {"jnJ6MqokeFNTOal7": {}, "C9QhMyKSxoXxGxkY": {}, "jDcp3pGTMJShikvB": {}}, "party_id": "pSOkSVhuAqkZqR3g", "queued_at": 99, "region": "6vEQ0Fb0fOzSwVrT", "server_name": "e2Pix8IgOyJOxbfi", "status": "uUDdzfJOveiGttir", "ticket_id": "Pw49eDkkTlieINXi", "ticket_ids": ["ZneSGu4x8wWgDhy2", "xaMbK98KZuPAGpzW", "8YEovlYXMD76ZVrj"], "updated_at": "1994-06-28T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "9d1xh7UR0UxrnZ5O"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'MXgRDRM3gg9nVFQu' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 49, "userID": "r10WrTTWC1vHxSVm", "weight": 0.8605837891533039}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'rRLDUorN8n8OKt3e' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'bTMfmV8RpXci3oXt' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'KeXlMfYcKvIDQryh' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"blocked_player_option": "blockedPlayerCanMatchOnDifferentTeam", "deployment": "qhcBHRl1tn7RtEGU", "description": "E0zrKNm1qW2n5ceo", "findMatchTimeoutSeconds": 24, "joinable": false, "max_delay_ms": 36, "region_expansion_range_ms": 91, "region_expansion_rate_ms": 29, "region_latency_initial_range_ms": 16, "region_latency_max_ms": 65, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 39, "min": 1, "name": "LlKiW8dBlSc2bkfx"}, {"max": 24, "min": 55, "name": "tteOU73MUia86OHe"}, {"max": 62, "min": 4, "name": "ezPfPVoLzuailZgh"}], [{"max": 82, "min": 98, "name": "opYOMqbJVfyl0ssL"}, {"max": 14, "min": 80, "name": "TKDtEBnyydnlmrax"}, {"max": 36, "min": 69, "name": "T54dKxRwFRslFsKi"}], [{"max": 100, "min": 29, "name": "UOwEpVOojiniOJfB"}, {"max": 25, "min": 1, "name": "QBpvpDw5KbvwvhRu"}, {"max": 36, "min": 76, "name": "Z9kQ6CfVEKuBGQj6"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 82, "role_flexing_second": 59}, "maxNumber": 82, "minNumber": 72, "playerMaxNumber": 50, "playerMinNumber": 32}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 29, "min": 9, "name": "w7ACgmrezLCJKLPr"}, {"max": 45, "min": 85, "name": "jeYeJi9q4KUgzZZ6"}, {"max": 52, "min": 43, "name": "aaAvvKi9jeErSpDV"}], [{"max": 80, "min": 67, "name": "5kjfYLmyJHWVmJhv"}, {"max": 51, "min": 10, "name": "YUD7tt15VYMNdywy"}, {"max": 92, "min": 74, "name": "dXRVEBpthoAfzvXP"}], [{"max": 99, "min": 15, "name": "4t5eLuFOuGciip6l"}, {"max": 15, "min": 77, "name": "OAT59629Ly5GJfaR"}, {"max": 23, "min": 87, "name": "ZeRpPnJNyrwdMhlz"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 85, "role_flexing_second": 84}, "duration": 33, "max_number": 81, "min_number": 68, "player_max_number": 77, "player_min_number": 64}, {"combination": {"alliances": [[{"max": 36, "min": 51, "name": "CKgoc8qlZTdK2Txy"}, {"max": 99, "min": 68, "name": "2a98isrEnWec7Cnv"}, {"max": 35, "min": 71, "name": "RTjVFQkVvDYodu7i"}], [{"max": 85, "min": 86, "name": "q7Dzyrwyqgey4TDs"}, {"max": 94, "min": 52, "name": "GVcn6u2Y8kRSlfFV"}, {"max": 81, "min": 71, "name": "tTCFUDbhXFUMPgIs"}], [{"max": 64, "min": 64, "name": "2FaJmavnpwvlN5bx"}, {"max": 3, "min": 9, "name": "3zVGiVgmTiYRqChq"}, {"max": 24, "min": 66, "name": "n1JMpCmLAckoGMrf"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 42, "role_flexing_second": 15}, "duration": 88, "max_number": 70, "min_number": 91, "player_max_number": 17, "player_min_number": 100}, {"combination": {"alliances": [[{"max": 6, "min": 37, "name": "Q728o1qclvhlm929"}, {"max": 53, "min": 34, "name": "MAdlyXyqtmIwkhB1"}, {"max": 28, "min": 97, "name": "iuOHHkEMM2LdYulO"}], [{"max": 30, "min": 16, "name": "ouVLyY5l3zat0Sbu"}, {"max": 57, "min": 57, "name": "1wMD51VeGbfpAAYy"}, {"max": 57, "min": 30, "name": "bEy0fEmRKPynE1Ul"}], [{"max": 39, "min": 91, "name": "h6WUsfyOIdVfGOJI"}, {"max": 86, "min": 28, "name": "b5iLNRM7JFauJ3tV"}, {"max": 37, "min": 8, "name": "k2xmrmuw7Xo6c48B"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 0, "role_flexing_second": 27}, "duration": 5, "max_number": 32, "min_number": 44, "player_max_number": 65, "player_min_number": 42}], "batch_size": 35, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 84, "flex_flat_step_range": 81, "flex_immunity_count": 15, "flex_range_max": 4, "flex_rate_ms": 75, "flex_step_max": 31, "force_authority_match": true, "initial_step_range": 41, "mmr_max": 21, "mmr_mean": 90, "mmr_min": 24, "mmr_std_dev": 59, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "r3CbX1jCvt8SZQVA", "criteria": "QVTEjLxRXXw1Ba3B", "duration": 59, "reference": 0.6344895779864781}, {"attribute": "Jx3VND1GqpkJeCMY", "criteria": "VGaGlXMirtY3mMsw", "duration": 73, "reference": 0.7867161163516181}, {"attribute": "iKFqOEuv5vimn63C", "criteria": "asxqy2jZLzE1twca", "duration": 72, "reference": 0.6670227850329178}], "match_options": {"options": [{"name": "aRfkXyLS86H3ub7h", "type": "u9Mf6Qeyu5D0XT5f"}, {"name": "harkK0AIGdEbxsUw", "type": "JLzvxAqxaBvYkRH7"}, {"name": "23c57BNNjQJ7TXsO", "type": "wwby9OOnuphq96Ov"}]}, "matchingRules": [{"attribute": "Bp28vxdZ0sUS14l5", "criteria": "6FKfjkcB2SiFscU2", "reference": 0.7307852437802398}, {"attribute": "IptCl7Mr5hH9Gexc", "criteria": "dbT8v3UhVtgg8kRa", "reference": 0.43360657629880905}, {"attribute": "VvE6mqqeoTT0uNoV", "criteria": "Vn7ItFFSEoUy7Dgm", "reference": 0.7713167186184083}], "sort_ticket": {"search_result": "largestPartySize", "ticket_queue": "none"}, "sort_tickets": [{"search_result": "oldestTicketAge", "threshold": 59, "ticket_queue": "none"}, {"search_result": "largestPartySize", "threshold": 18, "ticket_queue": "random"}, {"search_result": "distance", "threshold": 58, "ticket_queue": "largestPartySize"}], "sub_game_modes": {}, "ticket_flexing_selection": "newest", "ticket_flexing_selections": [{"selection": "newest", "threshold": 8}, {"selection": "random", "threshold": 88}, {"selection": "pivot", "threshold": 60}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 66, "socialMatchmaking": true, "sub_gamemode_selection": "random", "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'WJddDrhoAaGO0c6a' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'XoFM9JtzYynQYA8i' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName '8PGEVFtDMMDML1yS' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 76}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'ZStYmu7rsmI2iz8i' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'DqES2enp5QsuU2Sz' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "C5jPZ753VQLK9K4e", "count": 0, "mmrMax": 0.36926839166145886, "mmrMean": 0.930334516751295, "mmrMin": 0.26519819253474286, "mmrStdDev": 0.04588032584498869}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName '4U4ZoFCFoWEdyIcg' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 99, "party_attributes": {"1phglYoAkb9a7zwi": {}, "pvdA2x113f0Bp2vd": {}, "sCew5mf0wUYRGs6n": {}}, "party_id": "dQOUixZzcm2OM0B7", "party_members": [{"extra_attributes": {"COBhqguJYsAONDGw": {}, "AOmzWmrbHeYwhgN0": {}, "OnEE5a4pDdwi6k56": {}}, "user_id": "EtzesGM5rBXwL4B1"}, {"extra_attributes": {"VjVn6f8aba9YXwFY": {}, "QFr3UBeKJ4xecZaf": {}, "7owlXFBz6IbxIl5d": {}}, "user_id": "UFT7bJ07WKDAyNRU"}, {"extra_attributes": {"JsM9g7YDVCdVk7pA": {}, "hlHOFFTGckEVLOkt": {}, "rETc91ydu5RGfuFA": {}}, "user_id": "mP1wOzzLGRwbOmou"}], "ticket_created_at": 20, "ticket_id": "2YIPoumSJ3SzT8lU"}, {"first_ticket_created_at": 31, "party_attributes": {"sQ3DlrWTmYVuz6sh": {}, "ya81WnWLIEMQX6yI": {}, "uvLV2SAA8KoDH2te": {}}, "party_id": "6X3S3HwJUMVxEYAq", "party_members": [{"extra_attributes": {"oGebWDx1rIY7YgqL": {}, "azmwaTdH4Cz8G7R8": {}, "H7IL8v5O1r7P5inU": {}}, "user_id": "TEQGSKH2wQE3rMpB"}, {"extra_attributes": {"R96V4wCGhThbt8E3": {}, "jI5UoWvqFZQoL3OU": {}, "kQDJft6r5a3gptbN": {}}, "user_id": "LX0aELOa6N75cogV"}, {"extra_attributes": {"kZy2V8uOMXE5zaiq": {}, "fUuDbogZiwydwzfW": {}, "PCVvLLFNSKl79V2u": {}}, "user_id": "cJ4eDQyH46uQbTHK"}], "ticket_created_at": 30, "ticket_id": "fesSBanCCZXDbHie"}, {"first_ticket_created_at": 26, "party_attributes": {"EtVr2SVT1NiSinLA": {}, "NULfgmYSJIzEBkXm": {}, "c2FhrwrUKt0S1mnK": {}}, "party_id": "CBDLO5p7AU8haiJA", "party_members": [{"extra_attributes": {"yCejYVpU1pdEtrpK": {}, "rbVk9u7GLgME7wGi": {}, "U2biCXBTngfX2J8Y": {}}, "user_id": "qvfwThZ7F6KgWP0p"}, {"extra_attributes": {"CW1LZjascU9sDwKv": {}, "owvGWWtzd8NYVjEQ": {}, "MiQNEKqmY3Qc7Gus": {}}, "user_id": "h1JYbd03QSrNZ2Sb"}, {"extra_attributes": {"LcxoEq2iYdEtbYSF": {}, "J0DhVUMO4DrPdmXH": {}, "PzNfJH1o81DNVWft": {}}, "user_id": "g4eXbI1TK5tf2OW6"}], "ticket_created_at": 83, "ticket_id": "wDG76qXHaJMuVALb"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName '1k6C0bGXPhuWzOj8' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 36}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName 'c5COgUPHziOjddY1' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName '2BhBK4v8j8mNkaLC' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'RNg4dQYhCxg6MO5y' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["ZpDV5MsRNMVQEyyQ", "U7JYXJt8RD2u7w8O", "NAaO8ej985DejuzY"], "party_id": "3p3EElTLLLbt1V32", "user_id": "zLajqSkaSCdxoJQJ"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName '6MzJyO3qDmtY3fCW' \
    --matchID 'cnjvSFQknkXxhNoW' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName '5mCsWgJYsuRmy56H' \
    --matchID 'ZgI5RRTsXQnMWiRJ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'CR1RHyZbcfk8YG7n' \
    --matchID 'YGowF23P0WHgh0pC' \
    --namespace $AB_NAMESPACE \
    --userID 'hv4BAqsdhbbnkYPp' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName '9i7jjBIxJ14Hmr0A' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'psK8SHyhula1Q38F' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE