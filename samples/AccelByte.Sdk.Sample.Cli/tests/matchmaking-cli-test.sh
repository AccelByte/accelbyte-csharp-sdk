#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '5' \
    --offset '71' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "iGyH6KAu", "description": "RSUNcfg0", "find_match_timeout_seconds": 41, "game_mode": "A91vIG1L", "joinable": false, "max_delay_ms": 74, "rule_set": {"alliance": {"combination": {"alliances": [{"max": 82, "min": 65, "name": "BIGbIjAk"}, {"max": 48, "min": 50, "name": "301GpAiG"}, {"max": 76, "min": 0, "name": "xo4aNB86"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 38, "role_flexing_second": 97}, "max_number": 18, "min_number": 94, "player_max_number": 57, "player_min_number": 64}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 89, "min": 1, "name": "OuS9j2Bm"}, {"max": 26, "min": 11, "name": "td05krjf"}, {"max": 6, "min": 58, "name": "J8BIaRqO"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 86, "role_flexing_second": 53}, "duration": 25, "max_number": 63, "min_number": 92, "player_max_number": 27, "player_min_number": 49}, {"combination": {"alliances": [{"max": 78, "min": 10, "name": "ziTeZHHD"}, {"max": 85, "min": 22, "name": "DdljFPvy"}, {"max": 23, "min": 35, "name": "Oqj1XNfI"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 84}, "duration": 23, "max_number": 38, "min_number": 64, "player_max_number": 84, "player_min_number": 77}, {"combination": {"alliances": [{"max": 52, "min": 5, "name": "7C74dXc8"}, {"max": 80, "min": 50, "name": "UkaMuyQJ"}, {"max": 83, "min": 68, "name": "O0nMOJgl"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 13, "role_flexing_second": 24}, "duration": 81, "max_number": 64, "min_number": 2, "player_max_number": 89, "player_min_number": 42}], "flexing_rule": [{"attribute": "HcaymmIc", "criteria": "JJlij3Tf", "duration": 66, "reference": 0.3307145670993614}, {"attribute": "cKxGspOD", "criteria": "gi4aDkMd", "duration": 26, "reference": 0.4127751702938224}, {"attribute": "V8qyFwi6", "criteria": "ud3ity3S", "duration": 47, "reference": 0.19051988230016137}], "match_options": {"options": [{"name": "zKyIFhTE", "type": "1RJJLSRL"}, {"name": "8wkkyQmS", "type": "tQP01Yk4"}, {"name": "PZtK7Bge", "type": "y9cg98sG"}]}, "matching_rule": [{"attribute": "Zwajun96", "criteria": "AfnjwhZA", "reference": 0.08568658598682666}, {"attribute": "CUF3srSu", "criteria": "5ovKsBKk", "reference": 0.8193445432244266}, {"attribute": "63ZI2ZRm", "criteria": "t6OrowpA", "reference": 0.23116505076613458}], "sub_game_modes": {"qcz1rbOe": {"alliance": {"combination": {"alliances": [{"max": 53, "min": 23, "name": "eFnd5k3B"}, {"max": 62, "min": 87, "name": "PmMW09Yj"}, {"max": 61, "min": 46, "name": "H0keC1S2"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 9, "role_flexing_second": 60}, "max_number": 11, "min_number": 7, "player_max_number": 100, "player_min_number": 11}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 79, "min": 36, "name": "vGs3HUa5"}, {"max": 17, "min": 32, "name": "aMSggart"}, {"max": 2, "min": 88, "name": "zqddbhWD"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 51, "role_flexing_second": 88}, "duration": 0, "max_number": 93, "min_number": 36, "player_max_number": 64, "player_min_number": 96}, {"combination": {"alliances": [{"max": 58, "min": 97, "name": "0VXNrOzP"}, {"max": 93, "min": 78, "name": "YaIw7JiZ"}, {"max": 96, "min": 23, "name": "jOVQqw1B"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 29, "role_flexing_second": 31}, "duration": 61, "max_number": 73, "min_number": 22, "player_max_number": 43, "player_min_number": 98}, {"combination": {"alliances": [{"max": 29, "min": 81, "name": "fQCXrvwH"}, {"max": 39, "min": 65, "name": "JFSJm3MD"}, {"max": 99, "min": 52, "name": "hq6t1xSb"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 64, "role_flexing_second": 29}, "duration": 22, "max_number": 33, "min_number": 43, "player_max_number": 96, "player_min_number": 71}], "name": "8HTp6MKn"}, "rRd8TuLq": {"alliance": {"combination": {"alliances": [{"max": 24, "min": 91, "name": "mRYIhaWj"}, {"max": 47, "min": 2, "name": "dJBIAZga"}, {"max": 39, "min": 57, "name": "7lO3jcrF"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 90, "role_flexing_second": 48}, "max_number": 29, "min_number": 22, "player_max_number": 47, "player_min_number": 55}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 61, "min": 31, "name": "GcGSFM64"}, {"max": 7, "min": 78, "name": "tb1dIJfz"}, {"max": 14, "min": 17, "name": "7UgnLf9O"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 64, "role_flexing_second": 88}, "duration": 70, "max_number": 30, "min_number": 35, "player_max_number": 80, "player_min_number": 62}, {"combination": {"alliances": [{"max": 87, "min": 7, "name": "bGzK2ogM"}, {"max": 13, "min": 39, "name": "VNmHg7Ya"}, {"max": 22, "min": 52, "name": "j568ANrP"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 42, "role_flexing_second": 75}, "duration": 15, "max_number": 5, "min_number": 63, "player_max_number": 33, "player_min_number": 27}, {"combination": {"alliances": [{"max": 19, "min": 66, "name": "aUTgNqiN"}, {"max": 52, "min": 39, "name": "ysaWPHXx"}, {"max": 99, "min": 7, "name": "rz8XDREb"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 78, "role_flexing_second": 49}, "duration": 3, "max_number": 63, "min_number": 96, "player_max_number": 37, "player_min_number": 30}], "name": "41hbun7s"}, "HXiXWYkL": {"alliance": {"combination": {"alliances": [{"max": 26, "min": 10, "name": "jAGNHfNN"}, {"max": 72, "min": 68, "name": "Oq9DFx4Z"}, {"max": 61, "min": 83, "name": "abMtyTwq"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 41, "role_flexing_second": 60}, "max_number": 0, "min_number": 54, "player_max_number": 12, "player_min_number": 52}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 86, "min": 65, "name": "DH7ZA0gI"}, {"max": 0, "min": 70, "name": "Nq92QfzJ"}, {"max": 55, "min": 87, "name": "DCA0Vjnd"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 37, "role_flexing_second": 5}, "duration": 85, "max_number": 26, "min_number": 79, "player_max_number": 60, "player_min_number": 83}, {"combination": {"alliances": [{"max": 92, "min": 55, "name": "aWNfXa9S"}, {"max": 54, "min": 60, "name": "6Lk8w7op"}, {"max": 54, "min": 34, "name": "JfyMbSAm"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 59, "role_flexing_second": 49}, "duration": 52, "max_number": 57, "min_number": 2, "player_max_number": 15, "player_min_number": 31}, {"combination": {"alliances": [{"max": 48, "min": 57, "name": "RiIa8NXX"}, {"max": 21, "min": 70, "name": "Z8gKqObZ"}, {"max": 17, "min": 81, "name": "yZ1VbCB2"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 16, "role_flexing_second": 33}, "duration": 79, "max_number": 36, "min_number": 70, "player_max_number": 33, "player_min_number": 35}], "name": "DwDQ6Q7J"}}}, "session_queue_timeout_seconds": 84, "social_matchmaking": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'EIBJUadG' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'DeleteChannelHandler' test.out

#- 7 StoreMatchResults
# body param: body
echo '{"match_id": "o2cEjlBX", "players": [{"results": [{"attribute": "kww2HGFh", "value": 0.29362384474884273}, {"attribute": "icwQ4O0p", "value": 0.48916786354958297}, {"attribute": "nobdLZDd", "value": 0.7002652545382284}], "user_id": "8FcaJMeS"}, {"results": [{"attribute": "8tKQ9NUx", "value": 0.22789039714912784}, {"attribute": "eCvAXP6L", "value": 0.7344778090259322}, {"attribute": "qcSmGeAW", "value": 0.681837498469884}], "user_id": "K1opkdO2"}, {"results": [{"attribute": "vUPckkgJ", "value": 0.19471383615457816}, {"attribute": "2McgCcCB", "value": 0.8410628308035769}, {"attribute": "AbLhanaF", "value": 0.7952114479787126}], "user_id": "EpbgrkdM"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'StoreMatchResults' test.out

#- 8 Rebalance
# body param: body
echo '{"match_id": "qy77t9OI"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'Rebalance' test.out

#- 9 QueueSessionHandler
# body param: body
echo '{"channel": "D6DFi3np", "client_version": "4hvZLP7H", "deployment": "NXb4sRo7", "game_mode": "HckpXcr9", "joinable": false, "match_id": "9BfWqDi3", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 90, "party_attributes": {"6aVgt4RE": {}, "bR7foqdK": {}, "1l5tcdgh": {}}, "party_id": "LVKr9wgh", "party_members": [{"extra_attributes": {"HGyU1Ki2": {}, "EHN8JSJn": {}, "Fqar7NBG": {}}, "user_id": "4WF22hBl"}, {"extra_attributes": {"EYXjQ4HO": {}, "nj4LLbKW": {}, "ZuOoI9zD": {}}, "user_id": "EKRjQ0WA"}, {"extra_attributes": {"i9dr8pgp": {}, "jwn4bckK": {}, "6EhjQpW1": {}}, "user_id": "BdAEv4f2"}], "ticket_id": "jjQsbfny"}, {"first_ticket_created_at": 94, "party_attributes": {"mOjT3zrr": {}, "hv67T21F": {}, "kLRA86TH": {}}, "party_id": "WmV0q0F9", "party_members": [{"extra_attributes": {"InfdVzTL": {}, "1tTaW2m4": {}, "2m33OlCo": {}}, "user_id": "2ngfE6E5"}, {"extra_attributes": {"wQoXsJ1B": {}, "ngasDBoh": {}, "5SMkYX2s": {}}, "user_id": "s5iNQuZD"}, {"extra_attributes": {"WXlkIkso": {}, "xTIfL58j": {}, "E82WNYaI": {}}, "user_id": "YOcJFovy"}], "ticket_id": "U24eKhEJ"}, {"first_ticket_created_at": 57, "party_attributes": {"LRMs9rIZ": {}, "LBcQGbCH": {}, "j1kfa3Us": {}}, "party_id": "gd5Gegqe", "party_members": [{"extra_attributes": {"vqawNg5T": {}, "2fI2a0mA": {}, "zcL8A8j6": {}}, "user_id": "38dtXAqX"}, {"extra_attributes": {"uAn3fQMX": {}, "EEK9zUaQ": {}, "8M6QQbXr": {}}, "user_id": "pSAJj8kP"}, {"extra_attributes": {"VKDttsE1": {}, "Dwx3Q63A": {}, "dRdylFq4": {}}, "user_id": "OJjDhpFy"}], "ticket_id": "KBCRVEe3"}]}, {"matching_parties": [{"first_ticket_created_at": 36, "party_attributes": {"mBDZyzhw": {}, "27GRdEHF": {}, "OP3mPCi0": {}}, "party_id": "wFENwkoU", "party_members": [{"extra_attributes": {"dO3t4AU6": {}, "ZuoXG5nB": {}, "vSqWFVnG": {}}, "user_id": "YsmPlegi"}, {"extra_attributes": {"Jmwc6CPK": {}, "CUZxljZB": {}, "0Tmccj7z": {}}, "user_id": "1Xu84MAJ"}, {"extra_attributes": {"0FwheJgx": {}, "BNmsKHmD": {}, "w47M0OJO": {}}, "user_id": "53dQ3QOo"}], "ticket_id": "s7XcrB4G"}, {"first_ticket_created_at": 87, "party_attributes": {"YmAvwlOx": {}, "b9J4IzBs": {}, "ec4Slf4y": {}}, "party_id": "kiBsBbGw", "party_members": [{"extra_attributes": {"Maz0n3bG": {}, "mWUhcr9S": {}, "5emk5zn0": {}}, "user_id": "JKZGRERY"}, {"extra_attributes": {"pYUYLVj9": {}, "9lA7927V": {}, "KhRVIixO": {}}, "user_id": "lFfvZbsy"}, {"extra_attributes": {"nr948XkT": {}, "4FhHb0ud": {}, "v0sDeFID": {}}, "user_id": "Xy6YdMdh"}], "ticket_id": "HNINd7W3"}, {"first_ticket_created_at": 38, "party_attributes": {"mIB2sdDH": {}, "JnD5tMc3": {}, "NOI4iSYa": {}}, "party_id": "v0yq6Xcn", "party_members": [{"extra_attributes": {"Ey9ljDYS": {}, "Fn93iUd3": {}, "MwzbI10m": {}}, "user_id": "iz6w35MM"}, {"extra_attributes": {"yqNaY5eb": {}, "tVwD8ebu": {}, "7Gs4hton": {}}, "user_id": "pmXkf00m"}, {"extra_attributes": {"twNesA6s": {}, "68OAKNjy": {}, "Wg19xQP9": {}}, "user_id": "592rQOgC"}], "ticket_id": "D6wwfGlC"}]}, {"matching_parties": [{"first_ticket_created_at": 42, "party_attributes": {"mDDi1rdz": {}, "egOmteQG": {}, "4AjcsJmf": {}}, "party_id": "7nHbKuqA", "party_members": [{"extra_attributes": {"0JbCMVYk": {}, "QMVdVQ3G": {}, "G3Q6x4iF": {}}, "user_id": "AqjBxz9R"}, {"extra_attributes": {"jydCJEmF": {}, "udxhCknk": {}, "i3438do3": {}}, "user_id": "vXTnO5kk"}, {"extra_attributes": {"rdc1NgXO": {}, "FXoxOm6T": {}, "5KYxjKuy": {}}, "user_id": "DuQt63Go"}], "ticket_id": "wO2ZqpaM"}, {"first_ticket_created_at": 27, "party_attributes": {"Q2VVnaEN": {}, "8EsPd64J": {}, "nTJJ2Tz7": {}}, "party_id": "6wQPLq2t", "party_members": [{"extra_attributes": {"7xxUHLvZ": {}, "CGbVZ931": {}, "uEfRI4i1": {}}, "user_id": "M8VrqCYs"}, {"extra_attributes": {"oCoMzjsz": {}, "vOblh7g4": {}, "wiPalBFm": {}}, "user_id": "JvMz8l0r"}, {"extra_attributes": {"fTtXKaF9": {}, "ruZPjxRQ": {}, "4objDvz1": {}}, "user_id": "zQ8QSx8J"}], "ticket_id": "dRTtyl0i"}, {"first_ticket_created_at": 60, "party_attributes": {"DjjYavov": {}, "UPO70jHR": {}, "1MCyMZBC": {}}, "party_id": "V6ZPbbQv", "party_members": [{"extra_attributes": {"HqGSbpVI": {}, "cIf1coJ4": {}, "rcyDlmRt": {}}, "user_id": "8nIKdTgP"}, {"extra_attributes": {"xSH2V8uI": {}, "H4BIjpw4": {}, "KRMXXipg": {}}, "user_id": "SzQlogtk"}, {"extra_attributes": {"x9zhK43o": {}, "saFEW9jt": {}, "NYmLG6kT": {}}, "user_id": "rJxfVh4w"}], "ticket_id": "VYo96j1Y"}]}], "namespace": "bn2jSDZI", "party_attributes": {"7Lt3vCQW": {}, "7QdJhYzk": {}, "vftdfhbP": {}}, "party_id": "tsxgQQge", "queued_at": 84, "region": "rvnyA8fZ", "server_name": "m4bhWw5c", "status": "JmTSFtWv", "ticket_id": "Sl8UeFUX", "updated_at": "1991-08-09T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'QueueSessionHandler' test.out

#- 10 DequeueSessionHandler
# body param: body
echo '{"match_id": "Ju6KiPyd"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'DequeueSessionHandler' test.out

#- 11 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'ktPVot8y' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'QuerySessionHandler' test.out

#- 12 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 27, "userID": "gJgBclXq", "weight": 0.3448285187782719}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 12 'UpdatePlayTimeWeight' test.out

#- 13 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'GetAllPartyInAllChannel' test.out

#- 14 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'uBDrq5Gf' \
    > test.out 2>&1
eval_tap $? 14 'BulkGetSessions' test.out

#- 15 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'ExportChannels' test.out

#- 16 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'Ej8pAlY4' \
    > test.out 2>&1
eval_tap $? 16 'ImportChannels' test.out

#- 17 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'LrB3MaUd' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'GetSingleMatchmakingChannel' test.out

#- 18 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "zMehJXYI", "description": "I7kyqEpm", "findMatchTimeoutSeconds": 61, "joinable": false, "max_delay_ms": 91, "ruleSet": {"alliance": {"combination": {"alliances": [{"max": 38, "min": 14, "name": "tF0YoKm6"}, {"max": 70, "min": 36, "name": "qNkLVFMr"}, {"max": 76, "min": 36, "name": "mDBbzyGQ"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 23, "role_flexing_second": 34}, "maxNumber": 73, "minNumber": 29, "playerMaxNumber": 37, "playerMinNumber": 1}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 99, "min": 23, "name": "24ZLOAys"}, {"max": 5, "min": 23, "name": "VTQBHwLz"}, {"max": 80, "min": 12, "name": "NK2BaTq3"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 17, "role_flexing_second": 32}, "duration": 68, "max_number": 4, "min_number": 72, "player_max_number": 79, "player_min_number": 46}, {"combination": {"alliances": [{"max": 5, "min": 46, "name": "sNGXFqxz"}, {"max": 41, "min": 13, "name": "7mMAk1zw"}, {"max": 42, "min": 72, "name": "8NCCGK3J"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 75, "role_flexing_second": 24}, "duration": 75, "max_number": 21, "min_number": 18, "player_max_number": 79, "player_min_number": 77}, {"combination": {"alliances": [{"max": 49, "min": 10, "name": "zwF6l6qQ"}, {"max": 19, "min": 46, "name": "SPqMz9GO"}, {"max": 7, "min": 4, "name": "0N5tXcls"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 0, "role_flexing_second": 41}, "duration": 64, "max_number": 71, "min_number": 5, "player_max_number": 25, "player_min_number": 9}], "flexingRules": [{"attribute": "Jfptb47F", "criteria": "CqIcoMD1", "duration": 48, "reference": 0.06872123916989414}, {"attribute": "UwzIo9C1", "criteria": "SE9iuE1n", "duration": 27, "reference": 0.4194356516705512}, {"attribute": "LJHaYMHB", "criteria": "1mORBoRQ", "duration": 85, "reference": 0.2787427760618225}], "match_options": {"options": [{"name": "mfcx3B3Q", "type": "ZCqZJZzY"}, {"name": "NDIaBYDm", "type": "Id9I8aJT"}, {"name": "3tQdw3y1", "type": "V1ESB0QC"}]}, "matchingRules": [{"attribute": "10YWQfgT", "criteria": "m1AR60bQ", "reference": 0.3887498756350364}, {"attribute": "AQ4aGGwZ", "criteria": "c6MrCLgH", "reference": 0.761952605743861}, {"attribute": "fWWDHVWt", "criteria": "4cHzZTKM", "reference": 0.512161374107406}], "sub_game_modes": {}}, "sessionQueueTimeoutSeconds": 85, "socialMatchmaking": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'DTnnWcac' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'UpdateMatchmakingChannel' test.out

#- 19 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'HhGpN7GS' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'GetAllPartyInChannel' test.out

#- 20 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'ExuWtULg' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'GetAllSessionsInChannel' test.out

#- 21 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["4kiRN5aK", "CjM6wxg6", "h4y0zpl2"], "party_id": "7gYHe9M0", "user_id": "bld1pwtU"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'kcT9jxX2' \
    --matchID 'wK2WnXE6' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AddUserIntoSessionInChannel' test.out

#- 22 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'epqpzMXv' \
    --matchID '76cbChhk' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'DeleteSessionInChannel' test.out

#- 23 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'Tvwqep0o' \
    --matchID 'pN4NrZWr' \
    --namespace $AB_NAMESPACE \
    --userID 'rnLgJzrr' \
    > test.out 2>&1
eval_tap $? 23 'DeleteUserFromSessionInChannel' test.out

#- 24 SearchSessions
eval_tap 0 24 'SearchSessions # SKIP deprecated' test.out

#- 25 GetSessionHistoryDetailed
eval_tap 0 25 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 26 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 26 'PublicGetMessages' test.out

#- 27 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'PublicGetAllMatchmakingChannel' test.out

#- 28 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'u7ZxxfiI' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'PublicGetSingleMatchmakingChannel' test.out

#- 29 SearchSessionsV2
eval_tap 0 29 'SearchSessionsV2 # SKIP deprecated' test.out

#- 30 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 30 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE