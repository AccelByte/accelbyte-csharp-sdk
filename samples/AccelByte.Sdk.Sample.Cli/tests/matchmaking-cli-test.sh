#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..39"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '2' \
    --offset '56' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "i3wMWnoZgIhwb8YY", "description": "MLqpQwkRRHkaiKsm", "find_match_timeout_seconds": 71, "game_mode": "A7nkDeev2Oj060Hn", "joinable": false, "max_delay_ms": 7, "region_expansion_range_ms": 71, "region_expansion_rate_ms": 92, "region_latency_initial_range_ms": 0, "region_latency_max_ms": 3, "rule_set": {"alliance": {"combination": {"alliances": [[{"max": 5, "min": 65, "name": "LxkZs4233oQWoXFe"}, {"max": 34, "min": 75, "name": "euI2oMJ0cgAoGfXe"}, {"max": 32, "min": 6, "name": "E3r5AQUBqS8KtTYZ"}], [{"max": 77, "min": 4, "name": "J58QqcV3IcuNs9MF"}, {"max": 57, "min": 17, "name": "T2KD18yrWorpC65V"}, {"max": 73, "min": 11, "name": "h4q1z1KJmKedBfbW"}], [{"max": 43, "min": 19, "name": "Ka5Ou124TsbQsxYF"}, {"max": 48, "min": 67, "name": "GGHrfQkgXkiA5IZP"}, {"max": 34, "min": 11, "name": "Cqp9vcyt67WAfWXf"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 58, "role_flexing_second": 45}, "max_number": 19, "min_number": 66, "player_max_number": 66, "player_min_number": 56}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 96, "min": 13, "name": "3tz8qIH4uRdNO08H"}, {"max": 82, "min": 46, "name": "6s9p8Y5c9eItJtiN"}, {"max": 26, "min": 47, "name": "Y3y3n2Rim4NBqhuN"}], [{"max": 40, "min": 5, "name": "j8FOvKZjs1tLpERf"}, {"max": 33, "min": 89, "name": "LzPoORBkRmZ0A2zy"}, {"max": 74, "min": 37, "name": "YCdfkfyt09ro5fHd"}], [{"max": 99, "min": 34, "name": "BZTYc5BsdSSVaAzz"}, {"max": 27, "min": 93, "name": "4GbgkKeCaS6qyUCs"}, {"max": 5, "min": 11, "name": "HXs8PlOBlfUOqv7W"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 57, "role_flexing_second": 42}, "duration": 76, "max_number": 33, "min_number": 95, "player_max_number": 5, "player_min_number": 99}, {"combination": {"alliances": [[{"max": 37, "min": 81, "name": "py8KrcQfucSq2X8g"}, {"max": 65, "min": 43, "name": "qU89D356pVsUtNan"}, {"max": 7, "min": 35, "name": "dzgwxYdQc5hEfefd"}], [{"max": 29, "min": 88, "name": "pcEM0JHfof2Hwi7v"}, {"max": 12, "min": 89, "name": "3osbh0fL2h7eJvAS"}, {"max": 3, "min": 100, "name": "foW8bDq5jPqzhN0Y"}], [{"max": 7, "min": 77, "name": "GSrA9LXRwU6WLgpQ"}, {"max": 62, "min": 59, "name": "9nXzhBC0uyMR4Xf2"}, {"max": 28, "min": 37, "name": "fYvNvG8uQ14Ahsxa"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 76, "role_flexing_second": 47}, "duration": 17, "max_number": 50, "min_number": 57, "player_max_number": 46, "player_min_number": 46}, {"combination": {"alliances": [[{"max": 32, "min": 90, "name": "NJornrCQpMJj5igq"}, {"max": 1, "min": 61, "name": "t8xnPoWTdHAkcyAy"}, {"max": 23, "min": 6, "name": "Ji4RbZ0Iy11mfOFj"}], [{"max": 58, "min": 12, "name": "zZVcGomWF1oAqUNF"}, {"max": 61, "min": 4, "name": "tXnXLvOAsW8wYh4g"}, {"max": 34, "min": 60, "name": "7pRVZVLJiDx3au9b"}], [{"max": 64, "min": 88, "name": "zeiMRkcOr1L0TMIc"}, {"max": 52, "min": 3, "name": "jfdUQHa3RxspSqwd"}, {"max": 3, "min": 25, "name": "TR2sgzfaQrUCW9fg"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 45, "role_flexing_second": 85}, "duration": 14, "max_number": 3, "min_number": 58, "player_max_number": 22, "player_min_number": 4}], "batch_size": 64, "bucket_mmr_rule": {"disable_authority": true, "flex_authority_count": 0, "flex_flat_step_range": 61, "flex_immunity_count": 47, "flex_range_max": 25, "flex_rate_ms": 94, "flex_step_max": 2, "force_authority_match": true, "initial_step_range": 28, "mmr_max": 25, "mmr_mean": 96, "mmr_min": 49, "mmr_std_dev": 34, "override_mmr_data": true, "use_bucket_mmr": false, "use_flat_flex_step": true}, "flexing_rule": [{"attribute": "QTpvLH6QPEBP8kSS", "criteria": "FjeuL3wQQPYwmYFb", "duration": 49, "reference": 0.5686017699127481}, {"attribute": "6fs3zL9H4WxGWRH7", "criteria": "fz4BdPhLtHRJOImS", "duration": 34, "reference": 0.9538342051188905}, {"attribute": "DTswnkSyuJTVjKQ1", "criteria": "ORLEIAePvDO2xkVg", "duration": 50, "reference": 0.6089764736884469}], "match_options": {"options": [{"name": "zSpDFY3lxe16KsSR", "type": "zkf2HzBcEio5Uyvu"}, {"name": "Fv5z6wosJGnUyCME", "type": "bHh1uE4DmJ4Suj6D"}, {"name": "jUw36GtZ83Jp2f9f", "type": "1FCoIo3L24DKGwgZ"}]}, "matching_rule": [{"attribute": "85vyFJR8euQBLVu2", "criteria": "7iwplLJdzYS9K0Vv", "reference": 0.3585251564443177}, {"attribute": "E6MAqPc8lGIYWTwx", "criteria": "yqQQIXVmrtRlq1jv", "reference": 0.9413170357931668}, {"attribute": "0HTnmFrl3gYx6Xmv", "criteria": "1DzPHux3k3skhn3m", "reference": 0.7833695949904633}], "rebalance_enable": true, "sort_ticket": {"search_result": "largestPartySize", "ticket_queue": "oldestTicketAge"}, "sort_tickets": [{"search_result": "distance", "threshold": 78, "ticket_queue": "none"}, {"search_result": "distance", "threshold": 89, "ticket_queue": "distance"}, {"search_result": "distance", "threshold": 92, "ticket_queue": "none"}], "sub_game_modes": {"aZw4NqSNylcljuNM": {"alliance": {"combination": {"alliances": [[{"max": 53, "min": 9, "name": "j9mHFpff2vDkz68z"}, {"max": 30, "min": 35, "name": "86un0L98WUoXvfU4"}, {"max": 34, "min": 92, "name": "MIpfgxw2ff5twRYb"}], [{"max": 40, "min": 7, "name": "Rwubq7wtRGdT447O"}, {"max": 0, "min": 2, "name": "1m6VLfjsw270pMmO"}, {"max": 87, "min": 93, "name": "JrpEBbVvBn8Lsf2q"}], [{"max": 92, "min": 30, "name": "AtizV9hzsVbpJLtE"}, {"max": 32, "min": 19, "name": "AAXNzcpbmX3lLFeX"}, {"max": 58, "min": 44, "name": "iaXP8jBjK81t2V9T"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 46, "role_flexing_second": 42}, "max_number": 90, "min_number": 65, "player_max_number": 48, "player_min_number": 5}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 4, "min": 66, "name": "REyU5CwqGJF6nDi3"}, {"max": 16, "min": 70, "name": "RYkbhEM1zTNY3lpi"}, {"max": 28, "min": 31, "name": "cuf5d5saQvKfFRqB"}], [{"max": 0, "min": 25, "name": "VVCc9bpIHEWQMmCk"}, {"max": 71, "min": 28, "name": "qwqpoTVCNrcaVozs"}, {"max": 20, "min": 54, "name": "IXO2EUsAfBvo6Llc"}], [{"max": 1, "min": 23, "name": "j1AJ3hNWWhADRqJv"}, {"max": 0, "min": 75, "name": "rf2qXQFCzRV1paEL"}, {"max": 18, "min": 47, "name": "5dw3LK0gPYhPPG5s"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 71, "role_flexing_second": 38}, "duration": 11, "max_number": 55, "min_number": 98, "player_max_number": 39, "player_min_number": 4}, {"combination": {"alliances": [[{"max": 30, "min": 41, "name": "zA2OntGCwQSHHdPL"}, {"max": 46, "min": 54, "name": "jTngrvb2E1X9ecBB"}, {"max": 15, "min": 90, "name": "RAYjR7c4x5bIk8pV"}], [{"max": 32, "min": 48, "name": "sp2x9mszGGoyhGZA"}, {"max": 52, "min": 98, "name": "t2OVBTLwSH8hWRU9"}, {"max": 31, "min": 71, "name": "bItGQ7VUWBhGolwa"}], [{"max": 11, "min": 36, "name": "IfbF1GLFnrQ4T5cm"}, {"max": 45, "min": 8, "name": "7U1TxiS06UEoaDZp"}, {"max": 83, "min": 29, "name": "WzpXOi2cpajtqcXj"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 97, "role_flexing_second": 19}, "duration": 60, "max_number": 13, "min_number": 71, "player_max_number": 53, "player_min_number": 44}, {"combination": {"alliances": [[{"max": 96, "min": 78, "name": "kGCEt7h1mVwIQCJm"}, {"max": 87, "min": 19, "name": "kvWbQrn2W0VkOF0p"}, {"max": 87, "min": 83, "name": "YDnaXB0JOS4XKVT6"}], [{"max": 4, "min": 37, "name": "ONCaOyATBFgqLeAz"}, {"max": 43, "min": 85, "name": "dcUEhWRo6ROvbuPQ"}, {"max": 45, "min": 43, "name": "l9dVfJQGkDR00ofX"}], [{"max": 37, "min": 17, "name": "bnEzHiRs0NmGhxv1"}, {"max": 45, "min": 27, "name": "uN7Xv6OuG6RR1jPh"}, {"max": 59, "min": 90, "name": "G6EAl7d3Ks65thtn"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 87, "role_flexing_second": 79}, "duration": 22, "max_number": 91, "min_number": 55, "player_max_number": 46, "player_min_number": 23}], "name": "1J42fthKUobas2CA"}, "lSxxVhDR9hlaznet": {"alliance": {"combination": {"alliances": [[{"max": 55, "min": 96, "name": "1HuYKsCBBgwb1hGj"}, {"max": 69, "min": 74, "name": "ckC9cdzaLnajQ8Gn"}, {"max": 73, "min": 8, "name": "pALiddv9UUtG1tEE"}], [{"max": 59, "min": 91, "name": "sm8xaDOz0tMlpFuJ"}, {"max": 98, "min": 8, "name": "Xo9s0JPG8cgjHQo9"}, {"max": 68, "min": 57, "name": "oLLyUnPTiCD0038o"}], [{"max": 35, "min": 80, "name": "8wR0tuwIJnrSI2IF"}, {"max": 5, "min": 100, "name": "RwSoMTuJziuDNbOy"}, {"max": 7, "min": 11, "name": "iu3lOaruuYw0iUut"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 62, "role_flexing_second": 3}, "max_number": 95, "min_number": 58, "player_max_number": 44, "player_min_number": 14}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 30, "min": 79, "name": "BlbH02bobxtljIfH"}, {"max": 56, "min": 8, "name": "gjP9onbxFcxS2OZZ"}, {"max": 11, "min": 44, "name": "O3HkJTOPscPA2n25"}], [{"max": 58, "min": 59, "name": "1zEnAMGmFy7w6eqn"}, {"max": 80, "min": 25, "name": "eKFo7U8Scr9xm68w"}, {"max": 71, "min": 37, "name": "9GqAhhjNIivdIcaE"}], [{"max": 88, "min": 34, "name": "fNETQCBPK1mYwKVQ"}, {"max": 29, "min": 92, "name": "ydbYjXZyBpqhCJBt"}, {"max": 64, "min": 4, "name": "Om3iCpu0lhhgutt3"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 31}, "duration": 42, "max_number": 77, "min_number": 74, "player_max_number": 42, "player_min_number": 85}, {"combination": {"alliances": [[{"max": 44, "min": 37, "name": "OEtKFBjNihHU8GP8"}, {"max": 93, "min": 73, "name": "RVypSvYXKz4BGjbs"}, {"max": 36, "min": 55, "name": "RBV8aztJ86yQK1As"}], [{"max": 58, "min": 84, "name": "18UO6JcXmwQfkseT"}, {"max": 32, "min": 24, "name": "H6l2Dv8SvqYKc56P"}, {"max": 5, "min": 29, "name": "PSL2xmjViKkKw4gH"}], [{"max": 54, "min": 8, "name": "4CaLsPqRsTdKzcKt"}, {"max": 22, "min": 64, "name": "Gcvn44NWse6VLPkM"}, {"max": 96, "min": 97, "name": "5Z9UnQmZqX15hBb4"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 23, "role_flexing_second": 81}, "duration": 100, "max_number": 94, "min_number": 87, "player_max_number": 71, "player_min_number": 79}, {"combination": {"alliances": [[{"max": 57, "min": 60, "name": "qUS8baUqkzSr41y6"}, {"max": 90, "min": 78, "name": "PBHJuPjj8zDwOk0I"}, {"max": 12, "min": 67, "name": "mYfUTpFzyQhPVhRG"}], [{"max": 25, "min": 54, "name": "xlUKhXI8mL8OIhvP"}, {"max": 10, "min": 24, "name": "xE68dzohxhbej2ca"}, {"max": 71, "min": 70, "name": "3b7dmnPijw6U8GGp"}], [{"max": 93, "min": 62, "name": "UEBotSNIwGhia6cq"}, {"max": 30, "min": 51, "name": "Wmnhtuzxir12r0VU"}, {"max": 100, "min": 19, "name": "I0kJAczj5ApcsiEQ"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 24, "role_flexing_second": 31}, "duration": 23, "max_number": 11, "min_number": 14, "player_max_number": 40, "player_min_number": 67}], "name": "qoxujXDosOo2kSUf"}, "IA1guTNx7haejXSV": {"alliance": {"combination": {"alliances": [[{"max": 49, "min": 30, "name": "cL9SyuHbvRxR6LaK"}, {"max": 99, "min": 79, "name": "gAVjZKDxiezEbuMC"}, {"max": 52, "min": 26, "name": "9J4dPRGzoQLYIWPP"}], [{"max": 75, "min": 45, "name": "gU9406tdRDqr3cpV"}, {"max": 2, "min": 92, "name": "aH69NyTfGE59942b"}, {"max": 59, "min": 59, "name": "wgpzUfcmTQjRmV0C"}], [{"max": 84, "min": 39, "name": "uhL6qbAhRExsnbWS"}, {"max": 68, "min": 94, "name": "45LarTmOqto4OtwF"}, {"max": 71, "min": 43, "name": "CtWyUtVDnhgTGXO8"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 32, "role_flexing_second": 39}, "max_number": 46, "min_number": 91, "player_max_number": 48, "player_min_number": 35}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 42, "min": 78, "name": "g8MpqczRvUdK1uOV"}, {"max": 41, "min": 81, "name": "JTYuHpnpVX5u4gw4"}, {"max": 98, "min": 56, "name": "7rVei1o9zV6rhVfc"}], [{"max": 88, "min": 26, "name": "F5X05KUgGKfDSGh3"}, {"max": 44, "min": 57, "name": "QFPSYCi8WEjR3wqp"}, {"max": 27, "min": 26, "name": "MdSNskxhl3O3kGlo"}], [{"max": 29, "min": 29, "name": "oh7kL598P7F3IKhi"}, {"max": 80, "min": 85, "name": "dx1V7199NT7JTRFV"}, {"max": 34, "min": 64, "name": "6l5k9BLQMrPoTuxd"}]], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 63, "role_flexing_second": 62}, "duration": 54, "max_number": 54, "min_number": 64, "player_max_number": 45, "player_min_number": 99}, {"combination": {"alliances": [[{"max": 97, "min": 14, "name": "dW05WnQEAbK416LN"}, {"max": 81, "min": 82, "name": "PYUVA9mU8UvONyjv"}, {"max": 67, "min": 1, "name": "QuLHoQ6ehLLK5h1b"}], [{"max": 62, "min": 87, "name": "9WU6w3tjUhSCKySP"}, {"max": 9, "min": 51, "name": "Xk4uDF5mdakWJ2As"}, {"max": 75, "min": 34, "name": "f8UfQqTQ8v7gXyFu"}], [{"max": 76, "min": 70, "name": "FZViQbxYQvUyapo6"}, {"max": 65, "min": 58, "name": "mMy6tZYSCe7du68C"}, {"max": 9, "min": 91, "name": "6T4pYH3BPyFurT4p"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 40, "role_flexing_second": 30}, "duration": 72, "max_number": 88, "min_number": 29, "player_max_number": 87, "player_min_number": 67}, {"combination": {"alliances": [[{"max": 87, "min": 51, "name": "WKTaUyB0UyrKKulH"}, {"max": 95, "min": 20, "name": "nompTrS7DIOakX65"}, {"max": 45, "min": 25, "name": "RpxY6pd1QTpFpaxb"}], [{"max": 58, "min": 9, "name": "jHSCXM7sL1nnOoRI"}, {"max": 12, "min": 12, "name": "7oSh4yVttp53wasu"}, {"max": 68, "min": 35, "name": "bA0keUomVCh681OM"}], [{"max": 65, "min": 82, "name": "iHwUqL5rITYFhcde"}, {"max": 81, "min": 15, "name": "wLmZenRqEBM0VGzh"}, {"max": 98, "min": 79, "name": "VGdipdi33u9U14rG"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 44, "role_flexing_second": 30}, "duration": 79, "max_number": 44, "min_number": 63, "player_max_number": 71, "player_min_number": 49}], "name": "NegS29legebqGwej"}}, "ticket_flexing_selection": "newest", "ticket_flexing_selections": [{"selection": "oldest", "threshold": 84}, {"selection": "pivot", "threshold": 22}, {"selection": "newest", "threshold": 18}], "use_newest_ticket_for_flexing": true}, "session_queue_timeout_seconds": 50, "social_matchmaking": true, "ticket_observability_enable": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 GetMatchPoolMetric
$CLI_EXE \
    --sn matchmaking \
    --op GetMatchPoolMetric \
    --channelName 'FW93FkJicmK6qeaD' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'GetMatchPoolMetric' test.out

#- 7 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'Em9bPCS2a5WoOtwa' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 7 'DeleteChannelHandler' test.out

#- 8 StoreMatchResults
# body param: body
echo '{"match_id": "vdioadjCN0lC0MZR", "players": [{"results": [{"attribute": "ZAvhZ7XQmcT57Hl2", "value": 0.6768938671866033}, {"attribute": "vPOKvc25nnSLnEnv", "value": 0.9126531842581386}, {"attribute": "ipAVJzPHM6kTwfu1", "value": 0.34615470898757217}], "user_id": "SD9gROMknwVRJfXH"}, {"results": [{"attribute": "GB1r66lbNcbMIJEY", "value": 0.8453417064446449}, {"attribute": "BmpF215jJycJcSyX", "value": 0.6116225859529042}, {"attribute": "zU9Uqk079uhBLl4y", "value": 0.41423600772871105}], "user_id": "32RqkNzYSNYl4zvy"}, {"results": [{"attribute": "D8SUZv2LFFZer6T3", "value": 0.7747873323907889}, {"attribute": "7TE5WdocKzvgr3jB", "value": 0.7475683661278055}, {"attribute": "2g8Eo7uAb4HndxqQ", "value": 0.8140712489855838}], "user_id": "O14lFR2YtIb1fufx"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'StoreMatchResults' test.out

#- 9 Rebalance
# body param: body
echo '{"match_id": "JiodJFjEbn1ASMAi"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'Rebalance' test.out

#- 10 QueueSessionHandler
# body param: body
echo '{"channel": "edHoYv6WmW9mRXQw", "client_version": "c5sfOZbgnCmULqlt", "deployment": "V5xjjrXKhZOekpyg", "error_code": 44, "error_message": "dVFY3WdZ6luOW977", "game_mode": "EgotvOrnRjb5UT6V", "is_mock": "f5jxoBBg2lM3DQXy", "joinable": true, "match_id": "0szNgC8yVFlwGULK", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 8, "party_attributes": {"tsnbKAGRTCvAZKiS": {}, "B7bYvWmbUbWlRZtc": {}, "IUry87yJBlfjPI5t": {}}, "party_id": "fjbyZkYSRLBMgcD5", "party_members": [{"extra_attributes": {"OJgp6wHynVKwWgdA": {}, "ibFBESdI0Ab1zgjM": {}, "C3hp1s4tElQhEA9T": {}}, "user_id": "hpSbyAYJeBCrKDcR"}, {"extra_attributes": {"kI5LI6UqivHoIArv": {}, "DT62TaGFSxd4y808": {}, "Fey8nfaGEw6BAuz1": {}}, "user_id": "YkANj6LHaNMxGL2c"}, {"extra_attributes": {"jWg68JcPwqh2N4ne": {}, "lbmKVyNZY8IVtOez": {}, "nPwNRnztP1VeNj0X": {}}, "user_id": "YtINcOQIiLdvpuYV"}], "ticket_created_at": 84, "ticket_id": "czKKAyiQv93N1fbG"}, {"first_ticket_created_at": 29, "party_attributes": {"zJxMR9F8QPVUh3Fx": {}, "n8VCvtdiiwNMAdIo": {}, "diW3hcYuKSRkkKQK": {}}, "party_id": "IVOduQwwDrBnpQpI", "party_members": [{"extra_attributes": {"Kdlw0Q8Qm0lpTupw": {}, "pI0MCOROWHgnYO9A": {}, "4NtX4m0L4BGxxcKU": {}}, "user_id": "h2wepEjvh8sTPE7J"}, {"extra_attributes": {"fL8ZG7IBiOpvSKRm": {}, "JcE8fHWU8tF9Tj5D": {}, "H9jDJgqZagf9TfKs": {}}, "user_id": "yiaqf0VfidvwpghG"}, {"extra_attributes": {"z92mfgwfewY0DMU8": {}, "QuojVb8QgdEnIEDO": {}, "XPqBEIQJ92jD6Oo7": {}}, "user_id": "qDSKsqbeuvGhaO0u"}], "ticket_created_at": 16, "ticket_id": "xi6EbWHrMrbpZd2b"}, {"first_ticket_created_at": 40, "party_attributes": {"7WCNwFDvIhdx6Z0l": {}, "07ceeKMsQFyZCXx6": {}, "V8vj07WkqficTXXW": {}}, "party_id": "pfaSkgXo8j70KrUc", "party_members": [{"extra_attributes": {"PducAeJonNs4KunU": {}, "YQNVjaoZkB3AI1r9": {}, "iOvxo4sO2v2SBoI1": {}}, "user_id": "cMTFoDvnFjF7PyPS"}, {"extra_attributes": {"ihYagCDowXpzPB56": {}, "b3OlkJK0TMs61QJU": {}, "3NQDgVJljnvyeys0": {}}, "user_id": "Kd9lSy4dXRirNN1X"}, {"extra_attributes": {"TVbZINAYTfmDdnbf": {}, "KLdllLcrgG7MUCvB": {}, "QxDMKfZnQUHzroRI": {}}, "user_id": "LUYE0mbvUdfY0Bqp"}], "ticket_created_at": 64, "ticket_id": "SPaGCQl5y1gekeqH"}]}, {"matching_parties": [{"first_ticket_created_at": 27, "party_attributes": {"BW4wLASmNzxcUMh0": {}, "SvR4rhLLvUwAWnj9": {}, "yPsgbHDuaBMlhmWv": {}}, "party_id": "2CjjBQfnFyRj8oJl", "party_members": [{"extra_attributes": {"SSFh8ZLYsKNsz83B": {}, "3uSAH6QCBczexoUj": {}, "GKIDYp3uk6SY3LbL": {}}, "user_id": "8Ij6Hou1skD80rM9"}, {"extra_attributes": {"MH0bGReYemseR492": {}, "ILQLV79lT8sZwaop": {}, "Srf16qAbt38yZTqf": {}}, "user_id": "Ci5CJgLU0r1txp0v"}, {"extra_attributes": {"dRA0J8eLCZrcT7EO": {}, "7zBX353qlmBOmzDZ": {}, "oLl4yLZgHlatL7nb": {}}, "user_id": "srfkzQM5RtMqCRiY"}], "ticket_created_at": 10, "ticket_id": "vHLdMiaje6w7YN9M"}, {"first_ticket_created_at": 100, "party_attributes": {"pv0nqsAzwhiinZMK": {}, "2PQePnMgPL2upEuz": {}, "GkAuUgSs7KjVR3KE": {}}, "party_id": "lIaqQcqk3EvPPboG", "party_members": [{"extra_attributes": {"cBp08H0whjTC8Q25": {}, "4CIig93OcDTSDDbt": {}, "G4kbF7EcYPAe3TKj": {}}, "user_id": "WJizZ73YhEdqt8LY"}, {"extra_attributes": {"H7I8lYD68ZI9yJ2F": {}, "mHnprty5BQCd5sVL": {}, "r7TlnKnQhYH2PkwS": {}}, "user_id": "PXdYk0YxFNno9WQq"}, {"extra_attributes": {"9ZHHjrwqKsa8Zqhe": {}, "zPIlBtGhWc8fY9Hf": {}, "UsEaPxVM4cVRtjpU": {}}, "user_id": "equcPWZP6mJ5k9QP"}], "ticket_created_at": 96, "ticket_id": "5CXk3K2oLMyvJ6M0"}, {"first_ticket_created_at": 53, "party_attributes": {"S6wONO7EzD1HwKEg": {}, "Gh6MctPOqg2vfaFi": {}, "XbkyxYVJYoECX5Zk": {}}, "party_id": "7zrqRFfKg2QLfgPk", "party_members": [{"extra_attributes": {"y92H0SjmRKLX0YyN": {}, "LgOIbDguxdqP6c44": {}, "8AniKDjnb5cFYyJt": {}}, "user_id": "zDcKD3CR18eggGJV"}, {"extra_attributes": {"XROWQLNP4J0I2wDj": {}, "uMHSknrvHsarToh0": {}, "1sSaePBAWrnMRr0i": {}}, "user_id": "4i3znplxZVkkzCuW"}, {"extra_attributes": {"XN0pi9oHwFFSWlYJ": {}, "SaX14Onxc82WUAqF": {}, "NlxPL5ZjWvAiWvl1": {}}, "user_id": "2EyddbFelmB60OEQ"}], "ticket_created_at": 35, "ticket_id": "aYeee5iUyPElT7mm"}]}, {"matching_parties": [{"first_ticket_created_at": 54, "party_attributes": {"Q9tNv9ZoFgoU8geQ": {}, "qTHsgesxUdeb2FJb": {}, "sqzkOO5TgVxhorx7": {}}, "party_id": "Olr6yZsG5AHeXjxQ", "party_members": [{"extra_attributes": {"Cmc8jD3q7UouREPL": {}, "DNt6Bi4udSrXnIIt": {}, "duiUuy8tq9HCTgLS": {}}, "user_id": "uFiv2W3x38AyIWIi"}, {"extra_attributes": {"WAkZb55PmNf9MzOC": {}, "P7HO3NR5EmbWMmuH": {}, "bWUeXEPRF6TjBh6i": {}}, "user_id": "QOGSqSf29O4OCHr6"}, {"extra_attributes": {"PHDU3g8gwrRCGr34": {}, "cRXz9JsazgdXDoGs": {}, "hLr8yn7AoXGMgLGD": {}}, "user_id": "EgjGR3AjETQmuBhx"}], "ticket_created_at": 6, "ticket_id": "ZoBgzDSnBtqToPbB"}, {"first_ticket_created_at": 61, "party_attributes": {"hfKbveaNPadM954K": {}, "lf9ScyQ3BkdgTB8X": {}, "sRpozxyzQjkAwoiK": {}}, "party_id": "pqCxRaxD64vrtLT4", "party_members": [{"extra_attributes": {"cBalVmLrDPUnoL1y": {}, "IqAGPGIMNs07P35Z": {}, "IntLvl9DQDCBJjs1": {}}, "user_id": "2pGhuGLD6vHktU3y"}, {"extra_attributes": {"nqJffmZNfIZBEmg9": {}, "ppW9kqHg6qWRr5OG": {}, "M3cUFnnf4mVneUyB": {}}, "user_id": "HCEsHoUz3vp9jpSU"}, {"extra_attributes": {"MWJyDVldaDNtR0AX": {}, "W63sbPYTKP8EQupM": {}, "ajWTKw5FeR8ri3yX": {}}, "user_id": "rzd1ieTRurPzBSUl"}], "ticket_created_at": 77, "ticket_id": "8Q4Pe45ZkF7UCeoZ"}, {"first_ticket_created_at": 63, "party_attributes": {"L5Fd1b8wgnlhP7Pg": {}, "5lC7Ea270WU05apX": {}, "kWulzfNESEwZkxwc": {}}, "party_id": "IoptsiG0JEo50u4d", "party_members": [{"extra_attributes": {"tDARQghCkujmLLnr": {}, "NNSLh36UQbPSJQQh": {}, "ceSla9ERYYip5g4u": {}}, "user_id": "0MAPcVPH3gZ7BL95"}, {"extra_attributes": {"xBXZ4Q2kZcVEtlgh": {}, "VPGnqtFjbFAzllHB": {}, "MrW7hG67ye23P8DW": {}}, "user_id": "1ccz649aMbZ9u0Ok"}, {"extra_attributes": {"l1IHd8Q5JqhDP8lj": {}, "UtdmP5zdR2WzZ26M": {}, "7190BUUMJA2i5Q4v": {}}, "user_id": "FfXwKGlPrvLQjEMx"}], "ticket_created_at": 26, "ticket_id": "GLvHi2yA6ZsXJoVW"}]}], "namespace": "UuZ6fQXMhnC8iRAC", "party_attributes": {"ppkc2GjnJ6MqokeF": {}, "NTOal7C9QhMyKSxo": {}, "XxGxkYjDcp3pGTMJ": {}}, "party_id": "ShikvBpSOkSVhuAq", "queued_at": 21, "region": "OUVUdC6vEQ0Fb0fO", "server_name": "zSwVrTe2Pix8IgOy", "status": "JOxbfiuUDdzfJOve", "ticket_id": "iGttirPw49eDkkTl", "ticket_ids": ["ieINXiZneSGu4x8w", "WgDhy2xaMbK98KZu", "PAGpzW8YEovlYXMD"], "updated_at": "1982-05-24T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'QueueSessionHandler' test.out

#- 11 DequeueSessionHandler
# body param: body
echo '{"match_id": "ZVrjTwBhG6PxRbXy"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 11 'DequeueSessionHandler' test.out

#- 12 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'acvJKvH2fI227sFh' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 12 'QuerySessionHandler' test.out

#- 13 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 28, "userID": "EPpERr10WrTTWC1v", "weight": 0.5397294451777399}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 13 'UpdatePlayTimeWeight' test.out

#- 14 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 14 'GetAllPartyInAllChannel' test.out

#- 15 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'xSVm1rRLDUorN8n8' \
    > test.out 2>&1
eval_tap $? 15 'BulkGetSessions' test.out

#- 16 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 16 'ExportChannels' test.out

#- 17 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'OKt3ebTMfmV8RpXc' \
    > test.out 2>&1
eval_tap $? 17 'ImportChannels' test.out

#- 18 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'i3oXtKeXlMfYcKvI' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 18 'GetSingleMatchmakingChannel' test.out

#- 19 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "DQryhqRPwaSbAake", "description": "TI3GtLp33o0hY1hJ", "findMatchTimeoutSeconds": 51, "joinable": false, "max_delay_ms": 20, "region_expansion_range_ms": 28, "region_expansion_rate_ms": 5, "region_latency_initial_range_ms": 28, "region_latency_max_ms": 9, "ruleSet": {"alliance": {"combination": {"alliances": [[{"max": 30, "min": 75, "name": "mro5tLlKiW8dBlSc"}, {"max": 13, "min": 2, "name": "HqJCY44tteOU73MU"}, {"max": 18, "min": 1, "name": "3xKDRbcNco2qPofs"}], [{"max": 15, "min": 0, "name": "Ht88ZrOopYOMqbJV"}, {"max": 11, "min": 85, "name": "yl0ssL0Nn5BZz9qx"}, {"max": 48, "min": 7, "name": "7lz9uMrrT54dKxRw"}], [{"max": 65, "min": 34, "name": "RslFsKiWo4atNdaN"}, {"max": 71, "min": 20, "name": "XOzCVa9CaE9mVJJq"}, {"max": 14, "min": 75, "name": "itULlhI9rKPyF7yt"}]], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 17, "role_flexing_second": 75}, "maxNumber": 60, "minNumber": 42, "playerMaxNumber": 17, "playerMinNumber": 56}, "alliance_flexing_rule": [{"combination": {"alliances": [[{"max": 59, "min": 66, "name": "Ah2lkPXOOJp91w7A"}, {"max": 58, "min": 13, "name": "So92LmNHqeozPTvT"}, {"max": 51, "min": 72, "name": "jHzkSDJwI3p6udT5"}], [{"max": 50, "min": 45, "name": "wNYrZ3noFX2D35kj"}, {"max": 11, "min": 66, "name": "YLmyJHWVmJhvzYUD"}, {"max": 41, "min": 72, "name": "t15VYMNdywySdXRV"}], [{"max": 62, "min": 57, "name": "ngrWr5beUGEW4t5e"}, {"max": 76, "min": 79, "name": "uFOuGciip6lhOAT5"}, {"max": 4, "min": 51, "name": "29Ly5GJfaRlZeRpP"}]], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 81, "role_flexing_second": 61}, "duration": 50, "max_number": 65, "min_number": 36, "player_max_number": 51, "player_min_number": 46}, {"combination": {"alliances": [[{"max": 89, "min": 8, "name": "pEbkRLet6qHFzUAA"}, {"max": 71, "min": 6, "name": "A1yZDTGyGcJrX2a9"}, {"max": 48, "min": 17, "name": "eeueyWn4YodSIhZN"}], [{"max": 38, "min": 64, "name": "nN86SsqD74VrPBla"}, {"max": 85, "min": 50, "name": "Drv6Eb7CbB1CzxJ9"}, {"max": 51, "min": 26, "name": "u2Y8kRSlfFVNtTCF"}], [{"max": 95, "min": 59, "name": "DbhXFUMPgIsF2FaJ"}, {"max": 25, "min": 92, "name": "avnpwvlN5bxb3zVG"}, {"max": 17, "min": 90, "name": "VgmTiYRqChqmGwsz"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 58}, "duration": 35, "max_number": 25, "min_number": 99, "player_max_number": 76, "player_min_number": 22}, {"combination": {"alliances": [[{"max": 54, "min": 5, "name": "mqTkN4IEuQISWdQ7"}, {"max": 87, "min": 2, "name": "o1qclvhlm929zMAd"}, {"max": 24, "min": 99, "name": "yXyqtmIwkhB1niuO"}], [{"max": 68, "min": 62, "name": "HkEMM2LdYulOoouV"}, {"max": 77, "min": 16, "name": "yY5l3zat0SbuB1wM"}, {"max": 60, "min": 46, "name": "51VeGbfpAAYyBbEy"}], [{"max": 48, "min": 10, "name": "wRKEKNIlaq2KS5yU"}, {"max": 91, "min": 38, "name": "265k6o7P49D2nLcC"}, {"max": 80, "min": 81, "name": "vTgskvERPzKX3k2x"}]], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 93, "role_flexing_second": 25}, "duration": 2, "max_number": 42, "min_number": 57, "player_max_number": 45, "player_min_number": 66}], "batch_size": 30, "bucket_mmr_rule": {"disable_authority": false, "flex_authority_count": 5, "flex_flat_step_range": 95, "flex_immunity_count": 56, "flex_range_max": 37, "flex_rate_ms": 5, "flex_step_max": 0, "force_authority_match": false, "initial_step_range": 5, "mmr_max": 32, "mmr_mean": 44, "mmr_min": 65, "mmr_std_dev": 42, "override_mmr_data": true, "use_bucket_mmr": true, "use_flat_flex_step": false}, "flexingRules": [{"attribute": "8c1Kpu4lqYfwmcvv", "criteria": "AUS6PzOOwSik7CwU", "duration": 0, "reference": 0.3802118148886171}, {"attribute": "RXXw1Ba3BCLDK9EH", "criteria": "H019QefK1Zmj8WfG", "duration": 20, "reference": 0.6156133925647396}, {"attribute": "irtY3mMswJSdKiaN", "criteria": "MrgJ4VqWXNo76z7J", "duration": 18, "reference": 0.6350781382903632}], "match_options": {"options": [{"name": "W0IoTP97wPaRfkXy", "type": "LS86H3ub7hu9Mf6Q"}, {"name": "eyu5D0XT5fharkK0", "type": "AIGdEbxsUwJLzvxA"}, {"name": "qxaBvYkRH723c57B", "type": "NNjQJ7TXsOwwby9O"}]}, "matchingRules": [{"attribute": "Onuphq96OvBp28vx", "criteria": "dZ0sUS14l56FKfjk", "reference": 0.034906082388346915}, {"attribute": "B2SiFscU2TIptCl7", "criteria": "Mr5hH9GexcdbT8v3", "reference": 0.7431275144751683}, {"attribute": "hVtgg8kRaAVvE6mq", "criteria": "qeoTT0uNoVVn7ItF", "reference": 0.5047834996436001}], "sort_ticket": {"search_result": "oldestTicketAge", "ticket_queue": "none"}, "sort_tickets": [{"search_result": "largestPartySize", "threshold": 16, "ticket_queue": "oldestTicketAge"}, {"search_result": "none", "threshold": 59, "ticket_queue": "distance"}, {"search_result": "oldestTicketAge", "threshold": 24, "ticket_queue": "oldestTicketAge"}], "sub_game_modes": {}, "ticket_flexing_selection": "oldest", "ticket_flexing_selections": [{"selection": "pivot", "threshold": 60}, {"selection": "random", "threshold": 83}, {"selection": "pivot", "threshold": 31}], "use_newest_ticket_for_flexing": false}, "sessionQueueTimeoutSeconds": 72, "socialMatchmaking": false, "ticket_observability_enable": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'TUUFdOJRHv7are1Q' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 19 'UpdateMatchmakingChannel' test.out

#- 20 CleanAllMocks
$CLI_EXE \
    --sn matchmaking \
    --op CleanAllMocks \
    --channelName 'WJddDrhoAaGO0c6a' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'CleanAllMocks' test.out

#- 21 GetAllMockMatches
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockMatches \
    --channelName 'XoFM9JtzYynQYA8i' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 21 'GetAllMockMatches' test.out

#- 22 GetMockMatchesByTimestamp
# body param: body
echo '{"timestamp_after": 69}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockMatchesByTimestamp \
    --channelName 'PGEVFtDMMDML1ySK' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 22 'GetMockMatchesByTimestamp' test.out

#- 23 GetAllMockTickets
$CLI_EXE \
    --sn matchmaking \
    --op GetAllMockTickets \
    --channelName 'pmO86kO0hsIwynIA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 23 'GetAllMockTickets' test.out

#- 24 CreateMockTickets
# body param: body
echo '{"attribute_name": "bBloI0YJYXW2uzKW", "count": 80, "mmrMax": 0.9232506045806873, "mmrMean": 0.16044808038686575, "mmrMin": 0.6628998252711124, "mmrStdDev": 0.8276817104134121}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateMockTickets \
    --channelName '753VQLK9K4e0w5qc' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 24 'CreateMockTickets' test.out

#- 25 BulkCreateMockTickets
# body param: body
echo '[{"first_ticket_created_at": 70, "party_attributes": {"U4ZoFCFoWEdyIcgW": {}, "EloqldQTXf1RjwLW": {}, "iMZtnXi3eLkvnj2F": {}}, "party_id": "HRRu0umwsxpdZ1WW", "party_members": [{"extra_attributes": {"gZKluL2AcsKLs4xA": {}, "7pgTnAOS7ZVDYbaZ": {}, "dRyWBXrjEfLoBc63": {}}, "user_id": "d2CjPSt7u9HWKXy9"}, {"extra_attributes": {"5GCrxrJkGMw7ZL0l": {}, "1KamHkjtv5cJwGEc": {}, "C7aGI9Staa4kc8IE": {}}, "user_id": "Xb91iFIok1kMM49o"}, {"extra_attributes": {"WBLBOtyL1dHNmowM": {}, "hMKGNED5ygPVLMM3": {}, "usQQXneBGj9AjnpS": {}}, "user_id": "vpMEa0Lvq2wnqykl"}], "ticket_created_at": 35, "ticket_id": "P1wOzzLGRwbOmouZ"}, {"first_ticket_created_at": 100, "party_attributes": {"YIPoumSJ3SzT8lUp": {}, "XxkPntiTrWD69zuV": {}, "XfklxnwCn4oN7ReD": {}}, "party_id": "jlm69cVOR7cJag96", "party_members": [{"extra_attributes": {"pmsOSESfYYfcqCes": {}, "MQk3ZMQPndyprDAz": {}, "JHzrLAnhMLeNzo6A": {}}, "user_id": "VZOaKsluosiGaKd0"}, {"extra_attributes": {"wHfEbWYu5tq42y9t": {}, "PQEz6JWsYiQT5QSZ": {}, "tlA4KQeFg6EMZQcw": {}}, "user_id": "bAhRNgXXGYKIuGGr"}, {"extra_attributes": {"iMXJaukjQprS6Cmc": {}, "UjDbwPW4iYqSZFO9": {}, "EQt4SdrkfJD71OE4": {}}, "user_id": "nmvUcjS4yL7G8PAD"}], "ticket_created_at": 72, "ticket_id": "A91XiYV8om2lFtO1"}, {"first_ticket_created_at": 30, "party_attributes": {"fesSBanCCZXDbHie": {}, "mt24RYVxvOizOsLu": {}, "BOtvU0dysGQ752Sj": {}}, "party_id": "QQxTA0y5W0iCFQFC", "party_members": [{"extra_attributes": {"lD4StfbPz4B3Lcom": {}, "gS0MvgfAJ19LgFCi": {}, "F7r23snbG2mmF7Hl": {}}, "user_id": "YrBpxszoG732S8YE"}, {"extra_attributes": {"cJvLPLmCDp2m56H6": {}, "rESnZAb49bMTsiu2": {}, "AhkyihhJm1tA5U3Y": {}}, "user_id": "HEAnaS5wuVNYIq4a"}, {"extra_attributes": {"0PNyhzEL7RV4dZ3u": {}, "ArJ4li30FlwghwRV": {}, "PRlURfpBbB4nFHrM": {}}, "user_id": "fRpBHOax7TNLzgW5"}], "ticket_created_at": 67, "ticket_id": "g4eXbI1TK5tf2OW6"}]' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op BulkCreateMockTickets \
    --channelName 'O9zv4LwcYHUKZcfn' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 25 'BulkCreateMockTickets' test.out

#- 26 GetMockTicketsByTimestamp
# body param: body
echo '{"timestamp_after": 12}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op GetMockTicketsByTimestamp \
    --channelName '1k6C0bGXPhuWzOj8' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 26 'GetMockTicketsByTimestamp' test.out

#- 27 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'rGsEOgAyIS0fMWqA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'GetAllPartyInChannel' test.out

#- 28 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'lHrdUBriyIrHLfx3' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'GetAllSessionsInChannel' test.out

#- 29 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["OGuC3ijRNXXURQ3Z", "zgpA1SdFF4nsya3U", "XahzCQJ1WdbN8PkJ"], "party_id": "y1ez6rJd8RYLZhBz", "user_id": "MFVvnbGszjKvFIRV"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'DVtPCh4eQZdo9XVn' \
    --matchID 'tzEIwBXzY9HlZPJG' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 29 'AddUserIntoSessionInChannel' test.out

#- 30 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'KTkhgWzwSgrTgRRn' \
    --matchID 'cQ82CYozjxJFKJ1F' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 30 'DeleteSessionInChannel' test.out

#- 31 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'i6h4zCNLliGS9BRt' \
    --matchID 'lV78hu8KCGAzw9U3' \
    --namespace $AB_NAMESPACE \
    --userID 'MYdrTaU5R07Qdc1b' \
    > test.out 2>&1
eval_tap $? 31 'DeleteUserFromSessionInChannel' test.out

#- 32 GetStatData
$CLI_EXE \
    --sn matchmaking \
    --op GetStatData \
    --channelName 'yTwd9znJzmlyE6Jv' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 32 'GetStatData' test.out

#- 33 SearchSessions
eval_tap 0 33 'SearchSessions # SKIP deprecated' test.out

#- 34 GetSessionHistoryDetailed
eval_tap 0 34 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 35 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 35 'PublicGetMessages' test.out

#- 36 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 36 'PublicGetAllMatchmakingChannel' test.out

#- 37 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'QladJ7DeOXMk7WN9' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 37 'PublicGetSingleMatchmakingChannel' test.out

#- 38 SearchSessionsV2
eval_tap 0 38 'SearchSessionsV2 # SKIP deprecated' test.out

#- 39 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 39 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE