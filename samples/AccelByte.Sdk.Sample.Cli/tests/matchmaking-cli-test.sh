#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '67' \
    --offset '62' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "pdfTDWVd", "description": "K76pItuf", "find_match_timeout_seconds": 50, "game_mode": "zYwwbXWv", "joinable": false, "max_delay_ms": 53, "rule_set": {"alliance": {"combination": {"alliances": [{"max": 45, "min": 10, "name": "A4M4ww3g"}, {"max": 4, "min": 63, "name": "T5wlV9hU"}, {"max": 80, "min": 73, "name": "7HCvO6HI"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 8, "role_flexing_second": 56}, "max_number": 40, "min_number": 88, "player_max_number": 30, "player_min_number": 56}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 97, "min": 97, "name": "Gqmtuj6I"}, {"max": 36, "min": 9, "name": "ciUcGlUM"}, {"max": 37, "min": 72, "name": "eWTGdrPo"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 18, "role_flexing_second": 58}, "duration": 90, "max_number": 61, "min_number": 85, "player_max_number": 14, "player_min_number": 25}, {"combination": {"alliances": [{"max": 14, "min": 4, "name": "q7DhNIsJ"}, {"max": 17, "min": 25, "name": "Rsq5dAOF"}, {"max": 10, "min": 9, "name": "wZgg4aEA"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 3, "role_flexing_second": 2}, "duration": 68, "max_number": 83, "min_number": 97, "player_max_number": 92, "player_min_number": 87}, {"combination": {"alliances": [{"max": 79, "min": 98, "name": "UR7SBMYf"}, {"max": 22, "min": 99, "name": "BvqAcG3K"}, {"max": 91, "min": 56, "name": "Bu75bqT4"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 62, "role_flexing_second": 43}, "duration": 48, "max_number": 91, "min_number": 78, "player_max_number": 23, "player_min_number": 26}], "flexing_rule": [{"attribute": "47gpJyhL", "criteria": "6SJsueLl", "duration": 39, "reference": 0.8026230855497251}, {"attribute": "toPhc00E", "criteria": "KD4460Oj", "duration": 31, "reference": 0.17671834557216803}, {"attribute": "hkMmx8gp", "criteria": "axgAsHUn", "duration": 20, "reference": 0.16252469896944388}], "match_options": {"options": [{"name": "ZTvuxxr7", "type": "o4dZTNPC"}, {"name": "MFeQANuV", "type": "mNcmh6K2"}, {"name": "WRdHJ3b0", "type": "R2yUPyZG"}]}, "matching_rule": [{"attribute": "XriLJBGA", "criteria": "ItaIKN6L", "reference": 0.5565302015327003}, {"attribute": "N4Cn4TLk", "criteria": "orj8HoNi", "reference": 0.08134887014933267}, {"attribute": "SBkJvKWC", "criteria": "f0aBUO5K", "reference": 0.7782477162750685}], "rebalance_enable": false, "sub_game_modes": {"1niblYrb": {"alliance": {"combination": {"alliances": [{"max": 8, "min": 51, "name": "47St03i6"}, {"max": 32, "min": 91, "name": "SX3Em3ck"}, {"max": 3, "min": 18, "name": "ZSP4pacu"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 64, "role_flexing_second": 3}, "max_number": 87, "min_number": 60, "player_max_number": 54, "player_min_number": 57}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 40, "min": 28, "name": "z5DksOd4"}, {"max": 83, "min": 60, "name": "0lGwZMFW"}, {"max": 42, "min": 61, "name": "EFowFx4J"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 24, "role_flexing_second": 99}, "duration": 15, "max_number": 33, "min_number": 72, "player_max_number": 74, "player_min_number": 7}, {"combination": {"alliances": [{"max": 100, "min": 23, "name": "MCjFPDxi"}, {"max": 98, "min": 26, "name": "6mYHXzyn"}, {"max": 40, "min": 61, "name": "QZj272m3"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 23, "role_flexing_second": 9}, "duration": 54, "max_number": 49, "min_number": 14, "player_max_number": 28, "player_min_number": 66}, {"combination": {"alliances": [{"max": 38, "min": 15, "name": "HP50XHBl"}, {"max": 88, "min": 53, "name": "NKQAouCP"}, {"max": 31, "min": 40, "name": "4zhyiFeF"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 50, "role_flexing_second": 99}, "duration": 11, "max_number": 64, "min_number": 95, "player_max_number": 36, "player_min_number": 89}], "name": "u17QldtL"}, "jRuQrlao": {"alliance": {"combination": {"alliances": [{"max": 78, "min": 39, "name": "XooBrRHg"}, {"max": 63, "min": 10, "name": "tuqCkUBu"}, {"max": 83, "min": 3, "name": "be3ZBGZP"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 47, "role_flexing_second": 83}, "max_number": 91, "min_number": 0, "player_max_number": 86, "player_min_number": 80}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 14, "min": 70, "name": "6ZsFpSdL"}, {"max": 24, "min": 41, "name": "J8M1n3L9"}, {"max": 25, "min": 46, "name": "o1OPK3T7"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 61, "role_flexing_second": 56}, "duration": 18, "max_number": 54, "min_number": 93, "player_max_number": 63, "player_min_number": 21}, {"combination": {"alliances": [{"max": 77, "min": 87, "name": "E4lfE6jp"}, {"max": 90, "min": 7, "name": "I2CzZhNe"}, {"max": 26, "min": 75, "name": "YlbWCTyZ"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 77, "role_flexing_second": 8}, "duration": 88, "max_number": 40, "min_number": 99, "player_max_number": 12, "player_min_number": 63}, {"combination": {"alliances": [{"max": 74, "min": 82, "name": "a5IbnjtV"}, {"max": 69, "min": 94, "name": "HjkJcR0o"}, {"max": 46, "min": 88, "name": "xep5gQZ1"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 86, "role_flexing_second": 98}, "duration": 9, "max_number": 47, "min_number": 9, "player_max_number": 61, "player_min_number": 84}], "name": "OESilXUL"}, "IInIeNno": {"alliance": {"combination": {"alliances": [{"max": 62, "min": 42, "name": "Qm7rgZAR"}, {"max": 50, "min": 64, "name": "rf4f02A9"}, {"max": 2, "min": 84, "name": "YbSwbxMX"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 89, "role_flexing_second": 63}, "max_number": 50, "min_number": 41, "player_max_number": 22, "player_min_number": 34}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 7, "min": 69, "name": "OZ2KSjK2"}, {"max": 86, "min": 47, "name": "b772G9Qz"}, {"max": 58, "min": 55, "name": "rE5Tatcd"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 1, "role_flexing_second": 95}, "duration": 71, "max_number": 28, "min_number": 79, "player_max_number": 39, "player_min_number": 93}, {"combination": {"alliances": [{"max": 28, "min": 11, "name": "QXHZW2z8"}, {"max": 80, "min": 43, "name": "D16Gk719"}, {"max": 75, "min": 0, "name": "qGpTLS6S"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 0, "role_flexing_second": 9}, "duration": 50, "max_number": 57, "min_number": 72, "player_max_number": 55, "player_min_number": 97}, {"combination": {"alliances": [{"max": 67, "min": 72, "name": "DoD5ot2q"}, {"max": 76, "min": 8, "name": "vqbmXIov"}, {"max": 81, "min": 31, "name": "9yntq08V"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 86, "role_flexing_second": 72}, "duration": 41, "max_number": 55, "min_number": 78, "player_max_number": 35, "player_min_number": 25}], "name": "lmM5Y3aL"}}}, "session_queue_timeout_seconds": 99, "social_matchmaking": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'cFIN5qcy' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'DeleteChannelHandler' test.out

#- 7 StoreMatchResults
# body param: body
echo '{"match_id": "AzeMz4y0", "players": [{"results": [{"attribute": "OZwDg8wp", "value": 0.6065447824954456}, {"attribute": "cRJhP2UJ", "value": 0.5326802133293081}, {"attribute": "zXVXNcjf", "value": 0.8856507116602695}], "user_id": "Njh1oOBL"}, {"results": [{"attribute": "EIafd0xG", "value": 0.9495284889937029}, {"attribute": "BYbZeDre", "value": 0.18912779322460038}, {"attribute": "L2DqrHIa", "value": 0.10625489451088721}], "user_id": "AHtmCzTT"}, {"results": [{"attribute": "I3g6SfyX", "value": 0.13730247332543388}, {"attribute": "VRtb5PyL", "value": 0.6001310476054008}, {"attribute": "7L8VxMuf", "value": 0.5879601011089383}], "user_id": "B7aFNeXE"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'StoreMatchResults' test.out

#- 8 Rebalance
# body param: body
echo '{"match_id": "8tHuHnLi"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'Rebalance' test.out

#- 9 QueueSessionHandler
# body param: body
echo '{"channel": "v9rGNJUF", "client_version": "yBJT7cLa", "deployment": "6aZBLPJw", "error_code": 27, "error_message": "5CgOSvr3", "game_mode": "9bPXDImU", "joinable": false, "match_id": "sKIb9yjh", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 40, "party_attributes": {"SgYUdR8G": {}, "AQWNLYA6": {}, "8CrdlViR": {}}, "party_id": "S4iAfuHf", "party_members": [{"extra_attributes": {"sM5SXFSC": {}, "x27E71op": {}, "lY82uPZM": {}}, "user_id": "HQq5V5sO"}, {"extra_attributes": {"Bl2NuAb2": {}, "lgL2EJyF": {}, "9cCi20AG": {}}, "user_id": "gH318g4l"}, {"extra_attributes": {"QTuewKRG": {}, "Vwhyyy0G": {}, "ujCe8huH": {}}, "user_id": "ZBPwG1GL"}], "ticket_id": "9XRE0nqU"}, {"first_ticket_created_at": 52, "party_attributes": {"ZLw5VHum": {}, "EYUAEi1D": {}, "2VmfVLd7": {}}, "party_id": "nnUbPQ5i", "party_members": [{"extra_attributes": {"bGibjVPg": {}, "L3bZW4Y7": {}, "jTUMA4KA": {}}, "user_id": "VrPhbQOq"}, {"extra_attributes": {"02PRxauI": {}, "Lj7kEFc4": {}, "vst9WGat": {}}, "user_id": "QMJiXgo4"}, {"extra_attributes": {"ksaJbN3M": {}, "qEPYeRkr": {}, "qLdE9ACg": {}}, "user_id": "sDX0DZjz"}], "ticket_id": "fKjiSIoQ"}, {"first_ticket_created_at": 43, "party_attributes": {"u3wxvsLN": {}, "LS4BeAC3": {}, "EmYcwTxM": {}}, "party_id": "05KdYaEB", "party_members": [{"extra_attributes": {"HWxQgi05": {}, "gUujpeWE": {}, "gvemiGPQ": {}}, "user_id": "SsAPlPDQ"}, {"extra_attributes": {"F99IiTWU": {}, "8aFDkbBU": {}, "SOW0j3FD": {}}, "user_id": "RwSSoS7Y"}, {"extra_attributes": {"g5kvjhJi": {}, "qqUanuom": {}, "K2bRS8RA": {}}, "user_id": "sr4ZqSf0"}], "ticket_id": "AjnAWTcy"}]}, {"matching_parties": [{"first_ticket_created_at": 81, "party_attributes": {"Z4M2uZ8a": {}, "qX0EW67W": {}, "LUp0tPV6": {}}, "party_id": "WRYFsca9", "party_members": [{"extra_attributes": {"pqCwGM3I": {}, "yHjDsXBC": {}, "8UfVvisN": {}}, "user_id": "KBIgy5JO"}, {"extra_attributes": {"Fs052tGb": {}, "rdRVTq88": {}, "m4smzzMb": {}}, "user_id": "CPtqqHmp"}, {"extra_attributes": {"IKgqJsSw": {}, "O53kWj5k": {}, "qIvnMghx": {}}, "user_id": "DJK4njsL"}], "ticket_id": "3ok6OZzM"}, {"first_ticket_created_at": 73, "party_attributes": {"XeiCRHza": {}, "yIrSCKSM": {}, "bTn3wIDt": {}}, "party_id": "NWm3ESeI", "party_members": [{"extra_attributes": {"8i1zSYF5": {}, "fMhyrXx0": {}, "fuEOO3rT": {}}, "user_id": "VMvsvuj7"}, {"extra_attributes": {"cPLSruUr": {}, "J3D21dcB": {}, "66GJBt4E": {}}, "user_id": "hdxAGsVK"}, {"extra_attributes": {"0uEHgroT": {}, "WRQ0HBEA": {}, "NSFVaQt8": {}}, "user_id": "cLL9kcrV"}], "ticket_id": "w1DVGfus"}, {"first_ticket_created_at": 96, "party_attributes": {"iqM2fRGs": {}, "DcivT8pb": {}, "klCmGPMS": {}}, "party_id": "8RKV5Inu", "party_members": [{"extra_attributes": {"WcoFZbXr": {}, "HHgedANa": {}, "8IPvxar1": {}}, "user_id": "luzPsLRH"}, {"extra_attributes": {"0vxnJSM1": {}, "l4BTDU9O": {}, "1Y8xpcvI": {}}, "user_id": "xvVyVOcF"}, {"extra_attributes": {"o7ePaVkw": {}, "xOXwRhrf": {}, "kzGR90FG": {}}, "user_id": "RNGGYtYq"}], "ticket_id": "l44uAjmI"}]}, {"matching_parties": [{"first_ticket_created_at": 42, "party_attributes": {"lTCuySL2": {}, "8sG1yBgm": {}, "pZE2mu9m": {}}, "party_id": "PRIkzKpt", "party_members": [{"extra_attributes": {"ThrrcjKr": {}, "ZTmQuexo": {}, "4Q1TeoaI": {}}, "user_id": "yzFCsYqf"}, {"extra_attributes": {"D7tHeXVA": {}, "VSB46p4n": {}, "RY9ArGF9": {}}, "user_id": "ekR3Lrmu"}, {"extra_attributes": {"lr6CSFhe": {}, "VG31GFR2": {}, "QOu6eGmY": {}}, "user_id": "oBjSO2l4"}], "ticket_id": "1JDrWFt6"}, {"first_ticket_created_at": 65, "party_attributes": {"G3j3r3Ql": {}, "SOP3YuEi": {}, "6hogRuS5": {}}, "party_id": "yBCE3xtZ", "party_members": [{"extra_attributes": {"40aY1TXc": {}, "JVdCXn9L": {}, "17TFqN8U": {}}, "user_id": "SsQ9jxCI"}, {"extra_attributes": {"ZiNNEERR": {}, "JkBDIg65": {}, "kJW2Widu": {}}, "user_id": "pBfl20N0"}, {"extra_attributes": {"i0cy4VxM": {}, "YVTDeRMo": {}, "KfS3wqbq": {}}, "user_id": "Cdt3et1H"}], "ticket_id": "iufdi2RK"}, {"first_ticket_created_at": 72, "party_attributes": {"aV7sQhUJ": {}, "nBMCG57n": {}, "noTLymNC": {}}, "party_id": "SBTaGNKg", "party_members": [{"extra_attributes": {"J2ZapLw7": {}, "859jAwRs": {}, "rBrF0XvN": {}}, "user_id": "MSdl8i8K"}, {"extra_attributes": {"1WGco8jn": {}, "aJCORFbE": {}, "wb44jokd": {}}, "user_id": "CZ2s9j1f"}, {"extra_attributes": {"JnOYXLvA": {}, "YileaMFi": {}, "qgKn02qk": {}}, "user_id": "cK5ruBjr"}], "ticket_id": "T8OnPuT1"}]}], "namespace": "64gvYL15", "party_attributes": {"0wJhS9hv": {}, "VZcEH2bV": {}, "B5ZHXII2": {}}, "party_id": "6j0WtHey", "queued_at": 60, "region": "SbzclHU4", "server_name": "bT2MobLa", "status": "MnzBwuQ9", "ticket_id": "Smcn1ros", "updated_at": "1984-11-15T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'QueueSessionHandler' test.out

#- 10 DequeueSessionHandler
# body param: body
echo '{"match_id": "ZB3Sbpxe"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'DequeueSessionHandler' test.out

#- 11 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'EYOno3Xo' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'QuerySessionHandler' test.out

#- 12 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 19, "userID": "eEp2HxOe", "weight": 0.40790621340246236}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 12 'UpdatePlayTimeWeight' test.out

#- 13 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'GetAllPartyInAllChannel' test.out

#- 14 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'C6tvyYym' \
    > test.out 2>&1
eval_tap $? 14 'BulkGetSessions' test.out

#- 15 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'ExportChannels' test.out

#- 16 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'IrgXefhD' \
    > test.out 2>&1
eval_tap $? 16 'ImportChannels' test.out

#- 17 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'W5GvBQ7B' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'GetSingleMatchmakingChannel' test.out

#- 18 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "3kf56qxA", "description": "5BV59Ozq", "findMatchTimeoutSeconds": 83, "joinable": false, "max_delay_ms": 21, "ruleSet": {"alliance": {"combination": {"alliances": [{"max": 55, "min": 65, "name": "80ZIexSG"}, {"max": 77, "min": 87, "name": "xfsd176j"}, {"max": 23, "min": 78, "name": "1DMCOmQv"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 74, "role_flexing_second": 72}, "maxNumber": 76, "minNumber": 8, "playerMaxNumber": 73, "playerMinNumber": 32}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 72, "min": 99, "name": "KYnYDZGY"}, {"max": 22, "min": 69, "name": "9RrBmQqX"}, {"max": 22, "min": 58, "name": "YIvdCbo7"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 5, "role_flexing_second": 55}, "duration": 14, "max_number": 90, "min_number": 76, "player_max_number": 19, "player_min_number": 88}, {"combination": {"alliances": [{"max": 66, "min": 71, "name": "A2dpTG9k"}, {"max": 83, "min": 90, "name": "uWgBbqGK"}, {"max": 95, "min": 30, "name": "oQdR4iwK"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 21, "role_flexing_second": 23}, "duration": 74, "max_number": 76, "min_number": 60, "player_max_number": 12, "player_min_number": 47}, {"combination": {"alliances": [{"max": 69, "min": 27, "name": "f1fz17RI"}, {"max": 45, "min": 29, "name": "5eZCaN81"}, {"max": 70, "min": 70, "name": "bVWVF3ti"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 80, "role_flexing_second": 44}, "duration": 31, "max_number": 29, "min_number": 41, "player_max_number": 38, "player_min_number": 80}], "flexingRules": [{"attribute": "WqyAAV9z", "criteria": "Ls7dhok1", "duration": 16, "reference": 0.5454564592641463}, {"attribute": "Wg1tR4RV", "criteria": "4HOg3cF8", "duration": 16, "reference": 0.11946829958087668}, {"attribute": "R06mDPRo", "criteria": "y9hPG41A", "duration": 83, "reference": 0.8270162438738016}], "match_options": {"options": [{"name": "sPdVU5bZ", "type": "vWxWvRHB"}, {"name": "MrJq7d8E", "type": "rx2rzua7"}, {"name": "qFOUptIO", "type": "FOuhrybr"}]}, "matchingRules": [{"attribute": "jECx66ie", "criteria": "MHZvK4LM", "reference": 0.6399792279401258}, {"attribute": "Cu3mvR2z", "criteria": "0s08tUhP", "reference": 0.40512477049583406}, {"attribute": "GjN3iLjp", "criteria": "sH12dAHB", "reference": 0.11925790747479803}], "sub_game_modes": {}}, "sessionQueueTimeoutSeconds": 3, "socialMatchmaking": true, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName '173Ug84x' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'UpdateMatchmakingChannel' test.out

#- 19 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'pmVwT6r7' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'GetAllPartyInChannel' test.out

#- 20 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'd3WyWo7A' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'GetAllSessionsInChannel' test.out

#- 21 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["qKtlPQ3d", "rbQpSWbX", "rBBkM9dM"], "party_id": "3jAWk8CR", "user_id": "7Lrt6sd3"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'uVrzi66P' \
    --matchID 'RKFXJasx' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AddUserIntoSessionInChannel' test.out

#- 22 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'jS0q14T6' \
    --matchID 'BgbqvbBd' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'DeleteSessionInChannel' test.out

#- 23 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'NIVaM4OJ' \
    --matchID 'Y9oJ28Tx' \
    --namespace $AB_NAMESPACE \
    --userID 'lKCWwDSy' \
    > test.out 2>&1
eval_tap $? 23 'DeleteUserFromSessionInChannel' test.out

#- 24 SearchSessions
eval_tap 0 24 'SearchSessions # SKIP deprecated' test.out

#- 25 GetSessionHistoryDetailed
eval_tap 0 25 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 26 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 26 'PublicGetMessages' test.out

#- 27 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'PublicGetAllMatchmakingChannel' test.out

#- 28 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName '9vnqyyAZ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'PublicGetSingleMatchmakingChannel' test.out

#- 29 SearchSessionsV2
eval_tap 0 29 'SearchSessionsV2 # SKIP deprecated' test.out

#- 30 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 30 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE