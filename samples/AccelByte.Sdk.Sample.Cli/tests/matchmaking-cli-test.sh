#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '0' \
    --offset '1' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "p1Js6Tdg", "description": "hJM72AEV", "find_match_timeout_seconds": 35, "game_mode": "HYoOXnnO", "joinable": false, "max_delay_ms": 17, "rule_set": {"alliance": {"combination": {"alliances": [{"max": 94, "min": 17, "name": "C3EHaC08"}, {"max": 53, "min": 11, "name": "xtQgCF3u"}, {"max": 47, "min": 40, "name": "lPQoLeVl"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 11, "role_flexing_second": 59}, "max_number": 93, "min_number": 40, "player_max_number": 97, "player_min_number": 16}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 9, "min": 71, "name": "9TAIiYvg"}, {"max": 63, "min": 45, "name": "oP9ykW4H"}, {"max": 42, "min": 4, "name": "BXAzC6U6"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 88, "role_flexing_second": 40}, "duration": 11, "max_number": 95, "min_number": 18, "player_max_number": 19, "player_min_number": 74}, {"combination": {"alliances": [{"max": 0, "min": 6, "name": "NvGbCMCr"}, {"max": 8, "min": 83, "name": "Kf0ZXsy1"}, {"max": 77, "min": 62, "name": "QtorjnYF"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 37, "role_flexing_second": 40}, "duration": 84, "max_number": 82, "min_number": 84, "player_max_number": 15, "player_min_number": 10}, {"combination": {"alliances": [{"max": 2, "min": 62, "name": "3gGWWmui"}, {"max": 9, "min": 4, "name": "PfZC7qey"}, {"max": 60, "min": 28, "name": "AM0j1S8m"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 9, "role_flexing_second": 17}, "duration": 5, "max_number": 11, "min_number": 58, "player_max_number": 43, "player_min_number": 3}], "flexing_rule": [{"attribute": "splt0U8o", "criteria": "Hx8KeTc1", "duration": 50, "reference": 0.138461191811031}, {"attribute": "N5twIXcW", "criteria": "1Qa8zNxU", "duration": 17, "reference": 0.5340721373557982}, {"attribute": "qiUQjR3G", "criteria": "47CldFQ8", "duration": 88, "reference": 0.8429488052899973}], "match_options": {"options": [{"name": "Qlq868ho", "type": "gtfN0i3g"}, {"name": "WlDUpkbb", "type": "dXcgx9Cn"}, {"name": "SqVTGQ9w", "type": "MbEk9dUF"}]}, "matching_rule": [{"attribute": "ZQ9n4wuT", "criteria": "RW4KPmIx", "reference": 0.2506020781554332}, {"attribute": "IpJ5Pp5r", "criteria": "wMFU7lJQ", "reference": 0.8710108633573006}, {"attribute": "evGiJoEb", "criteria": "LQtzoWVs", "reference": 0.11058267740090222}], "rebalance_enable": false, "sub_game_modes": {"CDa11qAM": {"alliance": {"combination": {"alliances": [{"max": 39, "min": 90, "name": "5EilylWq"}, {"max": 7, "min": 44, "name": "rJJG9Zpj"}, {"max": 16, "min": 66, "name": "FjnyUek1"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 42, "role_flexing_second": 70}, "max_number": 12, "min_number": 65, "player_max_number": 30, "player_min_number": 10}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 90, "min": 46, "name": "33llrh69"}, {"max": 27, "min": 25, "name": "R4Q1TRTA"}, {"max": 54, "min": 86, "name": "9pKPTYLW"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 69, "role_flexing_second": 41}, "duration": 9, "max_number": 36, "min_number": 89, "player_max_number": 88, "player_min_number": 97}, {"combination": {"alliances": [{"max": 36, "min": 21, "name": "Mpb7eFKE"}, {"max": 71, "min": 76, "name": "YvemltZi"}, {"max": 1, "min": 40, "name": "1eVtps9j"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 48, "role_flexing_second": 28}, "duration": 8, "max_number": 34, "min_number": 78, "player_max_number": 20, "player_min_number": 84}, {"combination": {"alliances": [{"max": 49, "min": 29, "name": "Dvpfc6w4"}, {"max": 61, "min": 36, "name": "y7GhNQkP"}, {"max": 40, "min": 82, "name": "omA7cgfW"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 80, "role_flexing_second": 25}, "duration": 66, "max_number": 95, "min_number": 7, "player_max_number": 53, "player_min_number": 27}], "name": "IRxVHOQn"}, "j5HwUIBQ": {"alliance": {"combination": {"alliances": [{"max": 88, "min": 0, "name": "SHR9xzPT"}, {"max": 70, "min": 45, "name": "8uddJ31Y"}, {"max": 94, "min": 54, "name": "7nr8QcgJ"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 58, "role_flexing_second": 49}, "max_number": 55, "min_number": 24, "player_max_number": 98, "player_min_number": 16}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 83, "min": 26, "name": "bnCdjJRE"}, {"max": 28, "min": 66, "name": "9C8ZRkmO"}, {"max": 51, "min": 51, "name": "5jSsXZ44"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 24, "role_flexing_second": 20}, "duration": 99, "max_number": 64, "min_number": 60, "player_max_number": 19, "player_min_number": 76}, {"combination": {"alliances": [{"max": 20, "min": 77, "name": "V8OUNUdz"}, {"max": 70, "min": 65, "name": "koflaLRA"}, {"max": 54, "min": 98, "name": "q87V5WfV"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 28, "role_flexing_second": 8}, "duration": 71, "max_number": 46, "min_number": 15, "player_max_number": 70, "player_min_number": 25}, {"combination": {"alliances": [{"max": 54, "min": 40, "name": "lpp5NQtV"}, {"max": 9, "min": 51, "name": "w6rhAnyB"}, {"max": 90, "min": 59, "name": "bUICWd9J"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 86, "role_flexing_second": 88}, "duration": 95, "max_number": 60, "min_number": 66, "player_max_number": 65, "player_min_number": 59}], "name": "ZaUL9Krp"}, "0i1ZfeSf": {"alliance": {"combination": {"alliances": [{"max": 15, "min": 87, "name": "xJMJ1SDO"}, {"max": 20, "min": 33, "name": "0T0RrVGK"}, {"max": 90, "min": 95, "name": "gl0kKOuo"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 97, "role_flexing_second": 89}, "max_number": 90, "min_number": 68, "player_max_number": 77, "player_min_number": 62}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 24, "min": 40, "name": "EvZkXqPs"}, {"max": 59, "min": 83, "name": "ue6nEFjU"}, {"max": 59, "min": 64, "name": "wEk6DImb"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 77, "role_flexing_second": 28}, "duration": 67, "max_number": 79, "min_number": 14, "player_max_number": 18, "player_min_number": 42}, {"combination": {"alliances": [{"max": 63, "min": 49, "name": "NcvZTDG5"}, {"max": 99, "min": 22, "name": "ffKsMons"}, {"max": 10, "min": 68, "name": "ycYBWe84"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 88, "role_flexing_second": 85}, "duration": 51, "max_number": 82, "min_number": 78, "player_max_number": 76, "player_min_number": 58}, {"combination": {"alliances": [{"max": 56, "min": 80, "name": "znPGIYIE"}, {"max": 95, "min": 54, "name": "N4bS2LPU"}, {"max": 10, "min": 53, "name": "vOlluXc8"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 29, "role_flexing_second": 37}, "duration": 71, "max_number": 39, "min_number": 20, "player_max_number": 3, "player_min_number": 61}], "name": "5PXlOjTm"}}}, "session_queue_timeout_seconds": 23, "social_matchmaking": false, "use_sub_gamemode": false}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel 'mGX3aGXE' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'DeleteChannelHandler' test.out

#- 7 StoreMatchResults
# body param: body
echo '{"match_id": "C4sA2M0P", "players": [{"results": [{"attribute": "zzu0dl4e", "value": 0.6159705502706139}, {"attribute": "dEAzjZJr", "value": 0.9325525421035954}, {"attribute": "RN6IStbU", "value": 0.6915094440338806}], "user_id": "zFFfsj2H"}, {"results": [{"attribute": "ejckznQl", "value": 0.13826494582675342}, {"attribute": "jRKokrdU", "value": 0.682828041728286}, {"attribute": "0FNs5XiY", "value": 0.8465330863722957}], "user_id": "QcHqaaNZ"}, {"results": [{"attribute": "cb2JaFdN", "value": 0.9318502259031377}, {"attribute": "rXZob6h5", "value": 0.37750278838699547}, {"attribute": "cipnKVoH", "value": 0.31245122389596724}], "user_id": "gmIBrsTX"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'StoreMatchResults' test.out

#- 8 Rebalance
# body param: body
echo '{"match_id": "n5nezPH3"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'Rebalance' test.out

#- 9 QueueSessionHandler
# body param: body
echo '{"channel": "ywh6tf4s", "client_version": "JtEXTDBt", "deployment": "IePulu8q", "error_code": 27, "error_message": "MSgE1SWv", "game_mode": "snHWzd0d", "joinable": true, "match_id": "i01Q9mib", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 84, "party_attributes": {"adQtE4kS": {}, "Umo5yfIJ": {}, "oRN5hbN4": {}}, "party_id": "HBnNvgeG", "party_members": [{"extra_attributes": {"GC3tFdS3": {}, "9NhPZAR0": {}, "fw2JYpCs": {}}, "user_id": "7N2GfVGQ"}, {"extra_attributes": {"vbOl9FWG": {}, "JFxjCl8A": {}, "DG9Hh8Zn": {}}, "user_id": "ORHPkEid"}, {"extra_attributes": {"aa9tgsEJ": {}, "OrzI0N0A": {}, "pvhri0Je": {}}, "user_id": "zW1Lx5oR"}], "ticket_id": "eSuqHDdA"}, {"first_ticket_created_at": 20, "party_attributes": {"7NLCIi80": {}, "0Nnpxos9": {}, "QP7fZmak": {}}, "party_id": "AsF830ma", "party_members": [{"extra_attributes": {"zgEs1cLG": {}, "9Lg1FEmf": {}, "E4VzqggY": {}}, "user_id": "uqjPDMKB"}, {"extra_attributes": {"NYa7QdPJ": {}, "ersliUA0": {}, "yBGDz6qO": {}}, "user_id": "5FHNr84L"}, {"extra_attributes": {"rk8JUlhC": {}, "K5MovPM2": {}, "OW4ogHPc": {}}, "user_id": "mIIjqUiw"}], "ticket_id": "zQlxuwF3"}, {"first_ticket_created_at": 33, "party_attributes": {"C9wznXcE": {}, "LXgOvONN": {}, "5YgrIpZ6": {}}, "party_id": "IeZHYDus", "party_members": [{"extra_attributes": {"qJJ5skHc": {}, "hqwR7qNK": {}, "6ZmMBRF4": {}}, "user_id": "tluAlySg"}, {"extra_attributes": {"w2tbXBYt": {}, "Qi3kD1DH": {}, "BSCTb2bI": {}}, "user_id": "WDXdnKUP"}, {"extra_attributes": {"UghkPJW0": {}, "ttt11fTe": {}, "kSNWOB6w": {}}, "user_id": "DlL7cF68"}], "ticket_id": "JrhEHQwW"}]}, {"matching_parties": [{"first_ticket_created_at": 69, "party_attributes": {"LbevOLNh": {}, "zzJIDvAd": {}, "075GnWGS": {}}, "party_id": "R3MF1lVg", "party_members": [{"extra_attributes": {"7yBpUQeX": {}, "46JeABJP": {}, "QhRAPVMi": {}}, "user_id": "QLttqriQ"}, {"extra_attributes": {"Il7jQOJP": {}, "W2Bl4feR": {}, "ssJzvlDk": {}}, "user_id": "yU2YxtsM"}, {"extra_attributes": {"iYI4Ehq5": {}, "EpL2YpIy": {}, "S3TnUlMH": {}}, "user_id": "XXckWXpk"}], "ticket_id": "Ot5tGOEI"}, {"first_ticket_created_at": 28, "party_attributes": {"xwenBmpR": {}, "HqGxNZbp": {}, "ADrQpK4T": {}}, "party_id": "pFcsKgkg", "party_members": [{"extra_attributes": {"xqj1nJDm": {}, "y9TSjm78": {}, "EUt758h2": {}}, "user_id": "28KySaRU"}, {"extra_attributes": {"ahuqytaw": {}, "rnzDIIjG": {}, "wIQhOD2I": {}}, "user_id": "HZdtTg6z"}, {"extra_attributes": {"5dx0yO2z": {}, "7y9Hgaaj": {}, "PCCZNUwV": {}}, "user_id": "11RuQ1gc"}], "ticket_id": "D3uH24oV"}, {"first_ticket_created_at": 3, "party_attributes": {"rv3Ybm9h": {}, "ZrgJ1AZs": {}, "pBxKUWQs": {}}, "party_id": "930NFVUy", "party_members": [{"extra_attributes": {"peYfA85V": {}, "c04A8xsU": {}, "vZQzFy5d": {}}, "user_id": "JcogmMMi"}, {"extra_attributes": {"sUZZ6kmg": {}, "kwUYdtyi": {}, "jrcasRFZ": {}}, "user_id": "062M7P1N"}, {"extra_attributes": {"KxRTO0yv": {}, "wvM554PG": {}, "mIhPjFsA": {}}, "user_id": "UPKQ4Aiw"}], "ticket_id": "e86wxlyq"}]}, {"matching_parties": [{"first_ticket_created_at": 46, "party_attributes": {"DSHfLDTs": {}, "ogjestXD": {}, "mPQ5DUte": {}}, "party_id": "WeuAHiw9", "party_members": [{"extra_attributes": {"vt7QXL6I": {}, "vb4smnMO": {}, "SHs4GIzH": {}}, "user_id": "XFItizob"}, {"extra_attributes": {"Ffw9dr9x": {}, "HJ4vw5va": {}, "WE9ES14L": {}}, "user_id": "cbKsdFKB"}, {"extra_attributes": {"mLvccLUq": {}, "qXTTVIvA": {}, "aEbieQZ3": {}}, "user_id": "Xy7E48iV"}], "ticket_id": "vCvjNQzp"}, {"first_ticket_created_at": 75, "party_attributes": {"N9wzmui3": {}, "JxJWOYC2": {}, "ghGwUYZC": {}}, "party_id": "rwXBwkh9", "party_members": [{"extra_attributes": {"MFt8YCRm": {}, "PPoQT1ff": {}, "LiVrr2vQ": {}}, "user_id": "aQXc09pZ"}, {"extra_attributes": {"FEoZ7iae": {}, "PQfiXi0u": {}, "z3pH8kpo": {}}, "user_id": "ZNG9HdZr"}, {"extra_attributes": {"1758342G": {}, "aKk3OjSJ": {}, "JOcnawR4": {}}, "user_id": "gH6zR6P3"}], "ticket_id": "wBmPhyRy"}, {"first_ticket_created_at": 86, "party_attributes": {"0Q4NYLkR": {}, "fOpxXs35": {}, "yVMguKNA": {}}, "party_id": "jqVX5N0s", "party_members": [{"extra_attributes": {"tn93K42J": {}, "Fxf6bd1w": {}, "6MX5JTRk": {}}, "user_id": "E9AjpS4r"}, {"extra_attributes": {"RyYAtHmv": {}, "rGPD5y2a": {}, "bJNxXqD6": {}}, "user_id": "Jsldns4E"}, {"extra_attributes": {"f8NW5Juq": {}, "8SQuSfy9": {}, "8EZSWRRg": {}}, "user_id": "22a55606"}], "ticket_id": "mP4VKHvR"}]}], "namespace": "ZInHA2Ds", "party_attributes": {"jqIZPk2t": {}, "3iJHNpWn": {}, "wP3pfR2g": {}}, "party_id": "yt7Bhg9l", "queued_at": 22, "region": "2YufmQPa", "server_name": "Ct8EN0Aq", "status": "kTFhMnHX", "ticket_id": "Gaj5RoPe", "updated_at": "1993-09-18T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'QueueSessionHandler' test.out

#- 10 DequeueSessionHandler
# body param: body
echo '{"match_id": "0h3Veygp"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'DequeueSessionHandler' test.out

#- 11 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 'yk7oDlbv' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'QuerySessionHandler' test.out

#- 12 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 69, "userID": "dGlZAqWG", "weight": 0.7512436033208255}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 12 'UpdatePlayTimeWeight' test.out

#- 13 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'GetAllPartyInAllChannel' test.out

#- 14 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs 'Tza3t60Q' \
    > test.out 2>&1
eval_tap $? 14 'BulkGetSessions' test.out

#- 15 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'ExportChannels' test.out

#- 16 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'jAfU0tMJ' \
    > test.out 2>&1
eval_tap $? 16 'ImportChannels' test.out

#- 17 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'MksXUZFZ' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'GetSingleMatchmakingChannel' test.out

#- 18 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "0GmdQsPb", "description": "mEsNHcgt", "findMatchTimeoutSeconds": 66, "joinable": false, "max_delay_ms": 69, "ruleSet": {"alliance": {"combination": {"alliances": [{"max": 69, "min": 69, "name": "47wmHf7f"}, {"max": 82, "min": 87, "name": "XeBnmLIy"}, {"max": 63, "min": 33, "name": "LzldHPZH"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 85, "role_flexing_second": 33}, "maxNumber": 53, "minNumber": 83, "playerMaxNumber": 14, "playerMinNumber": 86}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 9, "min": 92, "name": "nrbsAxWv"}, {"max": 63, "min": 23, "name": "7xsB2W0S"}, {"max": 45, "min": 10, "name": "ihyhWxxH"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 8, "role_flexing_second": 67}, "duration": 50, "max_number": 22, "min_number": 47, "player_max_number": 10, "player_min_number": 41}, {"combination": {"alliances": [{"max": 58, "min": 68, "name": "blzcMjTs"}, {"max": 57, "min": 45, "name": "6yTBZrV2"}, {"max": 49, "min": 80, "name": "5GEP2vFQ"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 48, "role_flexing_second": 30}, "duration": 93, "max_number": 31, "min_number": 25, "player_max_number": 5, "player_min_number": 89}, {"combination": {"alliances": [{"max": 4, "min": 72, "name": "twp5wl1A"}, {"max": 22, "min": 62, "name": "e4cUyZQ2"}, {"max": 47, "min": 38, "name": "ooIkTaPH"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 28, "role_flexing_second": 56}, "duration": 27, "max_number": 63, "min_number": 55, "player_max_number": 20, "player_min_number": 15}], "flexingRules": [{"attribute": "8SNLgFxF", "criteria": "PIBx7zGL", "duration": 35, "reference": 0.7050150958830081}, {"attribute": "sdbroHoO", "criteria": "5P8QILRq", "duration": 78, "reference": 0.10753864606792651}, {"attribute": "Zpuq3o88", "criteria": "LtEkLZ8j", "duration": 97, "reference": 0.2169055661833913}], "match_options": {"options": [{"name": "kG1zZypW", "type": "PXtCNJFp"}, {"name": "TWzRJiXi", "type": "ixkICjat"}, {"name": "1fQojPHz", "type": "WSbeLAuM"}]}, "matchingRules": [{"attribute": "u4579Z1y", "criteria": "HRL9pmOe", "reference": 0.02209627254311064}, {"attribute": "1t3wcGbW", "criteria": "DOnOaKkK", "reference": 0.944635517592276}, {"attribute": "qcC4giFr", "criteria": "YGPcKvaG", "reference": 0.8990317175358086}], "sub_game_modes": {}}, "sessionQueueTimeoutSeconds": 64, "socialMatchmaking": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'CAmgkBTb' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'UpdateMatchmakingChannel' test.out

#- 19 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName 'HjZnAvVM' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'GetAllPartyInChannel' test.out

#- 20 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'GF3nLhpP' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'GetAllSessionsInChannel' test.out

#- 21 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["2bEG4Fk5", "IChVGn6T", "85TFFI8j"], "party_id": "Sia4Oept", "user_id": "2i72Tifx"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'PYcb4tya' \
    --matchID 'gTerpLDv' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AddUserIntoSessionInChannel' test.out

#- 22 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'Dy7yWdVQ' \
    --matchID 'hsEr6rco' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'DeleteSessionInChannel' test.out

#- 23 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'h1WBFY4J' \
    --matchID 'kslhbSI8' \
    --namespace $AB_NAMESPACE \
    --userID '8HOPUdyJ' \
    > test.out 2>&1
eval_tap $? 23 'DeleteUserFromSessionInChannel' test.out

#- 24 SearchSessions
eval_tap 0 24 'SearchSessions # SKIP deprecated' test.out

#- 25 GetSessionHistoryDetailed
eval_tap 0 25 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 26 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 26 'PublicGetMessages' test.out

#- 27 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'PublicGetAllMatchmakingChannel' test.out

#- 28 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName '06KM1QjU' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'PublicGetSingleMatchmakingChannel' test.out

#- 29 SearchSessionsV2
eval_tap 0 29 'SearchSessionsV2 # SKIP deprecated' test.out

#- 30 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 30 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE