#!/usr/bin/env bash

# Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
# This is licensed software from AccelByte Inc, for limitations
# and restrictions contact your company contract manager.

# This code is generated by tool. DO NOT EDIT.

# Meta:
# - random seed: 512
# - template file: cli-test.j2

# Instructions:
# - Run the Justice SDK Mock Server first before running this script.

export AB_BASE_URL="http://127.0.0.1:8080"
export AB_CLIENT_ID="admin"
export AB_CLIENT_SECRET="admin"
export AB_NAMESPACE="test"
export AB_APP_NAME="UnitTest"

EXIT_CODE=0

eval_tap() {
  if [ $1 -eq 0 ]; then
    echo "ok $2 - $3"
  else
    EXIT_CODE=1
    echo "not ok $2 - $3"
    sed 's/^/# /g' $4
  fi
  rm -f $4
}

CLI_EXE="AccelByte.Sdk.Sample.Cli"
CLI_TOKEN_FILE="$(dirname "$(which $CLI_EXE)")/token.json"
TEMP_JSON_INPUT="input_json.json"
TEMP_FILE_UPLOAD="file_upload.bin"

echo "TAP version 13"
echo "1..30"

#- 1 Login
$CLI_EXE --op login --lt user --user user --pass user > test.out 2>&1
eval_tap $? 1 'Login' test.out

if [ $EXIT_CODE -ne 0 ]; then
  echo "Bail out! Login failed."
  exit $EXIT_CODE
fi

# echo "foo" > "$CLI_TOKEN_FILE"

#- 2 GetHealthcheckInfo
$CLI_EXE \
    --sn matchmaking \
    --op GetHealthcheckInfo \
    > test.out 2>&1
eval_tap $? 2 'GetHealthcheckInfo' test.out

#- 3 HandlerV3Healthz
$CLI_EXE \
    --sn matchmaking \
    --op HandlerV3Healthz \
    > test.out 2>&1
eval_tap $? 3 'HandlerV3Healthz' test.out

#- 4 GetAllChannelsHandler
$CLI_EXE \
    --sn matchmaking \
    --op GetAllChannelsHandler \
    --namespace $AB_NAMESPACE \
    --limit '2' \
    --offset '56' \
    > test.out 2>&1
eval_tap $? 4 'GetAllChannelsHandler' test.out

#- 5 CreateChannelHandler
# body param: body
echo '{"deployment": "i3wMWnoZ", "description": "gIhwb8YY", "find_match_timeout_seconds": 79, "game_mode": "0PbemSBE", "joinable": false, "max_delay_ms": 22, "rule_set": {"alliance": {"combination": {"alliances": [{"max": 1, "min": 18, "name": "VBUGA7nk"}, {"max": 60, "min": 9, "name": "IlNJKxhP"}, {"max": 11, "min": 69, "name": "WV6dIabc"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 90, "role_flexing_second": 22}, "max_number": 24, "min_number": 10, "player_max_number": 37, "player_min_number": 41}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 71, "min": 57, "name": "33oQWoXF"}, {"max": 8, "min": 45, "name": "qeuI2oMJ"}, {"max": 47, "min": 6, "name": "lDdEs4ig"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 74, "role_flexing_second": 10}, "duration": 36, "max_number": 76, "min_number": 26, "player_max_number": 54, "player_min_number": 50}, {"combination": {"alliances": [{"max": 87, "min": 95, "name": "tZ5GZi5P"}, {"max": 77, "min": 4, "name": "J58QqcV3"}, {"max": 71, "min": 5, "name": "4rm2jUc9"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 44, "role_flexing_second": 76}, "duration": 60, "max_number": 41, "min_number": 94, "player_max_number": 33, "player_min_number": 49}, {"combination": {"alliances": [{"max": 24, "min": 36, "name": "E9oLDPD0"}, {"max": 76, "min": 73, "name": "fle8ESU1"}, {"max": 79, "min": 25, "name": "O8XnVaEy"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 1, "role_flexing_second": 16}, "duration": 10, "max_number": 82, "min_number": 72, "player_max_number": 42, "player_min_number": 60}], "flexing_rule": [{"attribute": "124TsbQs", "criteria": "xYFxGGHr", "duration": 12, "reference": 0.3393453932645112}, {"attribute": "qDSU3PDy", "criteria": "IAGfGq1F", "duration": 82, "reference": 0.044978761655282584}, {"attribute": "yt67WAfW", "criteria": "XfUfwGB0", "duration": 41, "reference": 0.9419535056118947}], "match_options": {"options": [{"name": "7xodwuG1", "type": "4ID5l5wj"}, {"name": "6K2wEMnc", "type": "kjlW6Byw"}, {"name": "sSSZTGlu", "type": "bsmhjXcS"}]}, "matching_rule": [{"attribute": "cOUvrjJB", "criteria": "O7tbkTGY", "reference": 0.586708292102953}, {"attribute": "qRMSTisP", "criteria": "0MrSdaFy", "reference": 0.8535979047598488}, {"attribute": "pJYCdfkf", "criteria": "yt09ro5f", "reference": 0.5410092859349483}], "rebalance_enable": false, "sub_game_modes": {"s9BZTYc5": {"alliance": {"combination": {"alliances": [{"max": 56, "min": 32, "name": "sdSSVaAz"}, {"max": 53, "min": 21, "name": "n4GbgkKe"}, {"max": 58, "min": 10, "name": "aS6qyUCs"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 69, "role_flexing_second": 38}, "max_number": 92, "min_number": 78, "player_max_number": 85, "player_min_number": 24}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 85, "min": 82, "name": "jaYEDxaY"}, {"max": 81, "min": 100, "name": "8w9KUW0p"}, {"max": 51, "min": 74, "name": "Anbq4Djm"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 60, "role_flexing_second": 65}, "duration": 43, "max_number": 33, "min_number": 73, "player_max_number": 96, "player_min_number": 84}, {"combination": {"alliances": [{"max": 90, "min": 21, "name": "D356pVsU"}, {"max": 40, "min": 92, "name": "Nanddzgw"}, {"max": 48, "min": 51, "name": "YdQc5hEf"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 10, "role_flexing_second": 66}, "duration": 6, "max_number": 10, "min_number": 29, "player_max_number": 88, "player_min_number": 32}, {"combination": {"alliances": [{"max": 59, "min": 5, "name": "ahcox63c"}, {"max": 49, "min": 61, "name": "Hwi7vg3o"}, {"max": 37, "min": 6, "name": "bh0fL2h7"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 73, "role_flexing_second": 71}, "duration": 43, "max_number": 19, "min_number": 55, "player_max_number": 81, "player_min_number": 92}], "name": "mbfoW8bD"}, "q5jPqzhN": {"alliance": {"combination": {"alliances": [{"max": 83, "min": 7, "name": "LfvwPewr"}, {"max": 11, "min": 46, "name": "19Njm50x"}, {"max": 59, "min": 60, "name": "nXzhBC0u"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 51, "role_flexing_second": 95}, "max_number": 12, "min_number": 100, "player_max_number": 28, "player_min_number": 37}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 11, "min": 7, "name": "YvNvG8uQ"}, {"max": 47, "min": 54, "name": "6o28Njxy"}, {"max": 46, "min": 46, "name": "7RHldq0m"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 80, "role_flexing_second": 96}, "duration": 72, "max_number": 20, "min_number": 17, "player_max_number": 12, "player_min_number": 34}, {"combination": {"alliances": [{"max": 1, "min": 61, "name": "t8xnPoWT"}, {"max": 7, "min": 39, "name": "HAkcyAy4"}, {"max": 6, "min": 73, "name": "rHlPcXGG"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 45, "role_flexing_second": 11}, "duration": 82, "max_number": 43, "min_number": 64, "player_max_number": 9, "player_min_number": 18}, {"combination": {"alliances": [{"max": 56, "min": 58, "name": "frpCrnba"}, {"max": 47, "min": 64, "name": "hEvn3SGq"}, {"max": 4, "min": 40, "name": "H91fC3aJ"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 34, "role_flexing_second": 46}, "duration": 100, "max_number": 0, "min_number": 15, "player_max_number": 64, "player_min_number": 53}], "name": "gq7pRVZV"}, "LJiDx3au": {"alliance": {"combination": {"alliances": [{"max": 22, "min": 2, "name": "MFzeiMRk"}, {"max": 4, "min": 73, "name": "Or1L0TMI"}, {"max": 4, "min": 30, "name": "zbYilOzi"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 58, "role_flexing_second": 37}, "max_number": 84, "min_number": 32, "player_max_number": 76, "player_min_number": 92}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 82, "min": 34, "name": "zSZm9K3c"}, {"max": 79, "min": 53, "name": "Y617HSCY"}, {"max": 11, "min": 1, "name": "go69uv1b"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 64, "role_flexing_second": 86}, "duration": 47, "max_number": 0, "min_number": 61, "player_max_number": 47, "player_min_number": 25}, {"combination": {"alliances": [{"max": 94, "min": 2, "name": "WnmyEYLZ"}, {"max": 88, "min": 7, "name": "TpvLH6QP"}, {"max": 62, "min": 36, "name": "BP8kSSFj"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 41, "role_flexing_second": 83}, "duration": 78, "max_number": 3, "min_number": 8, "player_max_number": 47, "player_min_number": 17}, {"combination": {"alliances": [{"max": 87, "min": 38, "name": "QPYwmYFb"}, {"max": 49, "min": 72, "name": "RvHYDCYw"}, {"max": 30, "min": 67, "name": "WxGWRH7f"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 96, "role_flexing_second": 57}, "duration": 93, "max_number": 6, "min_number": 44, "player_max_number": 85, "player_min_number": 27}], "name": "hLtHRJOI"}}}, "session_queue_timeout_seconds": 26, "social_matchmaking": true, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op CreateChannelHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 5 'CreateChannelHandler' test.out

#- 6 DeleteChannelHandler
$CLI_EXE \
    --sn matchmaking \
    --op DeleteChannelHandler \
    --channel '7aeAaGq0' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 6 'DeleteChannelHandler' test.out

#- 7 StoreMatchResults
# body param: body
echo '{"match_id": "NIj53gXk", "players": [{"results": [{"attribute": "mrayvcIY", "value": 0.13510848191613645}, {"attribute": "WxIAxfvL", "value": 0.4171022338567031}, {"attribute": "SpDFY3lx", "value": 0.07365290799640178}], "user_id": "16KsSRzk"}, {"results": [{"attribute": "f2HzBcEi", "value": 0.23993488642351946}, {"attribute": "5UyvuFv5", "value": 0.4097777123431876}, {"attribute": "6wosJGnU", "value": 0.39051636118653943}], "user_id": "CMEbHh1u"}, {"results": [{"attribute": "E4DmJ4Su", "value": 0.154469595480767}, {"attribute": "6DjUw36G", "value": 0.3152695042046392}, {"attribute": "Z83Jp2f9", "value": 0.09288226922322174}], "user_id": "1FCoIo3L"}]}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op StoreMatchResults \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 7 'StoreMatchResults' test.out

#- 8 Rebalance
# body param: body
echo '{"match_id": "24DKGwgZ"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op Rebalance \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 8 'Rebalance' test.out

#- 9 QueueSessionHandler
# body param: body
echo '{"channel": "85vyFJR8", "client_version": "euQBLVu2", "deployment": "7iwplLJd", "error_code": 53, "error_message": "tWdJM9Qc", "game_mode": "5HmR0vkn", "joinable": false, "match_id": "O45AUtNX", "matching_allies": [{"matching_parties": [{"first_ticket_created_at": 92, "party_attributes": {"qQQIXVmr": {}, "tRlq1jv6": {}, "0HTnmFrl": {}}, "party_id": "3gYx6Xmv", "party_members": [{"extra_attributes": {"1DzPHux3": {}, "k3skhn3m": {}, "WZjTYM95": {}}, "user_id": "e4aa8xOJ"}, {"extra_attributes": {"u7rNRVdy": {}, "gfKmUkzj": {}, "9mHFpff2": {}}, "user_id": "vDkz68zo"}, {"extra_attributes": {"rEgcExv9": {}, "nKMOgO5W": {}, "8SUaZjCp": {}}, "user_id": "NtJSMm8k"}], "ticket_created_at": 60, "ticket_id": "btdK2r4w"}, {"first_ticket_created_at": 99, "party_attributes": {"wtRGdT44": {}, "7Oa51m6V": {}, "Lfjsw270": {}}, "party_id": "pMmOQJrp", "party_members": [{"extra_attributes": {"EBbVvBn8": {}, "Lsf2qSAt": {}, "izV9hzsV": {}}, "user_id": "bpJLtEZj"}, {"extra_attributes": {"uyFhvbxX": {}, "2DNbknfV": {}, "v4nm70TC": {}}, "user_id": "ayYAkF18"}, {"extra_attributes": {"YBwRxcRE": {}, "yU5CwqGJ": {}, "F6nDi33I": {}}, "user_id": "ztr2Qcwl"}], "ticket_created_at": 90, "ticket_id": "TNY3lpin"}, {"first_ticket_created_at": 4, "party_attributes": {"k8lfuiJV": {}, "cktlx9zJ": {}, "ZVVCc9bp": {}}, "party_id": "IHEWQMmC", "party_members": [{"extra_attributes": {"kIqwqpoT": {}, "VCNrcaVo": {}, "zsjIXO2E": {}}, "user_id": "UsAfBvo6"}, {"extra_attributes": {"Llcalks2": {}, "R3VMtipT": {}, "VxXAF8Kh": {}}, "user_id": "OKqbrECi"}, {"extra_attributes": {"jFxOpOzx": {}, "eTLJQsZc": {}, "TEzXaXUz": {}}, "user_id": "psAV6ct6"}], "ticket_created_at": 71, "ticket_id": "OntGCwQS"}]}, {"matching_parties": [{"first_ticket_created_at": 69, "party_attributes": {"MSQluAoE": {}, "D9oYwS8o": {}, "LyErKvRt": {}}, "party_id": "HFGJRoGW", "party_members": [{"extra_attributes": {"7VBG1VB2": {}, "sp2x9msz": {}, "GGoyhGZA": {}}, "user_id": "zt2OVBTL"}, {"extra_attributes": {"wSH8hWRU": {}, "9pbItGQ7": {}, "VUWBhGol": {}}, "user_id": "wafIfbF1"}, {"extra_attributes": {"GLFnrQ4T": {}, "5cmw7U1T": {}, "xiS06UEo": {}}, "user_id": "aDZpXOWz"}], "ticket_created_at": 31, "ticket_id": "8Dfc7114"}, {"first_ticket_created_at": 87, "party_attributes": {"tqcXjPkj": {}, "2IzU3MEp": {}, "Ct1IjlfH": {}}, "party_id": "JM92t9j1", "party_members": [{"extra_attributes": {"XT2ErwIx": {}, "kaTnYtr1": {}, "YDnaXB0J": {}}, "user_id": "OS4XKVT6"}, {"extra_attributes": {"6sHYPgVs": {}, "fhoEidKw": {}, "4IP0NVna": {}}, "user_id": "angorhVF"}, {"extra_attributes": {"pTRuQyMr": {}, "oT2hNfKJ": {}, "7q8sifSP": {}}, "user_id": "mYSsBxty"}], "ticket_created_at": 76, "ticket_id": "hxv1vuN7"}, {"first_ticket_created_at": 43, "party_attributes": {"v6OuG6RR": {}, "1jPh8Rbl": {}, "vnfNiABR": {}}, "party_id": "f1gdXM7Q", "party_members": [{"extra_attributes": {"lAlnjAfg": {}, "xOdZdf9t": {}, "LHO1qrNy": {}}, "user_id": "hmUEADcz"}, {"extra_attributes": {"zrL31HuY": {}, "KsCBBgwb": {}, "1hGjHJgx": {}}, "user_id": "rcEvnfJq"}, {"extra_attributes": {"U4hCv5eg": {}, "SQDePKSZ": {}, "Kp6zwDQS": {}}, "user_id": "1atvJrAL"}], "ticket_created_at": 0, "ticket_id": "tMlpFuJV"}]}, {"matching_parties": [{"first_ticket_created_at": 8, "party_attributes": {"o9s0JPG8": {}, "cgjHQo9H": {}, "oLLyUnPT": {}}, "party_id": "iCD0038o", "party_members": [{"extra_attributes": {"r8wR0tuw": {}, "IJnrSI2I": {}, "FcRwSoMT": {}}, "user_id": "uJziuDNb"}, {"extra_attributes": {"Oydiu3lO": {}, "aruuYw0i": {}, "Uuts6bCh": {}}, "user_id": "MK1gcx8p"}, {"extra_attributes": {"9fyv5PoM": {}, "JeTIQix1": {}, "FEvzlipE": {}}, "user_id": "7r0vhh21"}], "ticket_created_at": 44, "ticket_id": "TOPscPA2"}, {"first_ticket_created_at": 28, "party_attributes": {"jI7CbY2W": {}, "uwRUT9Ii": {}, "vgC4mJ5O": {}}, "party_id": "HuNEVQK4", "party_members": [{"extra_attributes": {"Mvk00I9G": {}, "qAhhjNIi": {}, "vdIcaEQf": {}}, "user_id": "NETQCBPK"}, {"extra_attributes": {"1mYwKVQo": {}, "ydbYjXZy": {}, "BpqhCJBt": {}}, "user_id": "FOm3iCpu"}, {"extra_attributes": {"0lhhgutt": {}, "3rQuKP1O": {}, "EtKFBjNi": {}}, "user_id": "hHU8GP8T"}], "ticket_created_at": 89, "ticket_id": "KVNlK8PT"}, {"first_ticket_created_at": 1, "party_attributes": {"z4BGjbsr": {}, "RBV8aztJ": {}, "86yQK1As": {}}, "party_id": "C18UO6Jc", "party_members": [{"extra_attributes": {"XmwQfkse": {}, "TpH6l2Dv": {}, "8SvqYKc5": {}}, "user_id": "6PcPSL2x"}, {"extra_attributes": {"mjViKkKw": {}, "4gHA4CaL": {}, "sPqRsTdK": {}}, "user_id": "zcKtkGcv"}, {"extra_attributes": {"n44NWse6": {}, "VLPkM1VT": {}, "rQBywhJ7": {}}, "user_id": "lbBLw9xy"}], "ticket_created_at": 81, "ticket_id": "WQM5qUS8"}]}], "namespace": "baUqkzSr", "party_attributes": {"41y6RPBH": {}, "JuPjj8zD": {}, "wOk0IgmY": {}}, "party_id": "fUTpFzyQ", "queued_at": 14, "region": "h7KUVhmA", "server_name": "wmAygsnn", "status": "8pM7l6v0", "ticket_id": "elLMceGG", "updated_at": "1974-03-04T00:00:00Z"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op QueueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 9 'QueueSessionHandler' test.out

#- 10 DequeueSessionHandler
# body param: body
echo '{"match_id": "b5FJHWE6"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op DequeueSessionHandler \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 10 'DequeueSessionHandler' test.out

#- 11 QuerySessionHandler
$CLI_EXE \
    --sn matchmaking \
    --op QuerySessionHandler \
    --matchID 's13b7dmn' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 11 'QuerySessionHandler' test.out

#- 12 UpdatePlayTimeWeight
# body param: body
echo '{"playtime": 86, "userID": "jnhp3qY6", "weight": 0.7299671415499931}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdatePlayTimeWeight \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 12 'UpdatePlayTimeWeight' test.out

#- 13 GetAllPartyInAllChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInAllChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 13 'GetAllPartyInAllChannel' test.out

#- 14 BulkGetSessions
$CLI_EXE \
    --sn matchmaking \
    --op BulkGetSessions \
    --namespace $AB_NAMESPACE \
    --matchIDs '7TUEBotS' \
    > test.out 2>&1
eval_tap $? 14 'BulkGetSessions' test.out

#- 15 ExportChannels
$CLI_EXE \
    --sn matchmaking \
    --op ExportChannels \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 15 'ExportChannels' test.out

#- 16 ImportChannels
# form data upload: file
echo 'tmp.dat' > $TEMP_FILE_UPLOAD
$CLI_EXE \
    --sn matchmaking \
    --op ImportChannels \
    --namespace $AB_NAMESPACE \
    --upload $TEMP_FILE_UPLOAD \
    --strategy 'NIwGhia6' \
    > test.out 2>&1
eval_tap $? 16 'ImportChannels' test.out

#- 17 GetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetSingleMatchmakingChannel \
    --channelName 'cqoWmnht' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 17 'GetSingleMatchmakingChannel' test.out

#- 18 UpdateMatchmakingChannel
# body param: body
echo '{"deployment": "uzxir12r", "description": "0VUWI0kJ", "findMatchTimeoutSeconds": 54, "joinable": false, "max_delay_ms": 82, "ruleSet": {"alliance": {"combination": {"alliances": [{"max": 52, "min": 37, "name": "j5ApcsiE"}, {"max": 87, "min": 9, "name": "65llgGnT"}, {"max": 69, "min": 42, "name": "AsTCZa7x"}], "has_combination": true, "role_flexing_enable": false, "role_flexing_player": 92, "role_flexing_second": 28}, "maxNumber": 95, "minNumber": 46, "playerMaxNumber": 12, "playerMinNumber": 67}, "alliance_flexing_rule": [{"combination": {"alliances": [{"max": 70, "min": 74, "name": "A1guTNx7"}, {"max": 15, "min": 47, "name": "aejXSV2o"}, {"max": 69, "min": 78, "name": "2uH8S4Zx"}], "has_combination": true, "role_flexing_enable": true, "role_flexing_player": 90, "role_flexing_second": 59}, "duration": 40, "max_number": 78, "min_number": 9, "player_max_number": 0, "player_min_number": 41}, {"combination": {"alliances": [{"max": 75, "min": 9, "name": "WgAVjZKD"}, {"max": 49, "min": 49, "name": "iezEbuMC"}, {"max": 52, "min": 26, "name": "9J4dPRGz"}], "has_combination": false, "role_flexing_enable": true, "role_flexing_player": 87, "role_flexing_second": 78}, "duration": 21, "max_number": 70, "min_number": 70, "player_max_number": 100, "player_min_number": 99}, {"combination": {"alliances": [{"max": 76, "min": 86, "name": "cgKgU940"}, {"max": 26, "min": 39, "name": "CENHEenq"}, {"max": 19, "min": 97, "name": "RSxO9oZ0"}], "has_combination": false, "role_flexing_enable": false, "role_flexing_player": 58, "role_flexing_second": 67}, "duration": 49, "max_number": 63, "min_number": 76, "player_max_number": 90, "player_min_number": 66}], "flexingRules": [{"attribute": "42bCwgpz", "criteria": "UfcmTQjR", "duration": 26, "reference": 0.2640310508592687}, {"attribute": "YtkZuhL6", "criteria": "qbAhRExs", "duration": 27, "reference": 0.08314241489651464}, {"attribute": "G3pTddIA", "criteria": "0Rt6wM5o", "duration": 87, "reference": 0.32033340141482936}], "match_options": {"options": [{"name": "wF9uPUAx", "type": "erdIqWmO"}, {"name": "oMyYp2tS", "type": "rLxpJnj9"}, {"name": "JtgjWmjx", "type": "1WuNQq4v"}]}, "matchingRules": [{"attribute": "8FnVzdbN", "criteria": "W1xuV7rV", "reference": 0.06578485637126186}, {"attribute": "i1o9zV6r", "criteria": "hVfcQmLf", "reference": 0.48857639612686066}, {"attribute": "n5ZUGeYl", "criteria": "OwODWBAz", "reference": 0.9487605594861959}], "sub_game_modes": {}}, "sessionQueueTimeoutSeconds": 38, "socialMatchmaking": false, "use_sub_gamemode": true}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op UpdateMatchmakingChannel \
    --channelName 'HMfl4Hjw' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 18 'UpdateMatchmakingChannel' test.out

#- 19 GetAllPartyInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllPartyInChannel \
    --channelName '9KEnx8cN' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 19 'GetAllPartyInChannel' test.out

#- 20 GetAllSessionsInChannel
$CLI_EXE \
    --sn matchmaking \
    --op GetAllSessionsInChannel \
    --channelName 'fDK45zWt' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 20 'GetAllSessionsInChannel' test.out

#- 21 AddUserIntoSessionInChannel
# body param: body
echo '{"blocked_players": ["wYhRoNPw", "Kema6caM", "TOcivPAk"], "party_id": "mP8Awb0N", "user_id": "qtvSR9q6"}' > $TEMP_JSON_INPUT
$CLI_EXE \
    --sn matchmaking \
    --op AddUserIntoSessionInChannel \
    --channelName 'l5k9BLQM' \
    --matchID 'rPoTuxdz' \
    --namespace $AB_NAMESPACE \
    --reqfile $TEMP_JSON_INPUT \
    > test.out 2>&1
eval_tap $? 21 'AddUserIntoSessionInChannel' test.out

#- 22 DeleteSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteSessionInChannel \
    --channelName 'EYAw5VdW' \
    --matchID '05WnQEAb' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 22 'DeleteSessionInChannel' test.out

#- 23 DeleteUserFromSessionInChannel
$CLI_EXE \
    --sn matchmaking \
    --op DeleteUserFromSessionInChannel \
    --channelName 'K416LN2N' \
    --matchID '6D6yczit' \
    --namespace $AB_NAMESPACE \
    --userID 'n4OkZfx0' \
    > test.out 2>&1
eval_tap $? 23 'DeleteUserFromSessionInChannel' test.out

#- 24 SearchSessions
eval_tap 0 24 'SearchSessions # SKIP deprecated' test.out

#- 25 GetSessionHistoryDetailed
eval_tap 0 25 'GetSessionHistoryDetailed # SKIP deprecated' test.out

#- 26 PublicGetMessages
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetMessages \
    > test.out 2>&1
eval_tap $? 26 'PublicGetMessages' test.out

#- 27 PublicGetAllMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetAllMatchmakingChannel \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 27 'PublicGetAllMatchmakingChannel' test.out

#- 28 PublicGetSingleMatchmakingChannel
$CLI_EXE \
    --sn matchmaking \
    --op PublicGetSingleMatchmakingChannel \
    --channelName 'Xa6sgegA' \
    --namespace $AB_NAMESPACE \
    > test.out 2>&1
eval_tap $? 28 'PublicGetSingleMatchmakingChannel' test.out

#- 29 SearchSessionsV2
eval_tap 0 29 'SearchSessionsV2 # SKIP deprecated' test.out

#- 30 VersionCheckHandler
$CLI_EXE \
    --sn matchmaking \
    --op VersionCheckHandler \
    > test.out 2>&1
eval_tap $? 30 'VersionCheckHandler' test.out


# remove artifacts
rm -f "$CLI_TOKEN_FILE"
rm -f "$TEMP_JSON_INPUT"
rm -f "$TEMP_FILE_UPLOAD"

exit $EXIT_CODE